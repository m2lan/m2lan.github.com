<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>知识记录</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.golearns.org/"/>
  <updated>2017-05-07T07:43:02.000Z</updated>
  <id>http://blog.golearns.org/</id>
  
  <author>
    <name>M2</name>
    <email>763960267@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>jsonp</title>
    <link href="http://blog.golearns.org/2017/05/07/jsonp/"/>
    <id>http://blog.golearns.org/2017/05/07/jsonp/</id>
    <published>2017-05-07T07:34:55.000Z</published>
    <updated>2017-05-07T07:43:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jsonp"><a href="#jsonp" class="headerlink" title="jsonp"></a>jsonp</h1><h2 id="新建一个web客户端"><a href="#新建一个web客户端" class="headerlink" title="新建一个web客户端"></a>新建一个web客户端</h2><ul>
<li><p>index.jsp</p>
<pre><code>&lt;html&gt;
    &lt;body&gt;
        &lt;script src=&quot;https://cdn.staticfile.org/jquery/2.1.1/jquery.js&quot;&gt;&lt;/script&gt;
        &lt;script&gt;
        $(function() {
            $.ajax({
                url: &apos;http://192.168.0.1:8080/spring_mybatis/getUser?callback=?&apos;,
                dataType: &apos;jsonp&apos;,
                success: function(data) {
                    console.log(data)
                }
            });
        });
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre></li>
</ul>
<a id="more"></a>
<h2 id="web服务端"><a href="#web服务端" class="headerlink" title="web服务端"></a>web服务端</h2><ul>
<li><p>新建JsonpAdvice.java</p>
<pre><code>@ControllerAdvice
public class JsonpAdvice extends AbstractJsonpResponseBodyAdvice {

    public JsonpAdvice() {
        super(&quot;callback&quot;);
    }
}
</code></pre></li>
<li><p>UserController.java</p>
<pre><code>@Controller
public class UserController {
    @RequestMapping(value=&quot;getUser&quot;, produces=MediaType.APPLICATION_JSON_VALUE)
    public @ResponseBody Map&lt;String, String&gt; getUser() {
        Map&lt;String, String&gt; maps = new HashMap&lt;&gt;();
        maps.put(&quot;username&quot;, &quot;zhangsan&quot;);
        maps.put(&quot;password&quot;, &quot;123456&quot;);
        return maps;
    }
}
</code></pre></li>
<li><p>返回</p>
<pre><code>Object {password: &quot;123456&quot;, username: &quot;zhangsan&quot;}
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;jsonp&quot;&gt;&lt;a href=&quot;#jsonp&quot; class=&quot;headerlink&quot; title=&quot;jsonp&quot;&gt;&lt;/a&gt;jsonp&lt;/h1&gt;&lt;h2 id=&quot;新建一个web客户端&quot;&gt;&lt;a href=&quot;#新建一个web客户端&quot; class=&quot;headerlink&quot; title=&quot;新建一个web客户端&quot;&gt;&lt;/a&gt;新建一个web客户端&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;index.jsp&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;
    &amp;lt;body&amp;gt;
        &amp;lt;script src=&amp;quot;https://cdn.staticfile.org/jquery/2.1.1/jquery.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
        &amp;lt;script&amp;gt;
        $(function() {
            $.ajax({
                url: &amp;apos;http://192.168.0.1:8080/spring_mybatis/getUser?callback=?&amp;apos;,
                dataType: &amp;apos;jsonp&amp;apos;,
                success: function(data) {
                    console.log(data)
                }
            });
        });
        &amp;lt;/script&amp;gt;
    &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="jsonp" scheme="http://blog.golearns.org/categories/jsonp/"/>
    
    
      <category term="jsonp" scheme="http://blog.golearns.org/tags/jsonp/"/>
    
      <category term="springmvc" scheme="http://blog.golearns.org/tags/springmvc/"/>
    
  </entry>
  
  <entry>
    <title>mybatis逆向工程</title>
    <link href="http://blog.golearns.org/2017/05/07/mybatis%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/"/>
    <id>http://blog.golearns.org/2017/05/07/mybatis逆向工程/</id>
    <published>2017-05-07T06:20:42.000Z</published>
    <updated>2017-05-07T06:24:44.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mybatis-逆向工程"><a href="#mybatis-逆向工程" class="headerlink" title="mybatis 逆向工程"></a>mybatis 逆向工程</h1><ul>
<li>新建maven simple project</li>
<li><p>pom.xml </p>
<pre><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;version&gt;5.1.40&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
        &lt;version&gt;3.4.1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j&lt;/artifactId&gt;
        &lt;version&gt;1.2.17&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt;
        &lt;version&gt;1.3.5&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;junit&lt;/groupId&gt;
        &lt;artifactId&gt;junit&lt;/artifactId&gt;
        &lt;version&gt;4.12&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre></li>
</ul>
<a id="more"></a>    
<ul>
<li><p>创建generatorConfig.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE generatorConfiguration
  PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt;

&lt;generatorConfiguration&gt;
    &lt;!-- 无Example查询条件内容 --&gt;
    &lt;context id=&quot;DB2Tables&quot; targetRuntime=&quot;MyBatis3Simple&quot; defaultModelType=&quot;flat&quot;&gt;
    &lt;!-- 有Example查询条件内容 --&gt;
    &lt;!-- &lt;context id=&quot;DB2Tables&quot; targetRuntime=&quot;MyBatis3&quot;&gt; --&gt;
        &lt;commentGenerator&gt;
            &lt;!-- 是否去除自动生成的注释 --&gt;
            &lt;property name=&quot;suppressAllComments&quot; value=&quot;true&quot; /&gt;
        &lt;/commentGenerator&gt;

        &lt;jdbcConnection driverClass=&quot;com.mysql.jdbc.Driver&quot;
            connectionURL=&quot;jdbc:mysql://localhost:3306/test&quot; userId=&quot;root&quot; password=&quot;123456&quot;&gt;
        &lt;/jdbcConnection&gt;

        &lt;!-- 默认false，把JDBC DECIMAL 和 NUMERIC 类型解析为Integer，
            为true时把 JDBC DECIMAL 和 NUMERIC 解析为 java.math.BigDecimal--&gt;
        &lt;javaTypeResolver&gt;
            &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot; /&gt;
        &lt;/javaTypeResolver&gt;

        &lt;!-- targetPackage: 生成Entity类的路径 --&gt;
        &lt;javaModelGenerator targetPackage=&quot;com.example.mybatis.entity&quot;
            targetProject=&quot;src&quot;&gt;
            &lt;!-- 是否让schema作为包的后缀 --&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;
            &lt;!-- 从数据库返回的值被清理前后的空格 --&gt;
            &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot; /&gt;
        &lt;/javaModelGenerator&gt;

        &lt;!-- 映射文件生成的路径 --&gt;
        &lt;sqlMapGenerator targetPackage=&quot;com.example.mybatis.mapper&quot;
            targetProject=&quot;src&quot;&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;
        &lt;/sqlMapGenerator&gt;

        &lt;!-- mapper接口生成的路径 --&gt;
        &lt;javaClientGenerator type=&quot;XMLMAPPER&quot;
            targetPackage=&quot;com.example.mybatis.mapper&quot; targetProject=&quot;src&quot;&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;
        &lt;/javaClientGenerator&gt;

        &lt;!-- 数据库表名字和entity类映射 --&gt;
        &lt;table tableName=&quot;user&quot; domainObjectName=&quot;User&quot;&gt;&lt;/table&gt;
        &lt;!-- &lt;table tableName=&quot;user&quot; domainObjectName=&quot;User&quot;&gt;&lt;/table&gt;
        &lt;table tableName=&quot;user&quot; domainObjectName=&quot;User&quot;&gt;&lt;/table&gt;
        &lt;table tableName=&quot;user&quot; domainObjectName=&quot;User&quot;&gt;&lt;/table&gt;
        &lt;table tableName=&quot;user&quot; domainObjectName=&quot;User&quot;&gt;&lt;/table&gt; --&gt;

    &lt;/context&gt;
&lt;/generatorConfiguration&gt;
</code></pre><ul>
<li><p>新建Main.java</p>
<pre><code>public static void main(String[] args) throws Exception {
    List&lt;String&gt; warnings = new ArrayList&lt;String&gt;();
    boolean overwrite = true;
    URL url = ClassLoader.getSystemResource(&quot;generatorConfig.xml&quot;);
    File configFile = new File(url.toURI());
    ConfigurationParser cp = new ConfigurationParser(warnings);
    Configuration config = cp.parseConfiguration(configFile);
    DefaultShellCallback callback = new DefaultShellCallback(overwrite);
    MyBatisGenerator myBatisGenerator = new MyBatisGenerator(config, callback, warnings);
    myBatisGenerator.generate(null);
}
</code></pre></li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mybatis-逆向工程&quot;&gt;&lt;a href=&quot;#mybatis-逆向工程&quot; class=&quot;headerlink&quot; title=&quot;mybatis 逆向工程&quot;&gt;&lt;/a&gt;mybatis 逆向工程&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;新建maven simple project&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pom.xml &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dependencies&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;mysql&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;mysql-connector-java&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;5.1.40&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.mybatis&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;mybatis&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;3.4.1&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;log4j&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;log4j&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;1.2.17&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.mybatis.generator&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;mybatis-generator-core&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;1.3.5&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;4.12&amp;lt;/version&amp;gt;
        &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;
    &amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="mybatis" scheme="http://blog.golearns.org/categories/mybatis/"/>
    
    
      <category term="mybatis" scheme="http://blog.golearns.org/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>mybatis-spring-springmvc</title>
    <link href="http://blog.golearns.org/2017/05/07/mybatis-spring-springmvc/"/>
    <id>http://blog.golearns.org/2017/05/07/mybatis-spring-springmvc/</id>
    <published>2017-05-07T06:09:37.000Z</published>
    <updated>2017-05-07T06:18:17.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mybatis整合spring和springmvc"><a href="#mybatis整合spring和springmvc" class="headerlink" title="mybatis整合spring和springmvc"></a>mybatis整合spring和springmvc</h1><h2 id="新建Maven-webapps"><a href="#新建Maven-webapps" class="headerlink" title="新建Maven webapps"></a>新建Maven webapps</h2><ul>
<li><p>pom.xml</p>
<pre><code>&lt;profiles&gt;
    &lt;profile&gt;
        &lt;activation&gt;
            &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;
            &lt;jdk&gt;1.8&lt;/jdk&gt;
        &lt;/activation&gt;
        &lt;properties&gt;
            &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
            &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
            &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
            &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
            &lt;maven.compiler.compilerVersion&gt;1.8&lt;/maven.compiler.compilerVersion&gt;
            &lt;java.version&gt;1.8&lt;/java.version&gt;
            &lt;mybatis.version&gt;3.4.1&lt;/mybatis.version&gt;
            &lt;mysql.version&gt;5.1.40&lt;/mysql.version&gt;
            &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt;
            &lt;junit.version&gt;4.12&lt;/junit.version&gt;
            &lt;mybatis.ehcache.version&gt;1.1.0&lt;/mybatis.ehcache.version&gt;
            &lt;spring.version&gt;4.3.7.RELEASE&lt;/spring.version&gt;
            &lt;servlet.api.version&gt;3.1.0&lt;/servlet.api.version&gt;
            &lt;jstl.version&gt;1.2&lt;/jstl.version&gt;
            &lt;jackson.version&gt;2.8.7&lt;/jackson.version&gt;
            &lt;c3p0.version&gt;0.9.5.2&lt;/c3p0.version&gt;
            &lt;mybatis.spring.version&gt;1.3.1&lt;/mybatis.spring.version&gt;
        &lt;/properties&gt;
    &lt;/profile&gt;
&lt;/profiles&gt;
&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
        &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
        &lt;version&gt;${servlet.api.version}&lt;/version&gt;
        &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
        &lt;artifactId&gt;jstl&lt;/artifactId&gt;
        &lt;version&gt;${jstl.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
        &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
        &lt;version&gt;${jackson.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;version&gt;${mysql.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.mchange&lt;/groupId&gt;
        &lt;artifactId&gt;c3p0&lt;/artifactId&gt;
        &lt;version&gt;${c3p0.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
        &lt;version&gt;${mybatis.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j&lt;/artifactId&gt;
        &lt;version&gt;${log4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis.caches&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-ehcache&lt;/artifactId&gt;
        &lt;version&gt;${mybatis.ehcache.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
        &lt;version&gt;${mybatis.spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;junit&lt;/groupId&gt;
        &lt;artifactId&gt;junit&lt;/artifactId&gt;
        &lt;version&gt;${junit.version}&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre></li>
<li>Maven -&gt; Update project</li>
</ul>
<a id="more"></a>
<h2 id="Web-xml"><a href="#Web-xml" class="headerlink" title="Web.xml"></a>Web.xml</h2><pre><code>&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee 
      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;
version=&quot;3.0&quot;&gt;

    &lt;filter&gt;
        &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
        &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;encoding&lt;/param-name&gt;
            &lt;param-value&gt;UTF-8&lt;/param-value&gt;
        &lt;/init-param&gt;
    &lt;/filter&gt;
    &lt;filter-mapping&gt;
        &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/filter-mapping&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;springDispatcherServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
            &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;springDispatcherServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

&lt;/web-app&gt;
</code></pre><h2 id="新建springmvc-xml"><a href="#新建springmvc-xml" class="headerlink" title="新建springmvc.xml"></a>新建springmvc.xml</h2><pre><code>&lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot;/&gt;

&lt;context:component-scan base-package=&quot;com.example.springAndMybatis&quot;&gt;&lt;/context:component-scan&gt;

&lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
    &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/views/&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=&quot;dataSource&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt;
    &lt;property name=&quot;user&quot; value=&quot;${jdbc.user}&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;driverClass&quot; value=&quot;${jdbc.driverClass}&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;jdbcUrl&quot; value=&quot;${jdbc.jdbcUrl}&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;initialPoolSize&quot; value=&quot;${jdbc.initPoolSize}&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;maxPoolSize&quot; value=&quot;${jdbc.maxPoolSize}&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;typeAliasesPackage&quot; value=&quot;com.example.springAndMybatis.mybatis&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis.xml&quot;&gt;&lt;/property&gt;
    &lt;!-- 扫描类路径下mapper下的所有xml --&gt;
    &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath:mapper/*.xml&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
    &lt;constructor-arg name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/constructor-arg&gt;
&lt;/bean&gt;

&lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;
    &lt;property name=&quot;basePackage&quot; value=&quot;com.example.springAndMybatis.mybatis&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;

&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt;
&lt;mvc:annotation-driven  /&gt;
&lt;mvc:default-servlet-handler/&gt;
</code></pre><h2 id="jdbc-properties"><a href="#jdbc-properties" class="headerlink" title="jdbc.properties"></a>jdbc.properties</h2><pre><code>jdbc.user=root
jdbc.password=123456
jdbc.driverClass=com.mysql.jdbc.Driver
jdbc.jdbcUrl=jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true
jdbc.initPoolSize=5
jdbc.maxPoolSize=10
</code></pre><h2 id="mybatis-xml"><a href="#mybatis-xml" class="headerlink" title="mybatis.xml"></a>mybatis.xml</h2><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE configuration
  PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
&lt;/configuration&gt;
</code></pre><h2 id="UserMapper-xml"><a href="#UserMapper-xml" class="headerlink" title="UserMapper.xml"></a>UserMapper.xml</h2><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.example.springAndMybatis.mybatis.UserMapper&quot;&gt;
    &lt;select id=&quot;getUser&quot; parameterType=&quot;Integer&quot; resultType=&quot;com.example.springAndMybatis.model.User&quot;&gt;
        select id, username, password, email from user where id = #{id}
    &lt;/select&gt;

    &lt;insert id=&quot;addUser&quot; parameterType=&quot;com.example.springAndMybatis.model.User&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;
        insert into user(username, password, email) value(#{username}, #{password}, #{email})
    &lt;/insert&gt;
&lt;/mapper&gt;
</code></pre><h2 id="UserMapper-java"><a href="#UserMapper-java" class="headerlink" title="UserMapper.java"></a>UserMapper.java</h2><pre><code>public interface UserMapper {

    public User getUser(Integer id);

    public void addUser(User user);
}
</code></pre><h2 id="UserService-java"><a href="#UserService-java" class="headerlink" title="UserService.java"></a>UserService.java</h2><pre><code>@Service
@Transactional(readOnly=true)
public class UserService {

    @Autowired
    private UserMapper userMapper;

    public User getUser(Integer id) {
        return userMapper.getUser(id);
    }

    @Transactional(isolation=Isolation.DEFAULT, propagation=Propagation.REQUIRED, readOnly=false, rollbackFor=Exception.class)
    public void addUser(User user) {
        userMapper.addUser(user);
    }
}
</code></pre><h2 id="UserController-java"><a href="#UserController-java" class="headerlink" title="UserController.java"></a>UserController.java</h2><pre><code>@Controller
public class UserController {

    @Autowired
    private UserService userService;

    @RequestMapping(&quot;user&quot;)
    public String user(@RequestParam(&quot;username&quot;) String username) {
        System.out.println(&quot;username: &quot; + username);

        User user = userService.getUser(1);
        System.out.println(&quot;user: &quot; + user);

        user = new User();
        user.setUsername(&quot;zhaoliuxxx&quot;);
        user.setPassword(&quot;123456&quot;);
        user.setEmail(&quot;zhaoliu@qq.com&quot;);
        userService.addUser(user);
        System.out.println(&quot;result: &quot; + user.getId());

        return &quot;user&quot;;
    }
}
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mybatis整合spring和springmvc&quot;&gt;&lt;a href=&quot;#mybatis整合spring和springmvc&quot; class=&quot;headerlink&quot; title=&quot;mybatis整合spring和springmvc&quot;&gt;&lt;/a&gt;mybatis整合spring和springmvc&lt;/h1&gt;&lt;h2 id=&quot;新建Maven-webapps&quot;&gt;&lt;a href=&quot;#新建Maven-webapps&quot; class=&quot;headerlink&quot; title=&quot;新建Maven webapps&quot;&gt;&lt;/a&gt;新建Maven webapps&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;pom.xml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;profiles&amp;gt;
    &amp;lt;profile&amp;gt;
        &amp;lt;activation&amp;gt;
            &amp;lt;activeByDefault&amp;gt;true&amp;lt;/activeByDefault&amp;gt;
            &amp;lt;jdk&amp;gt;1.8&amp;lt;/jdk&amp;gt;
        &amp;lt;/activation&amp;gt;
        &amp;lt;properties&amp;gt;
            &amp;lt;project.build.sourceEncoding&amp;gt;UTF-8&amp;lt;/project.build.sourceEncoding&amp;gt;
            &amp;lt;project.reporting.outputEncoding&amp;gt;UTF-8&amp;lt;/project.reporting.outputEncoding&amp;gt;
            &amp;lt;maven.compiler.source&amp;gt;1.8&amp;lt;/maven.compiler.source&amp;gt;
            &amp;lt;maven.compiler.target&amp;gt;1.8&amp;lt;/maven.compiler.target&amp;gt;
            &amp;lt;maven.compiler.compilerVersion&amp;gt;1.8&amp;lt;/maven.compiler.compilerVersion&amp;gt;
            &amp;lt;java.version&amp;gt;1.8&amp;lt;/java.version&amp;gt;
            &amp;lt;mybatis.version&amp;gt;3.4.1&amp;lt;/mybatis.version&amp;gt;
            &amp;lt;mysql.version&amp;gt;5.1.40&amp;lt;/mysql.version&amp;gt;
            &amp;lt;log4j.version&amp;gt;1.2.17&amp;lt;/log4j.version&amp;gt;
            &amp;lt;junit.version&amp;gt;4.12&amp;lt;/junit.version&amp;gt;
            &amp;lt;mybatis.ehcache.version&amp;gt;1.1.0&amp;lt;/mybatis.ehcache.version&amp;gt;
            &amp;lt;spring.version&amp;gt;4.3.7.RELEASE&amp;lt;/spring.version&amp;gt;
            &amp;lt;servlet.api.version&amp;gt;3.1.0&amp;lt;/servlet.api.version&amp;gt;
            &amp;lt;jstl.version&amp;gt;1.2&amp;lt;/jstl.version&amp;gt;
            &amp;lt;jackson.version&amp;gt;2.8.7&amp;lt;/jackson.version&amp;gt;
            &amp;lt;c3p0.version&amp;gt;0.9.5.2&amp;lt;/c3p0.version&amp;gt;
            &amp;lt;mybatis.spring.version&amp;gt;1.3.1&amp;lt;/mybatis.spring.version&amp;gt;
        &amp;lt;/properties&amp;gt;
    &amp;lt;/profile&amp;gt;
&amp;lt;/profiles&amp;gt;
&amp;lt;dependencies&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;spring-context&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${spring.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;spring-aspects&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${spring.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;spring-web&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${spring.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;spring-webmvc&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${spring.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;javax.servlet&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;javax.servlet-api&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${servlet.api.version}&amp;lt;/version&amp;gt;
        &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;javax.servlet&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;jstl&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${jstl.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;com.fasterxml.jackson.core&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;jackson-databind&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${jackson.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;mysql&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;mysql-connector-java&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${mysql.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;spring-jdbc&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${spring.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;com.mchange&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;c3p0&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${c3p0.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.mybatis&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;mybatis&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${mybatis.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;log4j&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;log4j&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${log4j.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.mybatis.caches&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;mybatis-ehcache&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${mybatis.ehcache.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.mybatis&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;mybatis-spring&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${mybatis.spring.version}&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${junit.version}&amp;lt;/version&amp;gt;
        &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;
    &amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;Maven -&amp;gt; Update project&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="mybatis" scheme="http://blog.golearns.org/categories/mybatis/"/>
    
    
      <category term="springmvc" scheme="http://blog.golearns.org/tags/springmvc/"/>
    
      <category term="mybatis" scheme="http://blog.golearns.org/tags/mybatis/"/>
    
      <category term="spring" scheme="http://blog.golearns.org/tags/spring/"/>
    
  </entry>
  
  <entry>
    <title>mybatis-cache</title>
    <link href="http://blog.golearns.org/2017/05/07/mybatis-cache/"/>
    <id>http://blog.golearns.org/2017/05/07/mybatis-cache/</id>
    <published>2017-05-07T05:54:46.000Z</published>
    <updated>2017-05-07T06:18:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mybatis-cache"><a href="#mybatis-cache" class="headerlink" title="mybatis cache"></a>mybatis cache</h1><blockquote>
<p>mybatis提供一级缓存和二级缓存</p>
</blockquote>
<h2 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存"></a>一级缓存</h2><ul>
<li><p>sqlSession级别的缓存，会话缓存，当sqlSession关闭会话结束，缓存失效。</p>
<pre><code>@Test
public void findUser() {
    try (SqlSession session = sqlSessionFactory.openSession();
            SqlSession session2 = sqlSessionFactory.openSession()) {
        UserMapper userMapper = session.getMapper(UserMapper.class);
        User user = userMapper.getUserById(1);
        System.out.println(user);
        session.close();

        UserMapper userMapper1 = session2.getMapper(UserMapper.class);
        User user1 = userMapper1.getUserById(1);
        System.out.println(user1);
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</code></pre></li>
<li>第一次查询用户信息，如果缓存中不存在，去数据库中查询。然后把用户信息保存在一级缓存中。</li>
<li>默认所有的select语句都会被缓存<code>useCache=&quot;true&quot;</code></li>
<li>当操作insert,update 和 delete 语句会刷新缓存。<code>flushCache=&quot;true&quot;</code></li>
</ul>
<a id="more"></a>
<h2 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a>二级缓存</h2><ul>
<li>二级缓存的范围更大，多个sqlSession可以共享二级缓存。</li>
<li><p>开启二级缓存</p>
<pre><code>&lt;settings&gt;
    &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;
&lt;/settings&gt;
</code></pre></li>
<li>JavaBean文件实现<code>Serializable</code>序列化接口</li>
<li><p>在Mapper映射文件中加入</p>
<pre><code>&lt;!-- 
    eviction缓存策略：FIFO，先进先出，按对象进入缓存的顺序移除
    flushInterval: 每隔60s刷新缓存
    缓存列表大小为512个并且是只读的
--&gt;
&lt;cache
  eviction=&quot;FIFO&quot;
  flushInterval=&quot;60000&quot;
  size=&quot;512&quot;
  readOnly=&quot;true&quot;/&gt;
</code></pre><h2 id="使用EhCache缓存"><a href="#使用EhCache缓存" class="headerlink" title="使用EhCache缓存"></a>使用EhCache缓存</h2></li>
<li><p>添加ehcache.xml</p>
<pre><code>&lt;ehcache&gt;
    &lt;diskStore path=&quot;java.io.tmpdir/mybatis-ehcache&quot;/&gt;
    &lt;defaultCache
        maxElementsInMemory=&quot;1000&quot;
        maxElementsOnDisk=&quot;10000000&quot;
        eternal=&quot;false&quot;
        timeToIdleSeconds=&quot;120&quot;
        timeToLiveSeconds=&quot;120&quot;
        overflowToDisk=&quot;false&quot;
        diskPersistent=&quot;false&quot;
        diskExpiryThreadIntervalSeconds=&quot;120&quot;
        memoryStoreEvictionPolicy=&quot;LRU&quot;
    /&gt;
&lt;/ehcache&gt;
</code></pre></li>
<li><p>在Mapper映射文件中配置</p>
<pre><code>&lt;cache type=&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;&gt;&lt;/cache&gt;
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mybatis-cache&quot;&gt;&lt;a href=&quot;#mybatis-cache&quot; class=&quot;headerlink&quot; title=&quot;mybatis cache&quot;&gt;&lt;/a&gt;mybatis cache&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;mybatis提供一级缓存和二级缓存&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;一级缓存&quot;&gt;&lt;a href=&quot;#一级缓存&quot; class=&quot;headerlink&quot; title=&quot;一级缓存&quot;&gt;&lt;/a&gt;一级缓存&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;sqlSession级别的缓存，会话缓存，当sqlSession关闭会话结束，缓存失效。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Test
public void findUser() {
    try (SqlSession session = sqlSessionFactory.openSession();
            SqlSession session2 = sqlSessionFactory.openSession()) {
        UserMapper userMapper = session.getMapper(UserMapper.class);
        User user = userMapper.getUserById(1);
        System.out.println(user);
        session.close();

        UserMapper userMapper1 = session2.getMapper(UserMapper.class);
        User user1 = userMapper1.getUserById(1);
        System.out.println(user1);
    } catch (Exception e) {
        e.printStackTrace();
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;第一次查询用户信息，如果缓存中不存在，去数据库中查询。然后把用户信息保存在一级缓存中。&lt;/li&gt;
&lt;li&gt;默认所有的select语句都会被缓存&lt;code&gt;useCache=&amp;quot;true&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;当操作insert,update 和 delete 语句会刷新缓存。&lt;code&gt;flushCache=&amp;quot;true&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="mybatis" scheme="http://blog.golearns.org/categories/mybatis/"/>
    
    
      <category term="mybatis" scheme="http://blog.golearns.org/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>mybatis-多表关联操作</title>
    <link href="http://blog.golearns.org/2017/05/07/mybatis-%E5%A4%9A%E8%A1%A8%E5%85%B3%E8%81%94%E6%93%8D%E4%BD%9C/"/>
    <id>http://blog.golearns.org/2017/05/07/mybatis-多表关联操作/</id>
    <published>2017-05-07T04:38:44.000Z</published>
    <updated>2017-05-07T05:09:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mybatis多表关联"><a href="#mybatis多表关联" class="headerlink" title="mybatis多表关联"></a>mybatis多表关联</h1><ul>
<li><p>表结构</p>
<pre><code>CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(100) NOT NULL,
  `password` varchar(100) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `icard` int(11) NOT NULL DEFAULT &apos;0&apos;,
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `idCard` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `card` char(30) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
</code></pre></li>
</ul>
<a id="more"></a>    
<ul>
<li>创建User和IDCard的javabean文件</li>
<li><p><code>UserMapper</code></p>
<pre><code>public interface UserMapper {

    public Integer addUser(User user);

    public void delUser(Integer id);

    public void updateUser(User user);

    public User getUserById(Integer id);

    public List&lt;User&gt; getAll();

    // 和idCard表关联
    public User getUserAndCardById(Integer id);
}
</code></pre></li>
<li><p><code>UserMapper.xml</code></p>
<pre><code>&lt;resultMap type=&quot;com.example.mybatis.model.IDCard&quot; id=&quot;cardResultMap&quot;&gt;
    &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;
    &lt;result property=&quot;card&quot; column=&quot;card&quot;/&gt;
&lt;/resultMap&gt;
&lt;resultMap type=&quot;com.example.mybatis.model.User&quot; id=&quot;userCardResultMap&quot;&gt;
    &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;
    &lt;result property=&quot;username&quot; column=&quot;username&quot;/&gt;
    &lt;result property=&quot;password&quot; column=&quot;password&quot;/&gt;
    &lt;result property=&quot;email&quot; column=&quot;email&quot;/&gt;
    &lt;association property=&quot;card&quot; column=&quot;icard&quot; columnPrefix=&quot;card_&quot; resultMap=&quot;cardResultMap&quot;&gt;&lt;/association&gt;
&lt;/resultMap&gt;
&lt;select id=&quot;getUserAndCardById&quot; parameterType=&quot;Integer&quot;
    resultType=&quot;com.example.mybatis.model.User&quot; resultMap=&quot;userCardResultMap&quot;&gt;
    select
        u.id as id,
        u.username as username,
        u.password as password,
        u.email as email,
        c.id as card_id,
        c.card as card_card
    from user u left join idCard c on u.icard = c.id
    where u.id = #{id}
&lt;/select&gt;
</code></pre></li>
<li><p>测试文件</p>
<pre><code>@Test
public void testGetUserAndCardById() {
    try (SqlSession session = sessionFactory.openSession()) {
        UserMapper userMapper = session.getMapper(UserMapper.class);
        User user = userMapper.getUserAndCardById(1);
        System.out.println(user);
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</code></pre></li>
</ul>
<h2 id="第二种关联方式"><a href="#第二种关联方式" class="headerlink" title="第二种关联方式"></a>第二种关联方式</h2><ul>
<li><p>新建<code>CardMapper.java</code></p>
<pre><code>public interface CardMapper {

    public IDCard getCard(Integer id);
}
</code></pre></li>
<li><p>新建<code>CardMapper.xml</code></p>
<pre><code>&lt;mapper namespace=&quot;com.example.mybatis.mapper.CardMapper&quot;&gt;
    &lt;select id=&quot;getCard&quot; parameterType=&quot;Integer&quot; resultType=&quot;com.example.mybatis.model.IDCard&quot;&gt;
        select id, card from idCard where id = #{id}
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre></li>
<li><p>加入<code>mybatis-config.xml</code></p>
<pre><code>&lt;mapper resource=&quot;CardMapper.xml&quot;/&gt;
</code></pre></li>
<li><p><code>UserMapper.xml</code>配置</p>
<pre><code>&lt;resultMap type=&quot;com.example.mybatis.model.User&quot; id=&quot;userAndCardResultMap&quot;&gt;
    &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;
    &lt;result property=&quot;username&quot; column=&quot;username&quot;/&gt;
    &lt;result property=&quot;password&quot; column=&quot;password&quot;/&gt;
    &lt;result property=&quot;email&quot; column=&quot;email&quot;/&gt;
    &lt;!-- 注意这里 --&gt;
    &lt;association property=&quot;card&quot; column=&quot;icard&quot; select=&quot;com.example.mybatis.mapper.CardMapper.getCard&quot; /&gt;
&lt;/resultMap&gt;
&lt;select id=&quot;getUserAndCardById&quot; parameterType=&quot;Integer&quot; 
    resultType=&quot;com.example.mybatis.model.User&quot; resultMap=&quot;userAndCardResultMap&quot;&gt;
    select id, username, password, email, icard from user where id = #{id}
&lt;/select&gt;
</code></pre></li>
</ul>
<h2 id="注解配置"><a href="#注解配置" class="headerlink" title="注解配置"></a>注解配置</h2><ul>
<li><p><code>UserMapperAnnotation.java</code>添加</p>
<pre><code>@Select(&quot;select id, username, password, email, icard from user where id = #{id}&quot;)
@Results({
    @Result(id=true, property=&quot;id&quot;, column=&quot;id&quot;),
    @Result(property=&quot;username&quot;, column=&quot;username&quot;),
    @Result(property=&quot;password&quot;, column=&quot;password&quot;),
    @Result(property=&quot;email&quot;, column=&quot;email&quot;),
    @Result(property=&quot;card&quot;, column=&quot;icard&quot;, one=@One(select=&quot;com.example.mybatis.mapper.CardMapper.getCard&quot;))
})
public User getUserAndCardById(Integer id);
</code></pre></li>
<li><p>测试</p>
<pre><code>@Test
public void testGetUserAndCardById() {
    try (SqlSession session = sessionFactory.openSession()) {
        UserMapperAnnotation mapper = session.getMapper(UserMapperAnnotation.class);
        User user = mapper.getUserAndCardById(1);
        System.out.println(user.getUsername());
        System.out.println(user.getCard());
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mybatis多表关联&quot;&gt;&lt;a href=&quot;#mybatis多表关联&quot; class=&quot;headerlink&quot; title=&quot;mybatis多表关联&quot;&gt;&lt;/a&gt;mybatis多表关联&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;表结构&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(100) NOT NULL,
  `password` varchar(100) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `icard` int(11) NOT NULL DEFAULT &amp;apos;0&amp;apos;,
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `idCard` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `card` char(30) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="mybatis" scheme="http://blog.golearns.org/categories/mybatis/"/>
    
    
      <category term="mybatis" scheme="http://blog.golearns.org/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>mybatis-注解操作</title>
    <link href="http://blog.golearns.org/2017/05/07/mybatis-%E6%B3%A8%E8%A7%A3%E6%93%8D%E4%BD%9C/"/>
    <id>http://blog.golearns.org/2017/05/07/mybatis-注解操作/</id>
    <published>2017-05-07T04:31:50.000Z</published>
    <updated>2017-05-07T05:10:03.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mybatis注解"><a href="#mybatis注解" class="headerlink" title="mybatis注解"></a>mybatis注解</h1><ul>
<li><p>新建<code>UserMapperAnnotation.java</code>文件</p>
<pre><code>public interface UserMapperAnnotation {

    @Insert(&quot;insert into user(username, password, email) values(#{username}, #{password}, #{email})&quot;)
    @Options(useGeneratedKeys=true, keyProperty=&quot;id&quot;)
    public Integer addUser(User user);

    @Delete(&quot;delete from user where id = #{id}&quot;)
    public void delUser(Integer id);

    @Update(&quot;update user set password = #{password} where id = #{id}&quot;)
    public void updateUser(User user);

    @Select(&quot;select id, username, password, email from user where id = #{id}&quot;)
    public User getUserById(Integer id);

    @Select(&quot;select id, username, password, email from user&quot;)
    public List&lt;User&gt; getAll();
}
</code></pre></li>
</ul>
<a id="more"></a>    
<ul>
<li><p>在mybatis-config.xml中添加</p>
<pre><code>&lt;mappers&gt;
    &lt;mapper resource=&quot;UserMapper.xml&quot;/&gt;
    &lt;mapper class=&quot;com.example.mybatis.mapper.UserMapperAnnotation&quot;/&gt;
&lt;/mappers&gt;
</code></pre></li>
<li><p>新建测试文件</p>
<pre><code>public class TestUserMapperAnnotation {

    private SqlSessionFactory sessionFactory;

    @Before
    public void init() throws IOException {
        InputStream inputStream = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);
        sessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
    }

    @Test
    public void testGetAll() {
        try (SqlSession session = sessionFactory.openSession()) {
            UserMapperAnnotation mapper = session.getMapper(UserMapperAnnotation.class);
            List&lt;User&gt; lists = mapper.getAll();
            System.out.println(lists);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mybatis注解&quot;&gt;&lt;a href=&quot;#mybatis注解&quot; class=&quot;headerlink&quot; title=&quot;mybatis注解&quot;&gt;&lt;/a&gt;mybatis注解&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;新建&lt;code&gt;UserMapperAnnotation.java&lt;/code&gt;文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public interface UserMapperAnnotation {

    @Insert(&amp;quot;insert into user(username, password, email) values(#{username}, #{password}, #{email})&amp;quot;)
    @Options(useGeneratedKeys=true, keyProperty=&amp;quot;id&amp;quot;)
    public Integer addUser(User user);

    @Delete(&amp;quot;delete from user where id = #{id}&amp;quot;)
    public void delUser(Integer id);

    @Update(&amp;quot;update user set password = #{password} where id = #{id}&amp;quot;)
    public void updateUser(User user);

    @Select(&amp;quot;select id, username, password, email from user where id = #{id}&amp;quot;)
    public User getUserById(Integer id);

    @Select(&amp;quot;select id, username, password, email from user&amp;quot;)
    public List&amp;lt;User&amp;gt; getAll();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="mybatis" scheme="http://blog.golearns.org/categories/mybatis/"/>
    
    
      <category term="mybatis" scheme="http://blog.golearns.org/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>mybatis-操作</title>
    <link href="http://blog.golearns.org/2017/05/07/mybatis-%E6%93%8D%E4%BD%9C/"/>
    <id>http://blog.golearns.org/2017/05/07/mybatis-操作/</id>
    <published>2017-05-07T04:09:39.000Z</published>
    <updated>2017-05-07T05:09:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mybatis操作"><a href="#mybatis操作" class="headerlink" title="mybatis操作"></a>mybatis操作</h1><ul>
<li><p>表结构</p>
<pre><code>CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(100) NOT NULL,
  `password` varchar(100) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
</code></pre></li>
</ul>
<a id="more"></a>    
<ul>
<li>创建Java Bean文件<code>User.java</code></li>
<li><p>创建<code>UserMapper.java</code>接口文件</p>
<pre><code>public interface UserMapper {

    public Integer addUser(User user);
    public void delUser(Integer id);
    public void updateUser(User user);
    public User getUserById(Integer id);
    public List&lt;User&gt; getAll();
}
</code></pre></li>
<li><p>在类路径下创建<code>UserMapper.xml</code></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.example.mybatis.mapper.UserMapper&quot;&gt;
    &lt;insert id=&quot;addUser&quot; parameterType=&quot;com.example.mybatis.model.User&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;
        insert into user(username, password, email) values(#{username}, #{password}, #{email})
    &lt;/insert&gt;
    &lt;delete id=&quot;delUser&quot; parameterType=&quot;Integer&quot;&gt;
        delete from user where id = #{id}
    &lt;/delete&gt;
    &lt;update id=&quot;updateUser&quot; parameterType=&quot;com.example.mybatis.model.User&quot;&gt;
        update user set password = #{password} where id = #{id}
    &lt;/update&gt;
    &lt;select id=&quot;getUserById&quot; resultType=&quot;com.example.mybatis.model.User&quot; parameterType=&quot;Integer&quot;&gt;
        select id, username, password, email from user where id = #{id}
    &lt;/select&gt;
    &lt;select id=&quot;getAll&quot; resultType=&quot;com.example.mybatis.model.User&quot;&gt;
        select id, username, password, email from user
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre></li>
<li><p>在mybatis-config.xml的configuration标签里加入</p>
<pre><code>&lt;mappers&gt;
    &lt;mapper resource=&quot;UserMapper.xml&quot;/&gt;
&lt;/mappers&gt;
</code></pre></li>
<li><p>创建junit测试文件</p>
<pre><code>public class TestUserMapper {

    private SqlSessionFactory sessionFactory;

    @Before
    public void init() throws IOException {
        InputStream inputStream = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);
        sessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
    }

    @Test
    public void testAddUser() {
        try (SqlSession session = sessionFactory.openSession()) {
            UserMapper userMapper = session.getMapper(UserMapper.class);
            User user = new User(&quot;lisi&quot;, &quot;123456&quot;, &quot;lisi@qq.com&quot;);
            userMapper.addUser(user);
            session.commit();

            System.out.println(&quot;last user id: &quot; + user.getId());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testDelUser() {
        try (SqlSession session = sessionFactory.openSession()) {
            UserMapper userMapper = session.getMapper(UserMapper.class);
            userMapper.delUser(10);
            session.commit();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testUpdateUser() {
        try (SqlSession session = sessionFactory.openSession()) {
            UserMapper userMapper = session.getMapper(UserMapper.class);
            User user = new User();
            user.setId(1);
            user.setPassword(&quot;654321&quot;);
            userMapper.updateUser(user);
            session.commit();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testGetUserById() {
        try (SqlSession session = sessionFactory.openSession()) {
            UserMapper userMapper = session.getMapper(UserMapper.class);
            User user = userMapper.getUserById(1);
            System.out.println(user);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testGetAll() {
        try (SqlSession session = sessionFactory.openSession()) {
            UserMapper userMapper = session.getMapper(UserMapper.class);
            List&lt;User&gt; lists = userMapper.getAll();
            System.out.println(lists);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mybatis操作&quot;&gt;&lt;a href=&quot;#mybatis操作&quot; class=&quot;headerlink&quot; title=&quot;mybatis操作&quot;&gt;&lt;/a&gt;mybatis操作&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;表结构&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(100) NOT NULL,
  `password` varchar(100) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="mybatis" scheme="http://blog.golearns.org/categories/mybatis/"/>
    
    
      <category term="mybatis" scheme="http://blog.golearns.org/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>mybatis环境安装</title>
    <link href="http://blog.golearns.org/2017/05/07/mybatis%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"/>
    <id>http://blog.golearns.org/2017/05/07/mybatis环境安装/</id>
    <published>2017-05-07T02:08:54.000Z</published>
    <updated>2017-05-07T05:10:13.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mybatis环境安装"><a href="#mybatis环境安装" class="headerlink" title="mybatis环境安装"></a>mybatis环境安装</h1><h2 id="Eclipse插件安装"><a href="#Eclipse插件安装" class="headerlink" title="Eclipse插件安装"></a>Eclipse插件安装</h2><pre><code>Help -&gt; Eclipse Marketplace -&gt; Search -&gt; MyBatipse -&gt; install
</code></pre><a id="more"></a>    
<h2 id="新建maven-project-simple-project"><a href="#新建maven-project-simple-project" class="headerlink" title="新建maven project(simple project)"></a>新建maven project(simple project)</h2><ul>
<li><p>pom.xml</p>
<pre><code>&lt;profiles&gt;
    &lt;profile&gt;
        &lt;activation&gt;
            &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;
            &lt;jdk&gt;1.8&lt;/jdk&gt;
        &lt;/activation&gt;
        &lt;properties&gt;
            &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
            &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
            &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
            &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
            &lt;maven.compiler.compilerVersion&gt;1.8&lt;/maven.compiler.compilerVersion&gt;
            &lt;java.version&gt;1.8&lt;/java.version&gt;
            &lt;mybatis.version&gt;3.4.1&lt;/mybatis.version&gt;
            &lt;mysql.version&gt;5.1.40&lt;/mysql.version&gt;
            &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt;
            &lt;junit.version&gt;4.12&lt;/junit.version&gt;
            &lt;mybatis.ehcache.version&gt;1.1.0&lt;/mybatis.ehcache.version&gt;
        &lt;/properties&gt;
    &lt;/profile&gt;
&lt;/profiles&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
        &lt;version&gt;${mybatis.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;version&gt;${mysql.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j&lt;/artifactId&gt;
        &lt;version&gt;${log4j.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis.caches&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-ehcache&lt;/artifactId&gt;
        &lt;version&gt;${mybatis.ehcache.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;junit&lt;/groupId&gt;
        &lt;artifactId&gt;junit&lt;/artifactId&gt;
        &lt;version&gt;${junit.version}&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre><ul>
<li>maven -&gt; update project</li>
<li><p>resources下创建mybatis-config.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
  PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
    &lt;!-- 数据库配置文件 --&gt;
    &lt;properties resource=&quot;jdbc.properties&quot;&gt;&lt;/properties&gt;
    &lt;settings&gt;
        &lt;!-- 开启缓存和懒加载 --&gt;
        &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;
        &lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;
        &lt;setting name=&quot;aggressiveLazyLoading&quot; value=&quot;false&quot;/&gt;
        &lt;!-- 日志使用log4j --&gt;
        &lt;setting name=&quot;logImpl&quot; value=&quot;LOG4J&quot;/&gt;
    &lt;/settings&gt;
    &lt;environments default=&quot;development&quot;&gt;
        &lt;environment id=&quot;development&quot;&gt;
            &lt;transactionManager type=&quot;JDBC&quot; /&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;${jdbc.driverClass}&quot; /&gt;
                &lt;property name=&quot;url&quot; value=&quot;${jdbc.jdbcUrl}&quot; /&gt;
                &lt;property name=&quot;username&quot; value=&quot;${jdbc.user}&quot; /&gt;
                &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot; /&gt;
            &lt;/dataSource&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;
&lt;/configuration&gt;
</code></pre></li>
<li><p>创建jdbc.properties</p>
<pre><code>jdbc.user=root
jdbc.password=123456
jdbc.driverClass=com.mysql.jdbc.Driver
jdbc.jdbcUrl=jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true
</code></pre></li>
<li><p>log4j.properties</p>
<pre><code>log4j.rootLogger=DEBUG, stdout

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d %p [%c] - %m %n

# General Apache libraries
log4j.logger.org.apache=WARN

# Disable verbose logging
log4j.java.sql=DEBUG
log4j.category.org.apache.ibatis=DEBUG
</code></pre></li>
<li><p>为了方便提示</p>
<pre><code>下载:
    http://mybatis.org/dtd/mybatis-3-mapper.dtd
    http://mybatis.org/dtd/mybatis-3-config.dtd

Eclise -&gt; 偏好设置 -&gt; XML -&gt; XML Catalog -&gt; add
</code></pre><p>  <img src="http://7xj3i5.com1.z0.glb.clouddn.com/mybatisConfig.png" alt="mybatis-config">
  <img src="http://7xj3i5.com1.z0.glb.clouddn.com/mybatisMapper.png" alt="mybatis-mapper"></p>
</li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mybatis环境安装&quot;&gt;&lt;a href=&quot;#mybatis环境安装&quot; class=&quot;headerlink&quot; title=&quot;mybatis环境安装&quot;&gt;&lt;/a&gt;mybatis环境安装&lt;/h1&gt;&lt;h2 id=&quot;Eclipse插件安装&quot;&gt;&lt;a href=&quot;#Eclipse插件安装&quot; class=&quot;headerlink&quot; title=&quot;Eclipse插件安装&quot;&gt;&lt;/a&gt;Eclipse插件安装&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;Help -&amp;gt; Eclipse Marketplace -&amp;gt; Search -&amp;gt; MyBatipse -&amp;gt; install
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="mybatis" scheme="http://blog.golearns.org/categories/mybatis/"/>
    
    
      <category term="mybatis" scheme="http://blog.golearns.org/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-快速复制数据库</title>
    <link href="http://blog.golearns.org/2016/11/10/MySQL-%E5%BF%AB%E9%80%9F%E5%A4%8D%E5%88%B6%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <id>http://blog.golearns.org/2016/11/10/MySQL-快速复制数据库/</id>
    <published>2016-11-10T11:52:25.000Z</published>
    <updated>2016-11-10T11:52:45.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mysql-快速复制数据库"><a href="#mysql-快速复制数据库" class="headerlink" title="mysql 快速复制数据库"></a>mysql 快速复制数据库</h1><ul>
<li><p>从shopimport 复制到 shopimport2</p>
<pre><code>./mysqldump shopimport -uroot -p123456 --add-drop-table | ./mysql shopimport2 -uroot -p123456
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mysql-快速复制数据库&quot;&gt;&lt;a href=&quot;#mysql-快速复制数据库&quot; class=&quot;headerlink&quot; title=&quot;mysql 快速复制数据库&quot;&gt;&lt;/a&gt;mysql 快速复制数据库&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;从shopimport 复制到 s
    
    </summary>
    
      <category term="MySQL" scheme="http://blog.golearns.org/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://blog.golearns.org/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>mysql定时任务</title>
    <link href="http://blog.golearns.org/2016/11/10/MySQL-%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/"/>
    <id>http://blog.golearns.org/2016/11/10/MySQL-定时任务/</id>
    <published>2016-11-10T11:47:59.000Z</published>
    <updated>2016-11-11T02:10:45.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mysql-定时任务"><a href="#mysql-定时任务" class="headerlink" title="mysql 定时任务"></a>mysql 定时任务</h1><blockquote>
<p><code>[on completion [not] preserve]</code>可以设置这个事件是执行一次还是持久执行,默认为<code>not preserve。</code>
<code>[enable | disenable]</code>可是设置该事件创建后状态是否开启或关闭,默认为<code>enable</code>。
<code>[commet &#39;commet&#39;]</code>可以给该事件加上注释。</p>
</blockquote>
<h2 id="查看定时任务"><a href="#查看定时任务" class="headerlink" title="查看定时任务"></a>查看定时任务</h2><pre><code>show events;
</code></pre><h2 id="查看是否开启定时任务"><a href="#查看是否开启定时任务" class="headerlink" title="查看是否开启定时任务"></a>查看是否开启定时任务</h2><pre><code>SHOW VARIABLES LIKE &apos;event_scheduler&apos;;
</code></pre><a id="more"></a>
<h2 id="关闭定时任务"><a href="#关闭定时任务" class="headerlink" title="关闭定时任务"></a>关闭定时任务</h2><pre><code>alter event EVENT_NAME disable;
</code></pre><h2 id="开启定时任务"><a href="#开启定时任务" class="headerlink" title="开启定时任务"></a>开启定时任务</h2><pre><code>alter event EVENT_NAME enable;
</code></pre><h2 id="删除定时任务"><a href="#删除定时任务" class="headerlink" title="删除定时任务"></a>删除定时任务</h2><pre><code>drop event EVENT_NAME;
</code></pre><h2 id="开启定时任务的几种方式"><a href="#开启定时任务的几种方式" class="headerlink" title="开启定时任务的几种方式"></a>开启定时任务的几种方式</h2><pre><code>SET GLOBAL event_scheduler = ON;
SET @@global.event_scheduler = ON;
SET GLOBAL event_scheduler = 1;
SET @@global.event_scheduler = 1;
</code></pre><h2 id="关闭定时任务的几种方式"><a href="#关闭定时任务的几种方式" class="headerlink" title="关闭定时任务的几种方式"></a>关闭定时任务的几种方式</h2><pre><code>SET GLOBAL event_scheduler = OFF;
SET @@global.event_scheduler = OFF;
SET GLOBAL event_scheduler = 0;
SET @@global.event_scheduler = 0;
</code></pre><h2 id="或者修改my-cnf-my-ini配置文件"><a href="#或者修改my-cnf-my-ini配置文件" class="headerlink" title="或者修改my.cnf || my.ini配置文件"></a>或者修改<code>my.cnf</code> || <code>my.ini</code>配置文件</h2><pre><code>event_scheduler=ENABLE
event_scheduler=DISABLED
</code></pre><h2 id="创建事件"><a href="#创建事件" class="headerlink" title="创建事件"></a>创建事件</h2><pre><code>create evnet  [if not exists] event_name
on schedule schedule
[on completion [not] preserve]
[enable | disenable]
[commet &apos;commet&apos;]
do sql_statement;
schedule:
AT timestamp [+ interval interval] | every interval [starts timestamp] [ends timestamp]
interval:
quantity {year | quarter | month | day | hour | minute | week | sencond | year_month | day_hour | day_minute | day_sencond | hour_minute | hour_sencond | minute_sencond}
</code></pre><h2 id="创建一个定时任务每隔1s向表中插入数据"><a href="#创建一个定时任务每隔1s向表中插入数据" class="headerlink" title="创建一个定时任务每隔1s向表中插入数据"></a>创建一个定时任务每隔1s向表中插入数据</h2><pre><code>create event event_table_insert
on schedule every 1 sencond
do insert into TABLE_NAME values(now());
</code></pre><h2 id="10天后清空表"><a href="#10天后清空表" class="headerlink" title="10天后清空表"></a>10天后清空表</h2><pre><code>create event event_truct_table
on schedule at current_timestamp + interal 10 day
do truncate table TABLE_NAME;
</code></pre><h2 id="2016年11月11号00-00-00清空表"><a href="#2016年11月11号00-00-00清空表" class="headerlink" title="2016年11月11号00:00:00清空表"></a>2016年11月11号00:00:00清空表</h2><pre><code>create event event_time_truct_table
on schedule at timestamp &apos;2016-11-11 00:00:00&apos;
do truncate table TABLE_NAME;
</code></pre><h2 id="2天后开启每天定时清空表，一年后停止执行"><a href="#2天后开启每天定时清空表，一年后停止执行" class="headerlink" title="2天后开启每天定时清空表，一年后停止执行"></a>2天后开启每天定时清空表，一年后停止执行</h2><pre><code>create event event_time_year_truct_table
on schedule every 1 day
starts current_timestamp + interval  2 day
ends   current_timestamp + interval 1 year
do truncate table TABLE_NAME;
</code></pre><h2 id="5天后开启每天定时清空表，一个月后停止执行"><a href="#5天后开启每天定时清空表，一个月后停止执行" class="headerlink" title="5天后开启每天定时清空表，一个月后停止执行"></a>5天后开启每天定时清空表，一个月后停止执行</h2><pre><code>CREATE EVENT e_test
ON SCHEDULE EVERY 1 DAY
STARTS CURRENT_TIMESTAMP + INTERVAL 5 DAY
ENDS CURRENT_TIMESTAMP + INTERVAL 1 MONTH
DO TRUNCATE TABLE TABLE_NAME;
</code></pre><h2 id="每天定时清空表，只执行一次，任务完成后就终止该事件"><a href="#每天定时清空表，只执行一次，任务完成后就终止该事件" class="headerlink" title="每天定时清空表，只执行一次，任务完成后就终止该事件"></a>每天定时清空表，只执行一次，任务完成后就终止该事件</h2><pre><code>create evnet event_one_truct_table
on schedule every 1 day
on completion not preserve
do truncate table TABLE_NAME;
</code></pre><h2 id="从现在开始每隔9天定时执行"><a href="#从现在开始每隔9天定时执行" class="headerlink" title="从现在开始每隔9天定时执行"></a>从现在开始每隔9天定时执行</h2><pre><code>CREATE EVENT EVENT1
ON SCHEDULE EVERY 9 DAY STARTS NOW()
ON COMPLETION PRESERVE ENABLE
DO
BEGIN
    CALL TOTAL();
END  
</code></pre><h2 id="每个月的一号凌晨1点执行"><a href="#每个月的一号凌晨1点执行" class="headerlink" title="每个月的一号凌晨1点执行"></a>每个月的一号凌晨1点执行</h2><pre><code>CREATE EVENT EVENT2
ON SCHEDULE EVERY 1 MONTH STARTS 
DATE_ADD(DATE_ADD(DATE_SUB(CURDATE(),INTERVAL DAY(CURDATE())-1 DAY), 
INTERVAL 1 MONTH),INTERVAL 1 HOUR)
ON COMPLETION PRESERVE ENABLE
DO
BEGIN
    CALL STAT();
END
</code></pre><h2 id="每个季度一号的凌晨2点执行"><a href="#每个季度一号的凌晨2点执行" class="headerlink" title="每个季度一号的凌晨2点执行"></a>每个季度一号的凌晨2点执行</h2><pre><code>CREATE  EVENT TOTAL_SEASON_EVENT
ON SCHEDULE EVERY 1 QUARTER STARTS 
DATE_ADD(DATE_ADD(DATE( CONCAT(YEAR(CURDATE()),&apos;-&apos;,ELT(QUARTER(CURDATE()),1,4,7,10),&apos;-&apos;,1)),INTERVAL 1 QUARTER),INTERVAL 2 HOUR)  
ON COMPLETION PRESERVE ENABLE  
DO
BEGIN
    CALL SEASON_STAT();
END
</code></pre><h2 id="每年1月1号凌晨4点执行"><a href="#每年1月1号凌晨4点执行" class="headerlink" title="每年1月1号凌晨4点执行"></a>每年1月1号凌晨4点执行</h2><pre><code>CREATE  EVENT TOTAL_YEAR_EVENT  
ON SCHEDULE EVERY 1 YEAR STARTS 
DATE_ADD(DATE(CONCAT(YEAR(CURDATE()) + 1,&apos;-&apos;,1,&apos;-&apos;,1)),INTERVAL 4 HOUR)  
ON COMPLETION PRESERVE ENABLE
DO
BEGIN
    CALL YEAR_STAT();
END
</code></pre><h2 id="事件开启和关闭"><a href="#事件开启和关闭" class="headerlink" title="事件开启和关闭"></a>事件开启和关闭</h2><pre><code>开启：ALTER EVENT EVENT_NAME ON COMPLETION PRESERVE ENABLE;
关闭：ALTER EVENT EVENT_NAME ON COMPLETION PRESERVE DISABLE;
</code></pre><ul>
<li><strong>对于主从架构的数据库要注意将从库的任务调度关闭，以防止在主库执行了之后，从库又重复在备库进行调度evnet。</strong></li>
<li><strong>对于我们线上环境来说，使用event时，注意在主库上开启定时器，从库上关闭定时器，event触发所有操作均会记录binlog进行主从同步，从库上开启定时器很可能造成卡库。切换主库后之后记得将新主库上的定时器打开。</strong></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mysql-定时任务&quot;&gt;&lt;a href=&quot;#mysql-定时任务&quot; class=&quot;headerlink&quot; title=&quot;mysql 定时任务&quot;&gt;&lt;/a&gt;mysql 定时任务&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;[on completion [not] preserve]&lt;/code&gt;可以设置这个事件是执行一次还是持久执行,默认为&lt;code&gt;not preserve。&lt;/code&gt;
&lt;code&gt;[enable | disenable]&lt;/code&gt;可是设置该事件创建后状态是否开启或关闭,默认为&lt;code&gt;enable&lt;/code&gt;。
&lt;code&gt;[commet &amp;#39;commet&amp;#39;]&lt;/code&gt;可以给该事件加上注释。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;查看定时任务&quot;&gt;&lt;a href=&quot;#查看定时任务&quot; class=&quot;headerlink&quot; title=&quot;查看定时任务&quot;&gt;&lt;/a&gt;查看定时任务&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;show events;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;查看是否开启定时任务&quot;&gt;&lt;a href=&quot;#查看是否开启定时任务&quot; class=&quot;headerlink&quot; title=&quot;查看是否开启定时任务&quot;&gt;&lt;/a&gt;查看是否开启定时任务&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;SHOW VARIABLES LIKE &amp;apos;event_scheduler&amp;apos;;
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="MySQL" scheme="http://blog.golearns.org/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://blog.golearns.org/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Chrome浏览器如何静音</title>
    <link href="http://blog.golearns.org/2016/10/09/Chrome%E6%B5%8F%E8%A7%88%E5%99%A8%E5%A6%82%E4%BD%95%E9%9D%99%E9%9F%B3/"/>
    <id>http://blog.golearns.org/2016/10/09/Chrome浏览器如何静音/</id>
    <published>2016-10-09T06:18:47.000Z</published>
    <updated>2016-10-09T06:19:47.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Chrome浏览器如何静音"><a href="#Chrome浏览器如何静音" class="headerlink" title="Chrome浏览器如何静音"></a>Chrome浏览器如何静音</h1><ul>
<li>在浏览器输入<code>chrome://flags/#enable-tab-audio-muting</code>
<img src="http://7xj3i5.com1.z0.glb.clouddn.com/837D6910-25E7-4F61-A58A-6EAD12C4E74C.png" alt=""></li>
<li>点击启用
<img src="http://7xj3i5.com1.z0.glb.clouddn.com/1E686FEE-3542-486C-8E19-AA0AEF8F484A.png" alt=""></li>
<li>重新启动
<img src="http://7xj3i5.com1.z0.glb.clouddn.com/547E1019-6B59-40CA-A793-825006856A72.png" alt=""></li>
<li>点击声音可以开启和静音,也可以在标签上通过右键来设置。</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Chrome浏览器如何静音&quot;&gt;&lt;a href=&quot;#Chrome浏览器如何静音&quot; class=&quot;headerlink&quot; title=&quot;Chrome浏览器如何静音&quot;&gt;&lt;/a&gt;Chrome浏览器如何静音&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;在浏览器输入&lt;code&gt;chrome:/
    
    </summary>
    
      <category term="Chrome" scheme="http://blog.golearns.org/categories/Chrome/"/>
    
    
      <category term="Chrome" scheme="http://blog.golearns.org/tags/Chrome/"/>
    
  </entry>
  
  <entry>
    <title>Druid+Springboot配置</title>
    <link href="http://blog.golearns.org/2016/09/28/Druid-Springboot%E9%85%8D%E7%BD%AE/"/>
    <id>http://blog.golearns.org/2016/09/28/Druid-Springboot配置/</id>
    <published>2016-09-28T03:20:30.000Z</published>
    <updated>2016-09-28T03:25:57.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Druid-Springboot配置"><a href="#Druid-Springboot配置" class="headerlink" title="Druid + Springboot配置"></a>Druid + Springboot配置</h1><ul>
<li><p>pom.xml配置</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;druid&lt;/artifactId&gt;
    &lt;version&gt;1.0.24&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>  <a id="more"></a></li>
<li><p>DruidConfiguration配置</p>
<pre><code>import java.sql.SQLException;

import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.alibaba.druid.pool.DruidDataSource;

@Configuration
public class DruidConfiguration {

    @Bean
    public DataSource druidDataSource(@Value(&quot;${spring.datasource.driver-class-name}&quot;) String driver,
                                      @Value(&quot;${spring.datasource.url}&quot;) String url, 
                                      @Value(&quot;${spring.datasource.username}&quot;) String username,
                                      @Value(&quot;${spring.datasource.password}&quot;) String password) {
        DruidDataSource druidDataSource = new DruidDataSource();
        druidDataSource.setDriverClassName(driver);
        druidDataSource.setUrl(url);
        druidDataSource.setUsername(username);
        druidDataSource.setPassword(password);
        // 间隔多长时间将统计数据写入日志
        druidDataSource.setTimeBetweenLogStatsMillis(300000);
        try {
            druidDataSource.setFilters(&quot;stat, wall&quot;);
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return druidDataSource;
    }
}
</code></pre></li>
<li><p>servlet配置</p>
<pre><code>import javax.servlet.annotation.WebInitParam;
import javax.servlet.annotation.WebServlet;

import com.alibaba.druid.support.http.StatViewServlet;

@SuppressWarnings(&quot;serial&quot;)
@WebServlet(urlPatterns = &quot;/druid/*&quot;, 
initParams={
        @WebInitParam(name=&quot;allow&quot;,value=&quot;192.168.1.252,127.0.0.1&quot;),// IP白名单 (没有配置或者为空，则允许所有访问)
        @WebInitParam(name=&quot;deny&quot;,value=&quot;192.168.1.250&quot;),// IP黑名单 (存在共同时，deny优先于allow)
        @WebInitParam(name=&quot;loginUsername&quot;,value=&quot;zyk1991&quot;),// 用户名
        @WebInitParam(name=&quot;loginPassword&quot;,value=&quot;zyk123456&quot;),// 密码
        @WebInitParam(name=&quot;resetEnable&quot;,value=&quot;false&quot;)// 禁用HTML页面上的“Reset All”功能
})
public class DruidStatViewServlet extends StatViewServlet {

}
</code></pre></li>
<li><p>filter配置</p>
<pre><code>import javax.servlet.annotation.WebFilter;
import javax.servlet.annotation.WebInitParam;

import com.alibaba.druid.support.http.WebStatFilter;

@WebFilter(filterName=&quot;druidWebStatFilter&quot;,urlPatterns=&quot;/*&quot;,
initParams={
    @WebInitParam(name=&quot;exclusions&quot;,value=&quot;*.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*&quot;),// 忽略资源
    @WebInitParam(name=&quot;filters&quot;,value=&quot;log4j2&quot;) // 配置日志使用log4j2
})
public class DruidStatFilter extends WebStatFilter {

}
</code></pre></li>
<li><p>application.properties配置</p>
<pre><code>#datasource
spring.datasource.url=jdbc:mysql://localhost/test?useUnicode=true&amp;characterEncoding=UTF-8
spring.datasource.username=root
spring.datasource.password=123456
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.datasource.tomcat.max-wait=10000
spring.datasource.tomcat.max-active=50
spring.datasource.tomcat.test-on-borrow=true
</code></pre></li>
<li><p>Application配置</p>
<pre><code>@ServletComponentScan
@SpringBootApplication
public class Application extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(Application.class);
    }

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}
</code></pre></li>
<li>访问<a href="http://localhost:8080/project/druid" target="_blank" rel="external">http://localhost:8080/project/druid</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Druid-Springboot配置&quot;&gt;&lt;a href=&quot;#Druid-Springboot配置&quot; class=&quot;headerlink&quot; title=&quot;Druid + Springboot配置&quot;&gt;&lt;/a&gt;Druid + Springboot配置&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;pom.xml配置&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;com.alibaba&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;druid&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;1.0.24&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="Druid" scheme="http://blog.golearns.org/categories/Druid/"/>
    
      <category term="Springboot" scheme="http://blog.golearns.org/categories/Druid/Springboot/"/>
    
    
      <category term="druid" scheme="http://blog.golearns.org/tags/druid/"/>
    
      <category term="springboot" scheme="http://blog.golearns.org/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>PHP生成圆角图片+图片合成</title>
    <link href="http://blog.golearns.org/2016/09/23/PHP%E7%94%9F%E6%88%90%E5%9C%86%E8%A7%92%E5%9B%BE%E7%89%87-%E5%9B%BE%E7%89%87%E5%90%88%E6%88%90/"/>
    <id>http://blog.golearns.org/2016/09/23/PHP生成圆角图片-图片合成/</id>
    <published>2016-09-23T02:58:47.000Z</published>
    <updated>2016-09-23T03:26:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PHP生成圆角图片-图片合成"><a href="#PHP生成圆角图片-图片合成" class="headerlink" title="PHP生成圆角图片+图片合成"></a>PHP生成圆角图片+图片合成</h1><h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><pre><code>&lt;?php
    create_qrcode(&apos;images/head_290_00a4e60499ffb5c3.jpg&apos;, &apos;images/WechatIMG12.png&apos;, &apos;测试数据测试数据&apos;, &apos;images/create.jpg&apos;, &apos;images/test.jpg&apos;, &apos;simhei.ttf&apos;);

    echo &quot;&lt;img src=&apos;images/test.jpg&apos;/&gt;&quot;;
?&gt;
</code></pre><a id="more"></a>
<h1 id="公用方法"><a href="#公用方法" class="headerlink" title="公用方法"></a>公用方法</h1><pre><code>&lt;?php
    /** 画圆角
     * @param $radius 圆角位置
     * @param $color_r 色值0-255
     * @param $color_g 色值0-255
     * @param $color_b 色值0-255
     * @return resource 返回圆角
     */
    function get_lt_rounder_corner($radius, $color_r, $color_g, $color_b) {
        // 创建一个正方形的图像
        $img = imagecreatetruecolor($radius, $radius);
        // 图像的背景
        $bgcolor = imagecolorallocate($img, $color_r, $color_g, $color_b);

        // 设置透明度
        // $bgcolor = imagecolorallocatealpha($img, $color_r, $color_g, $color_b, 127);
        $fgcolor = imagecolorallocate($img, 0, 0, 0);
        imagefill($img, 0, 0, $bgcolor);

        /**
         * $radius,$radius：以图像的右下角开始画弧
         * $radius*2, $radius*2：已宽度、高度画弧
         * 180, 270：指定了角度的起始和结束点
         * fgcolor：指定颜色
         */
        imagefilledarc($img, $radius, $radius, $radius * 2, $radius * 2, 180, 270, $fgcolor, IMG_ARC_PIE);
        // 将弧角图片的颜色设置为透明
        imagecolortransparent($img, $fgcolor);
        return $img;
    }

    /**
     * 画一个带圆角的背景图
     * @param $im  底图
     * @param $dst_x 画出的图的（0，0）位于底图的x轴位置
     * @param $dst_y 画出的图的（0，0）位于底图的y轴位置
     * @param $image_w 画的图的宽
     * @param $image_h 画的图的高
     * @param $radius 圆角的值
     */
    function imagebackgroundmycard($im, $dst_x, $dst_y, $image_w, $image_h, $radius) {
        $resource = imagecreatetruecolor($image_w, $image_h);

        //该图的背景色
        $bgcolor = imagecolorallocate($resource, 0xef, 0xef, 0xe1);

        imagefill($resource, 0, 0, $bgcolor);

        //圆角的背景色
        $lt_corner = get_lt_rounder_corner($radius, 255, 255, 255);

        // lt(左上角)
        imagecopymerge($resource, $lt_corner, 0, 0, 0, 0, $radius, $radius, 100);
        // lb(左下角)
        $lb_corner = imagerotate($lt_corner, 90, 0);
        imagecopymerge($resource, $lb_corner, 0, $image_h - $radius, 0, 0, $radius, $radius, 100);
        // rb(右上角)
        $rb_corner = imagerotate($lt_corner, 180, 0);
        imagecopymerge($resource, $rb_corner, $image_w - $radius, $image_h - $radius, 0, 0, $radius, $radius, 100);
        // rt(右下角)
        $rt_corner = imagerotate($lt_corner, 270, 0);
        imagecopymerge($resource, $rt_corner, $image_w - $radius, 0, 0, 0, $radius, $radius, 100);

        imagecopy($im, $resource, $dst_x, $dst_y, 0, 0, $image_w, $image_h);
    }

    /**
     * @param $im  大的背景图，也是我们的画板
     * @param $lt_corner 我们画的圆角
     * @param $radius  圆角的程度
     * @param $image_h 图片的高
     * @param $image_w 图片的宽
     */
    function myradus($im, $lift, $top, $lt_corner, $radius, $image_h, $image_w) {

        // lt(左上角)
        imagecopymerge($im, $lt_corner, $lift, $top, 0, 0, $radius, $radius, 100);
        // lb(左下角)
        $lb_corner = imagerotate($lt_corner, 90, 0);
        imagecopymerge($im, $lb_corner, $lift, $image_h - $radius + $top, 0, 0, $radius, $radius, 100);
        // rb(右上角)
        $rb_corner = imagerotate($lt_corner, 180, 0);
        imagecopymerge($im, $rb_corner, $image_w + $lift - $radius, $image_h + $top - $radius, 0, 0, $radius, $radius, 100);
        // rt(右下角)
        $rt_corner = imagerotate($lt_corner, 270, 0);
        imagecopymerge($im, $rt_corner, $image_w - $radius + $lift, $top, 0, 0, $radius, $radius, 100);
    }

    /**
     * @param $head_file 头像文件
     * @param $bg_file 背景图片
     * @param $nickname 用户昵称
     * @param $qrcode_file 二维码文件
     * @param $font_file 字体文件
     */
    function data_config($head_file = &apos;&apos;, $bg_file = &apos;&apos;, $nickanme = &apos;&apos;, $qrcode_file = &apos;&apos;, $font_file = &apos;&apos;) {

        return array(
            // 设置头像宽度和高度
            &apos;head_w_h&apos; =&gt; 90,
            // 设置头像宽度和高度
            &apos;head_w_h&apos; =&gt; 90,

            // 设置幕布rgb值
            &apos;mubu&apos; =&gt; array(255, 255, 255),

            // 头像图片文件
            &apos;head_file&apos; =&gt; $head_file,

            // 设置幕布背景色
            &apos;mubu_bg&apos; =&gt; array(227, 70, 91),

            // 背景图片文件
            &apos;bg_file&apos; =&gt; $bg_file,

            // 设置透明度
            &apos;alpha_num&apos; =&gt; 90,

            // 为背景图片分配颜色
            &apos;bg_locate&apos; =&gt; array(255, 255, 255),

            // 头像相对背景图片的位置
            &apos;head_location&apos; =&gt; array(297, 305, 100),

            // 设置文字颜色hex
            &apos;font_color&apos; =&gt; &apos;#ffffff&apos;,

            // 用户昵称
            &apos;font_text&apos; =&gt; $nickanme,

            // 字体大小
            &apos;font_size&apos; =&gt; 13,

            // 字体文件
            &apos;font_file&apos; =&gt; $font_file,

            // 文字初始坐标
            &apos;font_location&apos; =&gt; array(238, 415, 100),

            // 二维码图片文件
            &apos;qrcode&apos; =&gt; $qrcode_file,

            // 二维码初始坐标
            &apos;qr_location&apos; =&gt; array(100, 430, 100),

            // 设置二维码图片大小
            &apos;qrcode_size&apos; =&gt; array(195, 195),
        );
    }

    function create_qrcode($head_file = &apos;&apos;, $bg_file = &apos;&apos;, $nickanme = &apos;&apos;, $qrcode_file = &apos;&apos;, $save_path = &apos;&apos;, $font_file = &apos;&apos;) {
        $config = data_config($head_file, $bg_file, $nickanme, $qrcode_file, $font_file);

        // 头像圆形半径
        $head_radius = $config[&apos;head_w_h&apos;] / 2;
        //获取头像图像信息
        $head_info = getimagesize($config[&apos;head_file&apos;]);
        //获取背景图像信息
        $source_info = getimagesize($config[&apos;bg_file&apos;]);

        //获取背景图像信息
        $info = array(
            &apos;width&apos;  =&gt; $source_info[0],
            &apos;height&apos; =&gt; $source_info[1],
            &apos;type&apos;   =&gt; image_type_to_extension($source_info[2], false),
            &apos;mime&apos;   =&gt; $source_info[&apos;mime&apos;],
        );

        $im = imagecreatetruecolor($config[&apos;head_w_h&apos;], $config[&apos;head_w_h&apos;]);
        $bgcolor = imagecolorallocate($im, $config[&apos;mubu&apos;][0], $config[&apos;mubu&apos;][1], $config[&apos;mubu&apos;][2]);
        imagefill($im, 0, 0, $bgcolor);

        $img = imagecreatefromjpeg($config[&apos;head_file&apos;]);
        imagecopy($im, $img, 0, 0, 0, 0, $config[&apos;head_w_h&apos;], $config[&apos;head_w_h&apos;]);
        imagedestroy($img);
        $lt_corner = get_lt_rounder_corner($head_radius, $config[&apos;mubu_bg&apos;][0], $config[&apos;mubu_bg&apos;][1], $config[&apos;mubu_bg&apos;][2]);
        myradus($im, 0, 0, $lt_corner, $head_radius, $config[&apos;head_w_h&apos;], $config[&apos;head_w_h&apos;]);

        $backgroundImage = imagecreatefromstring(file_get_contents($config[&apos;bg_file&apos;]));

        // 获取头像的x和y轴坐标
        list($x, $y, $o) = $config[&apos;head_location&apos;];
        $x = ($info[&apos;width&apos;] - $head_info[0]) / 2;
        imagecopymerge($backgroundImage, $im, $x, $y, 0, 0, $config[&apos;head_w_h&apos;], $config[&apos;head_w_h&apos;], $config[&apos;alpha_num&apos;]);
        imagedestroy($im);

        // 设置字体颜色
        if (is_string($config[&apos;font_color&apos;]) &amp;&amp; 0 === strpos($config[&apos;font_color&apos;], &apos;#&apos;)) {
            $font_color = str_split(substr($config[&apos;font_color&apos;], 1), 2);
            $font_color = array_map(&apos;hexdec&apos;, $font_color);
            if (empty($font_color[3]) || $font_color[3] &gt; 127) {
                $font_color[3] = 0;
            }
        } elseif (!is_array($color)) {
            exit(&apos;错误的颜色值&apos;);
        }
        $col = imagecolorallocatealpha($backgroundImage, $font_color[0], $font_color[1], $font_color[2], $font_color[3]);

        $font_info = imagettfbbox($config[&apos;font_size&apos;], 0, $config[&apos;font_file&apos;], $config[&apos;font_text&apos;]);
        $minx = min($font_info[0], $font_info[2], $font_info[4], $font_info[6]); 
        $maxx = max($font_info[0], $font_info[2], $font_info[4], $font_info[6]); 
        $miny = min($font_info[1], $font_info[3], $font_info[5], $font_info[7]); 
        $maxy = max($font_info[1], $font_info[3], $font_info[5], $font_info[7]); 

        // 计算文字初始坐标和尺寸
        $x = $minx;
        $y = abs($miny);
        $w = $maxx - $minx;
        $h = $maxy - $miny;

        list($posx, $posy, $other) = $config[&apos;font_location&apos;];
        $fx = ($info[&apos;width&apos;] - $w) / 2;
        $fy = $posy;

        imagettftext($backgroundImage, $config[&apos;font_size&apos;], 0, $fx, $fy, $col, $config[&apos;font_file&apos;], $config[&apos;font_text&apos;]);

        // 可以借助Thinkphp的Image类库，对图片进行缩放
        // $image = new \Think\Image();
        // $image-&gt;open($config[&apos;qrcode&apos;])-&gt;thumb($config[&apos;qrcode_size&apos;][0], $config[&apos;qrcode_size&apos;][1])-&gt;save($config[&apos;qrcode&apos;]);

        $qrcode_info = getimagesize($config[&apos;qrcode&apos;]);

        list($qx, $qy, $o) = $config[&apos;qr_location&apos;];
        $qx = ($info[&apos;width&apos;] - $qrcode_info[0]) / 2;

        $qrcode_image = imagecreatefromstring(file_get_contents($config[&apos;qrcode&apos;]));
        imagecopymerge($backgroundImage, $qrcode_image, $qx, $qy, 0, 0, $config[&apos;qrcode_size&apos;][0], $config[&apos;qrcode_size&apos;][1], $config[&apos;alpha_num&apos;]);
        imagedestroy($qrcode_image);

        imagejpeg($backgroundImage, $save_path);
        imagedestroy($backgroundImage);
} 
?&gt;
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;PHP生成圆角图片-图片合成&quot;&gt;&lt;a href=&quot;#PHP生成圆角图片-图片合成&quot; class=&quot;headerlink&quot; title=&quot;PHP生成圆角图片+图片合成&quot;&gt;&lt;/a&gt;PHP生成圆角图片+图片合成&lt;/h1&gt;&lt;h1 id=&quot;使用方法&quot;&gt;&lt;a href=&quot;#使用方法&quot; class=&quot;headerlink&quot; title=&quot;使用方法&quot;&gt;&lt;/a&gt;使用方法&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php
    create_qrcode(&amp;apos;images/head_290_00a4e60499ffb5c3.jpg&amp;apos;, &amp;apos;images/WechatIMG12.png&amp;apos;, &amp;apos;测试数据测试数据&amp;apos;, &amp;apos;images/create.jpg&amp;apos;, &amp;apos;images/test.jpg&amp;apos;, &amp;apos;simhei.ttf&amp;apos;);

    echo &amp;quot;&amp;lt;img src=&amp;apos;images/test.jpg&amp;apos;/&amp;gt;&amp;quot;;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="PHP" scheme="http://blog.golearns.org/categories/PHP/"/>
    
    
      <category term="PHP" scheme="http://blog.golearns.org/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>tigase用户密码加密</title>
    <link href="http://blog.golearns.org/2016/08/03/tigase%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86/"/>
    <id>http://blog.golearns.org/2016/08/03/tigase用户密码加密/</id>
    <published>2016-08-03T07:36:11.000Z</published>
    <updated>2016-08-03T07:36:41.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Tigase-用户密码加密"><a href="#Tigase-用户密码加密" class="headerlink" title="Tigase 用户密码加密"></a>Tigase 用户密码加密</h1><pre><code>call TigPutDBProperty(&apos;password-encoding&apos;, &apos;MD5-PASSWORD&apos;);
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Tigase-用户密码加密&quot;&gt;&lt;a href=&quot;#Tigase-用户密码加密&quot; class=&quot;headerlink&quot; title=&quot;Tigase 用户密码加密&quot;&gt;&lt;/a&gt;Tigase 用户密码加密&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;call TigPutDBPrope
    
    </summary>
    
      <category term="Tigase" scheme="http://blog.golearns.org/categories/Tigase/"/>
    
    
      <category term="Tigase" scheme="http://blog.golearns.org/tags/Tigase/"/>
    
  </entry>
  
  <entry>
    <title>一键生成Android和IOS平台图标和启动页</title>
    <link href="http://blog.golearns.org/2016/07/22/createIcon/"/>
    <id>http://blog.golearns.org/2016/07/22/createIcon/</id>
    <published>2016-07-22T02:53:33.000Z</published>
    <updated>2016-07-22T02:54:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一键生成Android和IOS图标和启动画面"><a href="#一键生成Android和IOS图标和启动画面" class="headerlink" title="一键生成Android和IOS图标和启动画面"></a>一键生成Android和IOS图标和启动画面</h1><ul>
<li><p>操作步骤</p>
<pre><code>npm install -g ionic
ionic start myapp

cd myapp
ionic platform android ios

mkdir resources

// 拷贝高清图片到resources，命名为icon.png和splash.png
// 运行
ionic resources // 生成android和ios所需图片
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;一键生成Android和IOS图标和启动画面&quot;&gt;&lt;a href=&quot;#一键生成Android和IOS图标和启动画面&quot; class=&quot;headerlink&quot; title=&quot;一键生成Android和IOS图标和启动画面&quot;&gt;&lt;/a&gt;一键生成Android和IOS图标和启动
    
    </summary>
    
      <category term="ionic" scheme="http://blog.golearns.org/categories/ionic/"/>
    
    
      <category term="ionic" scheme="http://blog.golearns.org/tags/ionic/"/>
    
      <category term="ios图标生成" scheme="http://blog.golearns.org/tags/ios%E5%9B%BE%E6%A0%87%E7%94%9F%E6%88%90/"/>
    
      <category term="android图标生成" scheme="http://blog.golearns.org/tags/android%E5%9B%BE%E6%A0%87%E7%94%9F%E6%88%90/"/>
    
  </entry>
  
  <entry>
    <title>Ectouch数据库字典</title>
    <link href="http://blog.golearns.org/2016/07/21/table/"/>
    <id>http://blog.golearns.org/2016/07/21/table/</id>
    <published>2016-07-21T05:52:10.000Z</published>
    <updated>2016-07-21T10:37:28.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ectouch2-0-数据库结构"><a href="#Ectouch2-0-数据库结构" class="headerlink" title="Ectouch2.0 数据库结构"></a>Ectouch2.0 数据库结构</h1><h2 id="用户账目日志表ecs-account-log"><a href="#用户账目日志表ecs-account-log" class="headerlink" title="用户账目日志表ecs_account_log"></a>用户账目日志表<code>ecs_account_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>mediumint(8)</td>
<td>日志ID</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户ID</td>
</tr>
<tr>
<td>user_money</td>
<td>decimal(10,2)</td>
<td>用户该笔记录的余额</td>
</tr>
<tr>
<td>frozen_money</td>
<td>decimal(10,2)</td>
<td>被冻结的资金</td>
</tr>
<tr>
<td>rank_points</td>
<td>mediumint(9)</td>
<td>等级积分，跟消费积分是分开的</td>
</tr>
<tr>
<td>pay_points</td>
<td>mediumint(9)</td>
<td>消费积分，跟等级积分是分开的</td>
</tr>
<tr>
<td>change_time</td>
<td>int(10)</td>
<td>该笔操作发生的事件</td>
</tr>
<tr>
<td>change_desc</td>
<td>varchar(255)</td>
<td>该笔操作的备注</td>
</tr>
<tr>
<td>change_type</td>
<td>tinyint(3)</td>
<td>操作类型，0: 充值，1: 提现，2: 管理员调节，99: 其它类型</td>
</tr>
</tbody>
</table>
<a id="more"></a>
<h2 id="广告表ecs-ad"><a href="#广告表ecs-ad" class="headerlink" title="广告表ecs_ad"></a>广告表<code>ecs_ad</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ad_id</td>
<td>smallint(5)</td>
<td>广告ID</td>
</tr>
<tr>
<td>position_id</td>
<td>smallint(5)</td>
<td>0,站外广告;从1开始代表的是该广告所处的广告位,同ad_postition中的字段position_id的值</td>
</tr>
<tr>
<td>media_type</td>
<td>tinyint(3)</td>
<td>广告类型,0: 图片，1: flash，2: 代码，3: 文字</td>
</tr>
<tr>
<td>ad_name</td>
<td>varchar(60)</td>
<td>名称</td>
</tr>
<tr>
<td>ad_link</td>
<td>varchar(255)</td>
<td>链接地址</td>
</tr>
<tr>
<td>ad_code</td>
<td>text</td>
<td>广告链接的表现,文字广告就是文字或图片和flash就是它们的地址</td>
</tr>
<tr>
<td>start_time</td>
<td>int(11)</td>
<td>广告开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int(11)</td>
<td>广告结束时间</td>
</tr>
<tr>
<td>link_man</td>
<td>varchar(60)</td>
<td>广告联系人</td>
</tr>
<tr>
<td>link_email</td>
<td>varchar(60)</td>
<td>广告联系人邮箱</td>
</tr>
<tr>
<td>link_phone</td>
<td>varchar(60)</td>
<td>广告联系人电话</td>
</tr>
<tr>
<td>click_count</td>
<td>mediumint(8)</td>
<td>点击次数</td>
</tr>
<tr>
<td>enabled</td>
<td>tinyint(3)</td>
<td>该广告是否关闭，1: 开启，0: 关闭</td>
</tr>
</tbody>
</table>
<h2 id="管理权限分配表ecs-admin-action"><a href="#管理权限分配表ecs-admin-action" class="headerlink" title="管理权限分配表ecs_admin_action"></a>管理权限分配表<code>ecs_admin_action</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>action_id</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>parent_id</td>
<td>tinyint(3)</td>
<td>父ID</td>
</tr>
<tr>
<td>action_code</td>
<td>varchar(20)</td>
<td>权限的英文字符串</td>
</tr>
<tr>
<td>relevance</td>
<td>varchar(20)</td>
</tr>
</tbody>
</table>
<h2 id="管理日志表ecs-admin-log"><a href="#管理日志表ecs-admin-log" class="headerlink" title="管理日志表ecs_admin_log"></a>管理日志表<code>ecs_admin_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>int(10)</td>
<td>日志ID</td>
</tr>
<tr>
<td>log_time</td>
<td>int(10)</td>
<td>操作时间</td>
</tr>
<tr>
<td>user_id</td>
<td>tinyint(3)</td>
<td>操作者ID，admin_user的ID</td>
</tr>
<tr>
<td>log_info</td>
<td>varchar(255)</td>
<td>日志信息</td>
</tr>
<tr>
<td>ip_address</td>
<td>varchar(15)</td>
<td>ip地址</td>
</tr>
</tbody>
</table>
<h2 id="管理员留言表ecs-admin-message"><a href="#管理员留言表ecs-admin-message" class="headerlink" title="管理员留言表ecs_admin_message"></a>管理员留言表<code>ecs_admin_message</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>message_id</td>
<td>smallint(5)</td>
<td>留言ID</td>
</tr>
<tr>
<td>sender_id</td>
<td>tinyint(3)</td>
<td>发送该留言的管理员id,同admin_user的user_id</td>
</tr>
<tr>
<td>receiver_id</td>
<td>tinyint(3)</td>
<td>接收消息管理员id,同admin_user的user_id,如果是给多个管理员发送,则同一个消息给每个管理员id发送一条</td>
</tr>
<tr>
<td>sent_time</td>
<td>int(11)</td>
<td>发送时间</td>
</tr>
<tr>
<td>read_time</td>
<td>int(11)</td>
<td>阅读时间</td>
</tr>
<tr>
<td>readed</td>
<td>tinyint(1)</td>
<td>留言是否阅读1已阅读;0未阅读</td>
</tr>
<tr>
<td>deleted</td>
<td>tinyint(1)</td>
<td>留言是否已经被删除 1已删除;0未删除</td>
</tr>
<tr>
<td>title</td>
<td>varchar(150)</td>
<td>留言的主题</td>
</tr>
<tr>
<td>message</td>
<td>text</td>
<td>留言的内容</td>
</tr>
</tbody>
</table>
<h2 id="管理员管理表ecs-admin-user"><a href="#管理员管理表ecs-admin-user" class="headerlink" title="管理员管理表ecs_admin_user"></a>管理员管理表<code>ecs_admin_user</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>smallint(5)</td>
<td>用户ID</td>
</tr>
<tr>
<td>user_name</td>
<td>varchar(60)</td>
<td>登录名</td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>邮箱</td>
</tr>
<tr>
<td>password</td>
<td>varchar(32)</td>
<td>密码</td>
</tr>
<tr>
<td>ec_salt</td>
<td>varchar(10)</td>
<td>salt值</td>
</tr>
<tr>
<td>add_time</td>
<td>int(11)</td>
<td>添加时间</td>
</tr>
<tr>
<td>last_login</td>
<td>int(11)</td>
<td>最后登录时间</td>
</tr>
<tr>
<td>last_ip</td>
<td>varchar(15)</td>
<td>登录ip</td>
</tr>
<tr>
<td>action_list</td>
<td>text</td>
<td>权限列表</td>
</tr>
<tr>
<td>nav_list</td>
<td>text</td>
<td>导航栏配置项</td>
</tr>
<tr>
<td>lang_type</td>
<td>varchar(50)</td>
<td>语言类型</td>
</tr>
<tr>
<td>agency_id</td>
<td>smallint(5)</td>
<td>该管理员负责的办事处理的id,同agency的agency_id字段.如果管理员没有负责办事处,则此处为0</td>
</tr>
<tr>
<td>suppliers_id</td>
<td>smallint(5)</td>
<td>供货商ID</td>
</tr>
<tr>
<td>todolist</td>
<td>longtext</td>
<td>记事本记录的数据</td>
</tr>
<tr>
<td>role_id</td>
<td>smallint(5)</td>
<td>角色ID</td>
</tr>
</tbody>
</table>
<h2 id="广告点击率统计表ecs-adsense"><a href="#广告点击率统计表ecs-adsense" class="headerlink" title="广告点击率统计表ecs_adsense"></a>广告点击率统计表<code>ecs_adsense</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>from_ad</td>
<td>smallint(5)</td>
<td>广告代码，－1: 外部广告，如果是站内广告则为ad表中的ad_id</td>
</tr>
<tr>
<td>referer</td>
<td>varchar(255)</td>
<td>页面来源</td>
</tr>
<tr>
<td>clicks</td>
<td>varchar(255)</td>
<td>点击率</td>
</tr>
</tbody>
</table>
<h2 id="自定义广告表ecs-ad-custom"><a href="#自定义广告表ecs-ad-custom" class="headerlink" title="自定义广告表ecs_ad_custom"></a>自定义广告表<code>ecs_ad_custom</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ad_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>ad_type</td>
<td>tinyint(1)</td>
<td>广告类型</td>
</tr>
<tr>
<td>ad_name</td>
<td>varchar(60)</td>
<td>广告名称</td>
</tr>
<tr>
<td>add_time</td>
<td>int(10)</td>
<td>添加时间</td>
</tr>
<tr>
<td>content</td>
<td>mediumtext</td>
<td>内容</td>
</tr>
<tr>
<td>url</td>
<td>varchar(255)</td>
<td>链接地址</td>
</tr>
<tr>
<td>ad_status</td>
<td>tinyint(3)</td>
<td>广告状态</td>
</tr>
</tbody>
</table>
<h2 id="广告位表ecs-ad-position"><a href="#广告位表ecs-ad-position" class="headerlink" title="广告位表ecs_ad_position"></a>广告位表<code>ecs_ad_position</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>position_id</td>
<td>int(10)</td>
<td>广告位ID</td>
</tr>
<tr>
<td>position_name</td>
<td>varchar(60)</td>
<td>广告位名称</td>
</tr>
<tr>
<td>ad_width</td>
<td>smallint(5)</td>
<td>广告位宽度</td>
</tr>
<tr>
<td>ad_height</td>
<td>smallint(5)</td>
<td>广告位高度</td>
</tr>
<tr>
<td>position_desc</td>
<td>varchar(255)</td>
<td>描述</td>
</tr>
<tr>
<td>position_style</td>
<td>text</td>
<td>模版代码</td>
</tr>
</tbody>
</table>
<h2 id="管理日志ecs-affiliate-log"><a href="#管理日志ecs-affiliate-log" class="headerlink" title="管理日志ecs_affiliate_log"></a>管理日志<code>ecs_affiliate_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>mediumint(8)</td>
<td>日志ID</td>
</tr>
<tr>
<td>order_id</td>
<td>mediumint(8)</td>
<td>排序</td>
</tr>
<tr>
<td>time</td>
<td>int(10)</td>
<td>时间</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户ID</td>
</tr>
<tr>
<td>user_name</td>
<td>varchar(60)</td>
<td>用户名</td>
</tr>
<tr>
<td>money</td>
<td>decimal(10,2)</td>
<td></td>
</tr>
<tr>
<td>point</td>
<td>int(10)</td>
<td>积分</td>
</tr>
<tr>
<td>separate_type</td>
<td>tinyint(1)</td>
<td>特殊说明</td>
</tr>
</tbody>
</table>
<h2 id="办事处信息ecs-agency"><a href="#办事处信息ecs-agency" class="headerlink" title="办事处信息ecs_agency"></a>办事处信息<code>ecs_agency</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>agency_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>agency_name</td>
<td>varchar(255)</td>
<td>名称</td>
</tr>
<tr>
<td>agency_desc</td>
<td>text</td>
<td>描述</td>
</tr>
</tbody>
</table>
<h2 id="记录配送区域关联ID表ecs-area-region"><a href="#记录配送区域关联ID表ecs-area-region" class="headerlink" title="记录配送区域关联ID表ecs_area_region"></a>记录配送区域关联ID表<code>ecs_area_region</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shipping_area_id</td>
<td>smallint(5)</td>
<td>配送区域的id 号,等同shipping_area的shipping_area_id的值</td>
</tr>
<tr>
<td>region_id</td>
<td>smallint(5)</td>
<td>地区列表,等同于ecs_region的region_id</td>
</tr>
</tbody>
</table>
<h2 id="文章ecs-article"><a href="#文章ecs-article" class="headerlink" title="文章ecs_article"></a>文章<code>ecs_article</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>article_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>cat_id</td>
<td>smallint(5)</td>
<td>该文章的分类,同article_cat的cat_id,如果不在,将自动成为保留类型而不能删除</td>
</tr>
<tr>
<td>title</td>
<td>varchar(150)</td>
<td>标题</td>
</tr>
<tr>
<td>content</td>
<td>longtext</td>
<td>内容</td>
</tr>
<tr>
<td>author</td>
<td>varchar(30)</td>
<td>作者</td>
</tr>
<tr>
<td>author_email</td>
<td>varchar(60)</td>
<td>作者邮箱</td>
</tr>
<tr>
<td>keywords</td>
<td>varchar(255)</td>
<td>关键字</td>
</tr>
<tr>
<td>article_type</td>
<td>tinyint(1)</td>
<td>文章类型</td>
</tr>
<tr>
<td>is_open</td>
<td>tinyint(1)</td>
<td>是否显示，1:显示，0:不显示</td>
</tr>
<tr>
<td>add_time</td>
<td>int(10)</td>
<td>添加时间</td>
</tr>
<tr>
<td>file_url</td>
<td>varchar(255)</td>
<td>上传文件或外部文件的URL</td>
</tr>
<tr>
<td>open_type</td>
<td>tinyint(1)</td>
<td>0,正常; 当该字段为1或2时,会在文章最后添加一个链接’相关下载’,连接地址等于file_url的值</td>
</tr>
<tr>
<td>link</td>
<td>varchar(255)</td>
<td>该文章标题所引用的连接,如果该项有值将不能显示文章内容,即该表中content的值</td>
</tr>
<tr>
<td>description</td>
<td>varchar(255)</td>
<td>描述</td>
</tr>
</tbody>
</table>
<h2 id="文章分类信息表ecs-article-cat"><a href="#文章分类信息表ecs-article-cat" class="headerlink" title="文章分类信息表ecs_article_cat"></a>文章分类信息表<code>ecs_article_cat</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cat_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>cat_name</td>
<td>varchar(255)</td>
<td>分类名称</td>
</tr>
<tr>
<td>cat_type</td>
<td>tinyint(1)</td>
<td>分类类型 1,普通分类2,系统分类 3,网店信息 4, 帮助分类 5,网店帮助</td>
</tr>
<tr>
<td>keywords</td>
<td>varchar(255)</td>
<td>关键字</td>
</tr>
<tr>
<td>cat_desc</td>
<td>varchar(255)</td>
<td>说明文字</td>
</tr>
<tr>
<td>sort_order</td>
<td>tinyint(3)</td>
<td>排序</td>
</tr>
<tr>
<td>show_in_nav</td>
<td>tinyint(1)</td>
<td>是否显示在导航栏，0: 否，1: 是</td>
</tr>
<tr>
<td>parent_id</td>
<td>smallint(5)</td>
<td>父节点ID，取该表cat_id字段</td>
</tr>
</tbody>
</table>
<h2 id="商品类型属性ecs-attribute"><a href="#商品类型属性ecs-attribute" class="headerlink" title="商品类型属性ecs_attribute"></a>商品类型属性<code>ecs_attribute</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>attr_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>cat_id</td>
<td>smallint(5)</td>
<td>商品类型 , 同goods_type的 cat_id</td>
</tr>
<tr>
<td>attr_name</td>
<td>varchar(60)</td>
<td>属性名称</td>
</tr>
<tr>
<td>attr_input_type</td>
<td>tinyint(1)</td>
<td>当添加商品时,该属性的添加类别; 0为手功输入;1为选择输入;2为多行文本输入</td>
</tr>
<tr>
<td>attr_type</td>
<td>tinyint(1)</td>
<td>属性是否多选; 0否; 1是 如果可以多选,则可以自定义属性,并且可以根据值的不同定不同的价</td>
</tr>
<tr>
<td>attr_values</td>
<td>text</td>
<td>即选择输入,则attr_name对应的值的取值就是该这字段值</td>
</tr>
<tr>
<td>attr_index</td>
<td>tinyint(1)</td>
<td>属性是否可以检索;0不需要检索; 1关键字检索2范围检索,该属性应该是如果检索的话,可以通过该属性找到有该属性的商品</td>
</tr>
<tr>
<td>sort_order</td>
<td>tinyint(3)</td>
<td>属性显示的顺序,数字越大越靠前,如果数字一样则按id顺序</td>
</tr>
<tr>
<td>is_linked</td>
<td>tinyint(1)</td>
<td>是否关联,0 不关联 1关联; 如果关联, 那么用户在购买该商品时,具有有该属性相同的商品将被推荐给用户</td>
</tr>
<tr>
<td>attr_group</td>
<td>tinyint(1)</td>
<td>属性分组,相同的为一个属性组应该取自goods_type的attr_group的值的顺序.</td>
</tr>
</tbody>
</table>
<h2 id="拍卖出价记录表ecs-auction-log"><a href="#拍卖出价记录表ecs-auction-log" class="headerlink" title="拍卖出价记录表ecs_auction_log"></a>拍卖出价记录表<code>ecs_auction_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>mediumint(8)</td>
<td>日志ID</td>
</tr>
<tr>
<td>act_id</td>
<td>mediumint(8)</td>
<td>拍卖活动的id,取值于goods_activity的act_id字段</td>
</tr>
<tr>
<td>bid_user</td>
<td>mediumint(8)</td>
<td>出价的用户id,取值于users的user_id</td>
</tr>
<tr>
<td>bid_price</td>
<td>decimal(10,2)</td>
<td>出价价格</td>
</tr>
<tr>
<td>bid_time</td>
<td>int(10)</td>
<td>出价时间</td>
</tr>
</tbody>
</table>
<h2 id="计划任务表-ecs-auto-manage"><a href="#计划任务表-ecs-auto-manage" class="headerlink" title="计划任务表 ecs_auto_manage"></a>计划任务表 <code>ecs_auto_manage</code></h2><blockquote>
<p>处理文章，商品自动上下线的计划任务列表（需要安装计划任务插件）</p>
</blockquote>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>item_id</td>
<td>mediumint(8)</td>
<td>如果是商品就是goods的goods_id,如果是文章就是article的article_id</td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
<td>Goods是商品,article是文章</td>
</tr>
<tr>
<td>starttime</td>
<td>int(10)</td>
<td>上线时间</td>
</tr>
<tr>
<td>endtime</td>
<td>int(10)</td>
<td>下线时间</td>
</tr>
</tbody>
</table>
<h2 id="退货商品信息ecs-back-goods"><a href="#退货商品信息ecs-back-goods" class="headerlink" title="退货商品信息ecs_back_goods"></a>退货商品信息<code>ecs_back_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rec_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>back_id</td>
<td>mediumint(8)</td>
<td>退货单ID</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品ID</td>
</tr>
<tr>
<td>product_id</td>
<td>mediumint(8)</td>
<td>货品ID</td>
</tr>
<tr>
<td>product_sn</td>
<td>varchar(60)</td>
<td>货品编号</td>
</tr>
<tr>
<td>goods_name</td>
<td>varchar(120)</td>
<td>商品名称</td>
</tr>
<tr>
<td>brand_name</td>
<td>varchar(60)</td>
<td>品牌名称</td>
</tr>
<tr>
<td>goods_sn</td>
<td>varchar(60)</td>
<td>商品编号</td>
</tr>
<tr>
<td>is_real</td>
<td>tinyint(1)</td>
<td>是否是实体商铺</td>
</tr>
<tr>
<td>send_number</td>
<td>smallint(5)</td>
<td>发货数量</td>
</tr>
<tr>
<td>goods_attr</td>
<td>text</td>
<td>商品属性</td>
</tr>
</tbody>
</table>
<h2 id="退货单信息ecs-back-order"><a href="#退货单信息ecs-back-order" class="headerlink" title="退货单信息ecs_back_order"></a>退货单信息<code>ecs_back_order</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>back_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>delivery_sn</td>
<td>varchar(20)</td>
<td>发货单号</td>
</tr>
<tr>
<td>order_sn</td>
<td>varchar(20)</td>
<td>订单号</td>
</tr>
<tr>
<td>order_id</td>
<td>mediumint(8)</td>
<td>订单ID</td>
</tr>
<tr>
<td>invoice_no</td>
<td>varchar(50)</td>
<td>物流单号</td>
</tr>
<tr>
<td>add_time</td>
<td>int(10)</td>
<td>添加时间</td>
</tr>
<tr>
<td>shipping_id</td>
<td>tinyint(3)</td>
<td>订单编号</td>
</tr>
<tr>
<td>shipping_name</td>
<td>varchar(120)</td>
<td>订单名称</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户ID</td>
</tr>
<tr>
<td>action_user</td>
<td>varchar(30)</td>
<td>当前操作员</td>
</tr>
<tr>
<td>consignee</td>
<td>varchar(60)</td>
<td>收货人姓名</td>
</tr>
<tr>
<td>address</td>
<td>varchar(250)</td>
<td>收货人地址</td>
</tr>
<tr>
<td>country</td>
<td>smallint(5)</td>
<td>国家</td>
</tr>
<tr>
<td>province</td>
<td>smallint(5)</td>
<td>省份</td>
</tr>
<tr>
<td>city</td>
<td>smallint(5)</td>
<td>城市</td>
</tr>
<tr>
<td>district</td>
<td>smallint(5)</td>
<td>收货人区/县</td>
</tr>
<tr>
<td>sign_building</td>
<td>varchar(120)</td>
<td>标志建筑</td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>邮箱地址</td>
</tr>
<tr>
<td>zipcode</td>
<td>varchar(60)</td>
<td>邮编</td>
</tr>
<tr>
<td>tel</td>
<td>varchar(60)</td>
<td>电话</td>
</tr>
<tr>
<td>mobile</td>
<td>varchar(60)</td>
<td>备用电话</td>
</tr>
<tr>
<td>best_time</td>
<td>varchar(120)</td>
<td>最佳送货时间</td>
</tr>
<tr>
<td>postscript</td>
<td>varchar(255)</td>
<td>备注－订单</td>
</tr>
<tr>
<td>how_oos</td>
<td>varchar(120)</td>
<td>缺货处理</td>
</tr>
<tr>
<td>insure_fee</td>
<td>decimal(10,2)</td>
<td>计算报价费</td>
</tr>
<tr>
<td>shipping_fee</td>
<td>decimal(10,2)</td>
<td>配送费用</td>
</tr>
<tr>
<td>update_time</td>
<td>int(10)</td>
<td>更新时间</td>
</tr>
<tr>
<td>suppliers_id</td>
<td>smallint(5)</td>
<td>供应商ID</td>
</tr>
<tr>
<td>status</td>
<td>tinyint(1)</td>
<td>状态</td>
</tr>
<tr>
<td>return_time</td>
<td>int(10)</td>
<td>退货时间</td>
</tr>
<tr>
<td>agency_id</td>
<td>smallint(5)</td>
<td>办事处ID</td>
</tr>
</tbody>
</table>
<h2 id="红包类型表ecs-bonus-type"><a href="#红包类型表ecs-bonus-type" class="headerlink" title="红包类型表ecs_bonus_type"></a>红包类型表<code>ecs_bonus_type</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>type_id</td>
<td>smallint(5)</td>
<td>红包类型流水号</td>
</tr>
<tr>
<td>type_name</td>
<td>varchar(60)</td>
<td>红包名称</td>
</tr>
<tr>
<td>type_money</td>
<td>decimal(10,2)</td>
<td>红包所值金额</td>
</tr>
<tr>
<td>send_type</td>
<td>tinyint(3)</td>
<td>红包发送类型0按用户如会员等级,会员名称发放;1按商品类别发送;2按订单金额所达到的额度发送;3线下发送</td>
</tr>
<tr>
<td>min_amount</td>
<td>decimal(10,2)</td>
<td>如果按金额发送红包,该项是最小金额,即只要购买超过该金额的商品都可以领到红包</td>
</tr>
<tr>
<td>max_amount</td>
<td>decimal(10,2)</td>
<td></td>
</tr>
<tr>
<td>send_start_date</td>
<td>int(11)</td>
<td>发送的开始时间</td>
</tr>
<tr>
<td>send_end_date</td>
<td>int(11)</td>
<td>发送的结束时间</td>
</tr>
<tr>
<td>use_start_date</td>
<td>int(11)</td>
<td>红包可以使用的开始时间</td>
</tr>
<tr>
<td>use_end_date</td>
<td>int(11)</td>
<td>红包可以使用的结束时间</td>
</tr>
<tr>
<td>min_goods_amount</td>
<td>decimal(10,2)</td>
<td>可以使用该红包的商品的最低价格,即只要达到该价格商品才可以使用红包</td>
</tr>
</tbody>
</table>
<h2 id="缺货登记的订购和处理记录表ecs-booking-goods"><a href="#缺货登记的订购和处理记录表ecs-booking-goods" class="headerlink" title="缺货登记的订购和处理记录表ecs_booking_goods"></a>缺货登记的订购和处理记录表<code>ecs_booking_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rec_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>登记该缺货记录的用户的id,取值user的user_id</td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>页面填的用户的email,默认取值于user的email</td>
</tr>
<tr>
<td>link_man</td>
<td>varchar(60)</td>
<td>页面填的用户的电话,默认取值于users的consignee</td>
</tr>
<tr>
<td>tel</td>
<td>varchar(60)</td>
<td>页面填的用户电话,默认取值于user的tel</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>缺货登记商品id,取值于goods的goods_id</td>
</tr>
<tr>
<td>goods_desc</td>
<td>varchar(255)</td>
<td>缺货登记时留的订购描述</td>
</tr>
<tr>
<td>goods_number</td>
<td>smallint(5)</td>
<td>订购数量</td>
</tr>
<tr>
<td>booking_time</td>
<td>int(10)</td>
<td>缺货登记的时间</td>
</tr>
<tr>
<td>is_dispose</td>
<td>tinyint(1)</td>
<td>是否已经被处理</td>
</tr>
<tr>
<td>dispose_user</td>
<td>varchar(30)</td>
<td>处理该缺货登记的管理员用户名,取值于session,该session取值于admin_user的user_name</td>
</tr>
<tr>
<td>dispose_time</td>
<td>int(10)</td>
<td>处理的时间</td>
</tr>
<tr>
<td>dispose_note</td>
<td>varchar(255)</td>
<td>处理时间管理员留的备注</td>
</tr>
</tbody>
</table>
<h2 id="商品品牌表ecs-brand"><a href="#商品品牌表ecs-brand" class="headerlink" title="商品品牌表ecs_brand"></a>商品品牌表<code>ecs_brand</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>brand_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>brand_name</td>
<td>varchar(60)</td>
<td>品牌名称</td>
</tr>
<tr>
<td>brand_logo</td>
<td>varchar(80)</td>
<td>品牌logo</td>
</tr>
<tr>
<td>brand_desc</td>
<td>text</td>
<td>描述</td>
</tr>
<tr>
<td>site_url</td>
<td>varchar(255)</td>
<td>品牌网址</td>
</tr>
<tr>
<td>sort_order</td>
<td>tinyint(3)</td>
<td>排序</td>
</tr>
<tr>
<td>is_show</td>
<td>tinyint(1)</td>
<td>是否显示，0: 否，1: 显示</td>
</tr>
<tr>
<td>brand_banner</td>
<td>varchar(80)</td>
<td>品牌Banner</td>
</tr>
</tbody>
</table>
<h2 id="卡片配置信息ecs-card"><a href="#卡片配置信息ecs-card" class="headerlink" title="卡片配置信息ecs_card"></a>卡片配置信息<code>ecs_card</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>card_id</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>card_name</td>
<td>varchar(120)</td>
<td>卡片名称</td>
</tr>
<tr>
<td>card_img</td>
<td>varchar(255)</td>
<td>卡片图片</td>
</tr>
<tr>
<td>card_fee</td>
<td>decimal(6,2)</td>
<td>所需费用</td>
</tr>
<tr>
<td>free_money</td>
<td>decimal(6,2)</td>
<td>订单达到该字段的值后使用此贺卡免费</td>
</tr>
<tr>
<td>card_desc</td>
<td>varchar(255)</td>
<td>描述</td>
</tr>
</tbody>
</table>
<h2 id="购物车购物信息记录表ecs-cart"><a href="#购物车购物信息记录表ecs-cart" class="headerlink" title="购物车购物信息记录表ecs_cart"></a>购物车购物信息记录表<code>ecs_cart</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rec_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户登录ID，取自session</td>
</tr>
<tr>
<td>session_id</td>
<td>char(32)</td>
<td>如果该用户退出,该Session_id对应的购物车中所有记录都将被删除</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品的ID,取自表goods的goods_id</td>
</tr>
<tr>
<td>goods_sn</td>
<td>varchar(60)</td>
<td>商品的货号,取自表goods的goods_sn</td>
</tr>
<tr>
<td>product_id</td>
<td>mediumint(8)</td>
<td>产品ID</td>
</tr>
<tr>
<td>goods_name</td>
<td>varchar(120)</td>
<td>商品名称,取自表goods的goods_name</td>
</tr>
<tr>
<td>market_price</td>
<td>decimal(10,2)</td>
<td>商品的本店价,取自表市场价</td>
</tr>
<tr>
<td>goods_price</td>
<td>decimal(10,2)</td>
<td>商品的本店价,取自表goods的shop_price</td>
</tr>
<tr>
<td>goods_number</td>
<td>smallint(5)</td>
<td>商品的购买数量,在购物车时,实际库存不减少</td>
</tr>
<tr>
<td>goods_attr</td>
<td>text</td>
<td>商品的扩展属性, 取自goods的extension_code</td>
</tr>
<tr>
<td>is_real</td>
<td>tinyint(1)</td>
<td>取自ecs_goods的is_real</td>
</tr>
<tr>
<td>extension_code</td>
<td>varchar(30)</td>
<td>商品的扩展属性,取自goods的extension_code</td>
</tr>
<tr>
<td>parent_id</td>
<td>mediumint(8)</td>
<td>该商品的父商品ID,没有该值为0,有的话那该商品就是该id的配件</td>
</tr>
<tr>
<td>rec_type</td>
<td>tinyint(1)</td>
<td>购物车商品类型;0普通;1团够;2拍卖;3夺宝奇兵</td>
</tr>
<tr>
<td>is_gift</td>
<td>smallint(5)</td>
<td>是否赠品,0否;其他, 是参加优惠活动的id,取值于favourable_activity的act_id</td>
</tr>
<tr>
<td>is_shipping</td>
<td>tinyint(1)</td>
<td></td>
</tr>
<tr>
<td>can_handsel</td>
<td>tinyint(3)</td>
<td>能否处理</td>
</tr>
<tr>
<td>goods_attr_id</td>
<td>varchar(255)</td>
<td>该商品的属性的id,取自goods_attr的goods_attr_id,如果有多个,只记录了最后一个</td>
</tr>
</tbody>
</table>
<h2 id="商品分类表，记录商品分类信息ecs-category"><a href="#商品分类表，记录商品分类信息ecs-category" class="headerlink" title="商品分类表，记录商品分类信息ecs_category"></a>商品分类表，记录商品分类信息<code>ecs_category</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cat_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>cat_name</td>
<td>varchar(90)</td>
<td>分类名称</td>
</tr>
<tr>
<td>keywords</td>
<td>varchar(255)</td>
<td>关键字</td>
</tr>
<tr>
<td>cat_desc</td>
<td>varchar(255)</td>
<td>描述</td>
</tr>
<tr>
<td>parent_id</td>
<td>smallint(5)</td>
<td>该分类的父类ID,取值于该表的cat_id字段</td>
</tr>
<tr>
<td>sort_order</td>
<td>tinyint(1)</td>
<td>该分类在页面显示的顺序,数字越大顺序越靠后,同数字,id在前的先显示</td>
</tr>
<tr>
<td>template_file</td>
<td>varchar(50)</td>
<td>不确定字段,按名和表设计猜,应该是该分类的单独模板文件的名字</td>
</tr>
<tr>
<td>measure_unit</td>
<td>varchar(15)</td>
<td>该分类的计量单位</td>
</tr>
<tr>
<td>show_in_nav</td>
<td>tinyint(1)</td>
<td>是否显示在导航栏,0不;1显示</td>
</tr>
<tr>
<td>style</td>
<td>varchar(150)</td>
<td>该分类的单独的样式表的包括文件部分的文件路径</td>
</tr>
<tr>
<td>is_show</td>
<td>tinyint(1)</td>
<td>是否在前台页面显示 1显示; 0不显示</td>
</tr>
<tr>
<td>grade</td>
<td>tinyint(4)</td>
<td>该分类的最高和最低价之间的价格分级,当大于1时,会根据最大最小价格区间分成区间,会在页面显示价格范围,如0-300,300-600,600-900这种;</td>
</tr>
<tr>
<td>filter_attr</td>
<td>varchar(255)</td>
<td>如果该字段有值,则该分类将还会按照该值对应在表goods_attr的goods_attr_id所对应的属性筛选，如，封面颜色下有红，黑分类筛选</td>
</tr>
</tbody>
</table>
<h2 id="首页推荐扩展分类表ecs-cat-recommend"><a href="#首页推荐扩展分类表ecs-cat-recommend" class="headerlink" title="首页推荐扩展分类表ecs_cat_recommend"></a>首页推荐扩展分类表<code>ecs_cat_recommend</code></h2><blockquote>
<p>放在首页推荐,比如新品上市，精品推荐，热卖商品</p>
</blockquote>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cat_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>recommend_type</td>
<td>tinyint(1)</td>
<td>推荐类型</td>
</tr>
</tbody>
</table>
<h2 id="收藏纪录表ecs-collect-goods"><a href="#收藏纪录表ecs-collect-goods" class="headerlink" title="收藏纪录表ecs_collect_goods"></a>收藏纪录表<code>ecs_collect_goods</code></h2><blockquote>
<p>会员收藏商品的记录列表，一条记录一个收藏商品</p>
</blockquote>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rec_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>该条收藏记录的会员id，取值于users的user_id</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>收藏的商品id，取值于goods的goods_id</td>
</tr>
<tr>
<td>add_time</td>
<td>int(11)</td>
<td>收藏时间</td>
</tr>
<tr>
<td>is_attention</td>
<td>tinyint(1)</td>
<td>是否关注该收藏商品;1是;0否</td>
</tr>
</tbody>
</table>
<h2 id="评论表ecs-comment"><a href="#评论表ecs-comment" class="headerlink" title="评论表ecs_comment"></a>评论表<code>ecs_comment</code></h2><blockquote>
<p>用户对文章和产品的评论列表</p>
</blockquote>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>comment_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>comment_type</td>
<td>tinyint(3)</td>
<td>用户评论的类型;0评论的是商品,1评论的是文章</td>
</tr>
<tr>
<td>id_value</td>
<td>mediumint(8)</td>
<td>文章或者商品的id,文章对应的是article的article_id;商品对应的是goods的goods_id</td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>评论是提交的Email地址,默认取的user的email</td>
</tr>
<tr>
<td>user_name</td>
<td>varchar(60)</td>
<td>评论该文章或商品的人的名称,取值users的user_name</td>
</tr>
<tr>
<td>content</td>
<td>text</td>
<td>评论的内容</td>
</tr>
<tr>
<td>comment_rank</td>
<td>tinyint(1)</td>
<td>该文章或者商品的重星级;只有1到5星;由数字代替;其中5代表5星</td>
</tr>
<tr>
<td>add_time</td>
<td>int(10)</td>
<td>评论的时间</td>
</tr>
<tr>
<td>ip_address</td>
<td>varchar(15)</td>
<td>评论时的用户IP</td>
</tr>
<tr>
<td>status</td>
<td>tinyint(3)</td>
<td>是否被管理员批准显示;1是;0未批准显示</td>
</tr>
<tr>
<td>parent_id</td>
<td>int(10)</td>
<td>评论的父节点,取值该表的comment_id字段,如果该字段为0,则是一个普通评论,否则该条评论就是该字段的值所对应的评论的回复</td>
</tr>
<tr>
<td>user_id</td>
<td>int(10)</td>
<td>发表该评论的用户的用户id,取值user的user_id</td>
</tr>
</tbody>
</table>
<h2 id="计划任务ecs-crons"><a href="#计划任务ecs-crons" class="headerlink" title="计划任务ecs_crons"></a>计划任务<code>ecs_crons</code></h2><blockquote>
<p>计划任务插件安装配置信息</p>
</blockquote>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron_id</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>cron_code</td>
<td>varchar(20)</td>
<td>该插件文件在相应路径下的不包括’’.php’’部分的文件名，运行该插件将通过该字段的值寻找将运行的文件</td>
</tr>
<tr>
<td>cron_name</td>
<td>varchar(120)</td>
<td>计划任务的名称</td>
</tr>
<tr>
<td>cron_desc</td>
<td>text</td>
<td>计划人物的描述</td>
</tr>
<tr>
<td>cron_order</td>
<td>tinyint(3)</td>
<td>应该是用了设置计划任务执行的顺序的，即当同时触发2个任务时先执行哪一个，如果一样应该是id在前的先执行暂不确定</td>
</tr>
<tr>
<td>cron_config</td>
<td>text</td>
<td>对每次处理的数据的数量的值，类型，名称序列化；比如删几天的日志，每次执行几个商品或文章的处理</td>
</tr>
<tr>
<td>thistime</td>
<td>int(10)</td>
<td>该计划任务上次被执行的时间</td>
</tr>
<tr>
<td>nextime</td>
<td>int(10)</td>
<td>该计划任务下次被执行的时间</td>
</tr>
<tr>
<td>day</td>
<td>tinyint(2)</td>
<td>如果该字段有值，则计划任务将在每月的这一天执行该计划人物</td>
</tr>
<tr>
<td>week</td>
<td>varchar(1)</td>
<td>如果该字段有值，则计划任务将在每周的这一天执行该计划人物</td>
</tr>
<tr>
<td>hour</td>
<td>varchar(2)</td>
<td>如果该字段有值，则该计划任务将在每天的这个小时段执行该计划任务</td>
</tr>
<tr>
<td>minute</td>
<td>varchar(255)</td>
<td>如果该字段有值，则该计划任务将在每小时的这个分钟段执行该计划任务，该字段的值可以多个，用空格间隔</td>
</tr>
<tr>
<td>enable</td>
<td>tinyint(1)</td>
<td>该计划任务是否开启；0，关闭；1，开启</td>
</tr>
<tr>
<td>run_once</td>
<td>tinyint(1)</td>
<td>执行后是否关闭，这个关闭的意思还得再研究下</td>
</tr>
<tr>
<td>allow_ip</td>
<td>varchar(100)</td>
<td>允许运行该计划人物的服务器ip</td>
</tr>
<tr>
<td>alow_files</td>
<td>varchar(255)</td>
<td>运行触发该计划人物的文件列表可多个值，为空代表所有许可的</td>
</tr>
</tbody>
</table>
<h2 id="发货单商品信息表ecs-delivery-goods"><a href="#发货单商品信息表ecs-delivery-goods" class="headerlink" title="发货单商品信息表ecs_delivery_goods"></a>发货单商品信息表<code>ecs_delivery_goods</code></h2><blockquote>
<p>订单系统使用</p>
</blockquote>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rec_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>delivery_id</td>
<td>mediumint(8)</td>
<td>发货单ID</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品ID</td>
</tr>
<tr>
<td>product_id</td>
<td>mediumint(8)</td>
<td>货品ID</td>
</tr>
<tr>
<td>product_sn</td>
<td>varchar(60)</td>
<td>货品号</td>
</tr>
<tr>
<td>goods_name</td>
<td>varchar(120)</td>
<td>商品名称</td>
</tr>
<tr>
<td>brand_name</td>
<td>varchar(60)</td>
<td>品牌名称</td>
</tr>
<tr>
<td>goods_sn</td>
<td>varchar(60)</td>
<td>商品号</td>
</tr>
<tr>
<td>is_real</td>
<td>tinyint(1)</td>
<td>是否是实物</td>
</tr>
<tr>
<td>extension_code</td>
<td>varchar(30)</td>
<td>虚拟商品扩展代码，实体商品为空</td>
</tr>
<tr>
<td>parent_id</td>
<td>mediumint(8)</td>
<td>父ID</td>
</tr>
<tr>
<td>send_number</td>
<td>smallint(5)</td>
<td>发货数量</td>
</tr>
<tr>
<td>goods_attr</td>
<td>text</td>
<td>商品属性</td>
</tr>
</tbody>
</table>
<h2 id="发货单信息表ecs-delivery-order"><a href="#发货单信息表ecs-delivery-order" class="headerlink" title="发货单信息表ecs_delivery_order"></a>发货单信息表<code>ecs_delivery_order</code></h2><blockquote>
<p>status字段表示发货单状态,2-未发货，1-取消，0-已经发货</p>
</blockquote>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>delivery_id</td>
<td>mediumint(8)</td>
<td>发货单ID</td>
</tr>
<tr>
<td>delivery_sn</td>
<td>varchar(20)</td>
<td>发货单号</td>
</tr>
<tr>
<td>order_sn</td>
<td>varchar(20)</td>
<td>订单号</td>
</tr>
<tr>
<td>order_id</td>
<td>mediumint(8)</td>
<td>订单ID</td>
</tr>
<tr>
<td>invoice_no</td>
<td>varchar(50)</td>
<td>物流单号</td>
</tr>
<tr>
<td>add_time</td>
<td>int(10)</td>
<td>添加时间</td>
</tr>
<tr>
<td>shipping_id</td>
<td>tinyint(3)</td>
<td>供应商ID</td>
</tr>
<tr>
<td>shipping_name</td>
<td>varchar(120)</td>
<td>供应商名称</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户ID</td>
</tr>
<tr>
<td>action_user</td>
<td>varchar(30)</td>
<td>当前操作员</td>
</tr>
<tr>
<td>consignee</td>
<td>varchar(60)</td>
<td>收货人姓名</td>
</tr>
<tr>
<td>address</td>
<td>varchar(250)</td>
<td>收货人地址</td>
</tr>
<tr>
<td>country</td>
<td>smallint(5)</td>
<td>国家</td>
</tr>
<tr>
<td>province</td>
<td>smallint(5)</td>
<td>省份</td>
</tr>
<tr>
<td>city</td>
<td>smallint(5)</td>
<td>城市</td>
</tr>
<tr>
<td>district</td>
<td>smallint(5)</td>
<td>收货人区/县</td>
</tr>
<tr>
<td>sign_building</td>
<td>varchar(120)</td>
<td>标志建筑</td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>邮箱地址</td>
</tr>
<tr>
<td>zipcode</td>
<td>varchar(60)</td>
<td>邮编</td>
</tr>
<tr>
<td>tel</td>
<td>varchar(60)</td>
<td>电话</td>
</tr>
<tr>
<td>mobile</td>
<td>varchar(60)</td>
<td>备用电话</td>
</tr>
<tr>
<td>best_time</td>
<td>varchar(120)</td>
<td>最佳送货时间</td>
</tr>
<tr>
<td>postscript</td>
<td>varchar(255)</td>
<td>备注－订单</td>
</tr>
<tr>
<td>how_oos</td>
<td>varchar(120)</td>
<td>缺货处理</td>
</tr>
<tr>
<td>insure_fee</td>
<td>decimal(10,2)</td>
<td>计算报价费</td>
</tr>
<tr>
<td>shipping_fee</td>
<td>decimal(10,2)</td>
<td>配送费用</td>
</tr>
<tr>
<td>update_time</td>
<td>int(10)</td>
<td>更新时间</td>
</tr>
<tr>
<td>suppliers_id</td>
<td>smallint(5)</td>
<td>供应商ID</td>
</tr>
<tr>
<td>status</td>
<td>tinyint(1)</td>
<td>状态</td>
</tr>
<tr>
<td>return_time</td>
<td>int(10)</td>
<td>退货时间</td>
</tr>
<tr>
<td>agency_id</td>
<td>smallint(5)</td>
<td>办事处ID</td>
</tr>
</tbody>
</table>
<h2 id="分销支付纪录ecs-drp-apply"><a href="#分销支付纪录ecs-drp-apply" class="headerlink" title="分销支付纪录ecs_drp_apply"></a>分销支付纪录<code>ecs_drp_apply</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>apply</td>
<td>int(1)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>int(10)</td>
<td>用户ID</td>
</tr>
<tr>
<td>time</td>
<td>int(12)</td>
<td>时间</td>
</tr>
<tr>
<td>amount</td>
<td>decimal(10,2)</td>
<td>商品总额</td>
</tr>
</tbody>
</table>
<h2 id="微分销银行卡信息ecs-drp-bank"><a href="#微分销银行卡信息ecs-drp-bank" class="headerlink" title="微分销银行卡信息ecs_drp_bank"></a>微分销银行卡信息<code>ecs_drp_bank</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>bank_region</td>
<td>varchar(255)</td>
<td>开户所在地</td>
</tr>
<tr>
<td>bank_name</td>
<td>varchar(50)</td>
<td>银行名称</td>
</tr>
<tr>
<td>bank_user_name</td>
<td>varchar(50)</td>
<td>开户名称</td>
</tr>
<tr>
<td>bank_card</td>
<td>varchar(50)</td>
<td>开户卡号</td>
</tr>
<tr>
<td>user_id</td>
<td>int(10)</td>
<td>用户ID</td>
</tr>
</tbody>
</table>
<h2 id="微分销配置ecs-drp-config"><a href="#微分销配置ecs-drp-config" class="headerlink" title="微分销配置ecs_drp_config"></a>微分销配置<code>ecs_drp_config</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>centent</td>
<td>text</td>
<td>多选时的选项</td>
</tr>
<tr>
<td>keyword</td>
<td>varchar(20)</td>
<td>区分文章的key</td>
</tr>
<tr>
<td>name</td>
<td>varchar(50)</td>
<td>显示字段名</td>
</tr>
<tr>
<td>remarks</td>
<td>text</td>
<td>备注</td>
</tr>
<tr>
<td>type</td>
<td>varchar(20)</td>
<td>数据类型</td>
</tr>
<tr>
<td>value</td>
<td>text</td>
<td>默认值</td>
</tr>
</tbody>
</table>
<h2 id="分销商品ecs-drp-goods"><a href="#分销商品ecs-drp-goods" class="headerlink" title="分销商品ecs_drp_goods"></a>分销商品<code>ecs_drp_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>int(10)</td>
<td>商品ID</td>
</tr>
<tr>
<td>touch_sale</td>
<td>decimal(10,2)</td>
<td>销售佣金</td>
</tr>
<tr>
<td>touch_fencheng</td>
<td>decimal(10,2)</td>
<td>分成佣金</td>
</tr>
</tbody>
</table>
<h2 id="佣金提现记录ecs-drp-log"><a href="#佣金提现记录ecs-drp-log" class="headerlink" title="佣金提现记录ecs_drp_log"></a>佣金提现记录<code>ecs_drp_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>会员ID</td>
</tr>
<tr>
<td>user_money</td>
<td>decimal(10,2)</td>
<td>提现金额</td>
</tr>
<tr>
<td>pay_points</td>
<td>mediumint(9)</td>
<td>消费积分变动</td>
</tr>
<tr>
<td>change_time</td>
<td>int(10)</td>
<td>变动时间</td>
</tr>
<tr>
<td>change_desc</td>
<td>varchar(255)</td>
<td>变动说明</td>
</tr>
<tr>
<td>change_type</td>
<td>tinyint(3)</td>
<td>变动类型(0为佣金分成，1为佣金提现)</td>
</tr>
<tr>
<td>bank_info</td>
<td>text</td>
<td>提现银行卡信息</td>
</tr>
<tr>
<td>order_id</td>
<td>int(10)</td>
<td>订单ID</td>
</tr>
<tr>
<td>status</td>
<td>int(1)</td>
<td>佣金状态,1为已支付,0为未支付</td>
</tr>
</tbody>
</table>
<h2 id="分销订单的商品ecs-drp-order-goods"><a href="#分销订单的商品ecs-drp-order-goods" class="headerlink" title="分销订单的商品ecs_drp_order_goods"></a>分销订单的商品<code>ecs_drp_order_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>int(10)</td>
<td>商品ID</td>
</tr>
<tr>
<td>touch_sale</td>
<td>decimal(10,2)</td>
<td>销售佣金</td>
</tr>
<tr>
<td>touch_fencheng</td>
<td>decimal(10,2)</td>
<td>分成佣金</td>
</tr>
<tr>
<td>order_id</td>
<td>int(10)</td>
<td>订单ID</td>
</tr>
</tbody>
</table>
<h2 id="分销商订单表ecs-drp-order-info"><a href="#分销商订单表ecs-drp-order-info" class="headerlink" title="分销商订单表ecs_drp_order_info"></a>分销商订单表<code>ecs_drp_order_info</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>drp_id</td>
<td>int(10)</td>
<td>分销商ID</td>
</tr>
<tr>
<td>shop_separate</td>
<td>int(1)</td>
<td></td>
</tr>
<tr>
<td>order_id</td>
<td>int(10)</td>
<td>订单ID</td>
</tr>
</tbody>
</table>
<h2 id="销售佣金设置表ecs-drp-profit"><a href="#销售佣金设置表ecs-drp-profit" class="headerlink" title="销售佣金设置表ecs_drp_profit"></a>销售佣金设置表<code>ecs_drp_profit</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>profit_id</td>
<td>int(10)</td>
<td>分类利润id</td>
</tr>
<tr>
<td>cate_id</td>
<td>int(10)</td>
<td>商品分类</td>
</tr>
<tr>
<td>profit1</td>
<td>float(20,2)</td>
<td>本店销售佣金</td>
</tr>
<tr>
<td>profit2</td>
<td>float(20,2)</td>
<td>一级分店佣金</td>
</tr>
<tr>
<td>profit3</td>
<td>float(20,2)</td>
<td>二级分店佣金</td>
</tr>
</tbody>
</table>
<h2 id="分销商列表ecs-drp-shop"><a href="#分销商列表ecs-drp-shop" class="headerlink" title="分销商列表ecs_drp_shop"></a>分销商列表<code>ecs_drp_shop</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td>店铺id</td>
</tr>
<tr>
<td>shop_name</td>
<td>varchar(20)</td>
<td>微店名称</td>
</tr>
<tr>
<td>real_name</td>
<td>varchar(20)</td>
<td>真实姓名</td>
</tr>
<tr>
<td>shop_mobile</td>
<td>varchar(20)</td>
<td>手机号</td>
</tr>
<tr>
<td>shop_qq</td>
<td>varchar(20)</td>
<td>qq号</td>
</tr>
<tr>
<td>shop_img</td>
<td>text</td>
<td>店铺头像</td>
</tr>
<tr>
<td>user_id</td>
<td>int(10)</td>
<td>用户ID</td>
</tr>
<tr>
<td>cat_id</td>
<td>text</td>
<td>分销分类id</td>
</tr>
<tr>
<td>create_time</td>
<td>int(11)</td>
<td>开店时间</td>
</tr>
<tr>
<td>money</td>
<td>decimal(10,2)</td>
<td></td>
</tr>
<tr>
<td>audit</td>
<td>int(1)</td>
<td>店铺是否审核</td>
</tr>
<tr>
<td>open</td>
<td>int(1)</td>
<td>店铺是否开启</td>
</tr>
<tr>
<td>bank</td>
<td>int(10)</td>
<td>默认银行卡</td>
</tr>
</tbody>
</table>
<h2 id="访客信息表ecs-drp-visiter"><a href="#访客信息表ecs-drp-visiter" class="headerlink" title="访客信息表ecs_drp_visiter"></a>访客信息表<code>ecs_drp_visiter</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>int(10)</td>
<td>会员ID</td>
</tr>
<tr>
<td>drp_id</td>
<td>int(10)</td>
<td>分销商ID</td>
</tr>
<tr>
<td>visit_time</td>
<td>int(12)</td>
<td>访问时间</td>
</tr>
</tbody>
</table>
<h2 id="增加电子杂志订阅表ecs-email-list"><a href="#增加电子杂志订阅表ecs-email-list" class="headerlink" title="增加电子杂志订阅表ecs_email_list"></a>增加电子杂志订阅表<code>ecs_email_list</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>邮件订阅所填的邮箱地址</td>
</tr>
<tr>
<td>stat</td>
<td>tinyint(1)</td>
<td>是否确认，可以用户确认也可以管理员确认；0，未确认；1，已确认</td>
</tr>
<tr>
<td>hash</td>
<td>varchar(10)</td>
<td>邮箱确认的验证码，系统生成后发送到用户邮箱，用户验证激活时通过该值判断是否合法；主要用来防止非法验证邮箱</td>
</tr>
</tbody>
</table>
<h2 id="增加发送队列表ecs-email-sendlist"><a href="#增加发送队列表ecs-email-sendlist" class="headerlink" title="增加发送队列表ecs_email_sendlist"></a>增加发送队列表<code>ecs_email_sendlist</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>email</td>
<td>varchar(100)</td>
<td>邮箱</td>
</tr>
<tr>
<td>template_id</td>
<td>mediumint(8)</td>
<td>模版ID</td>
</tr>
<tr>
<td>email_content</td>
<td>text</td>
<td>邮件内容</td>
</tr>
<tr>
<td>error</td>
<td>tinyint(1)</td>
<td>错误消息</td>
</tr>
<tr>
<td>pri</td>
<td>tinyint(10)</td>
<td>优先级</td>
</tr>
<tr>
<td>last_send</td>
<td>int(10)</td>
<td>最后发送时间</td>
</tr>
</tbody>
</table>
<h2 id="该表用来记录页面触发计划任务时失败所产生的错误ecs-error-log"><a href="#该表用来记录页面触发计划任务时失败所产生的错误ecs-error-log" class="headerlink" title="该表用来记录页面触发计划任务时失败所产生的错误ecs_error_log"></a>该表用来记录页面触发计划任务时失败所产生的错误<code>ecs_error_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>varchar(255)</td>
<td>错误详细信息</td>
</tr>
<tr>
<td>file</td>
<td>varchar(100)</td>
<td>产生错误的执行文件的绝对路径</td>
</tr>
<tr>
<td>time</td>
<td>int(10)</td>
<td>错误发生的时间</td>
</tr>
</tbody>
</table>
<h2 id="积分商城ecs-exchange-goods"><a href="#积分商城ecs-exchange-goods" class="headerlink" title="积分商城ecs_exchange_goods"></a>积分商城<code>ecs_exchange_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>exchange_integral</td>
<td>int(10)</td>
<td>交换积分</td>
</tr>
<tr>
<td>is_exchange</td>
<td>tinyint(1)</td>
<td></td>
</tr>
<tr>
<td>is_hot</td>
<td>tinyint(1)</td>
</tr>
</tbody>
</table>
<h2 id="优惠活动的配置信息（送礼、减免、打折）ecs-favourable-activity"><a href="#优惠活动的配置信息（送礼、减免、打折）ecs-favourable-activity" class="headerlink" title="优惠活动的配置信息（送礼、减免、打折）ecs_favourable_activity"></a>优惠活动的配置信息（送礼、减免、打折）<code>ecs_favourable_activity</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>act_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>act_name</td>
<td>varchar(255)</td>
<td>优惠活动的活动名称</td>
</tr>
<tr>
<td>start_time</td>
<td>int(10)</td>
<td>活动的开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int(10)</td>
<td>活动的结束时间</td>
</tr>
<tr>
<td>user_rank</td>
<td>varchar(255)</td>
<td>可以参加活动的用户信息，取值于user_rank的rank_id；其中0是非会员，其他是相应的会员等级；多个值用逗号分隔’,</td>
</tr>
<tr>
<td>act_range</td>
<td>tinyint(3)</td>
<td>优惠范围；0，全部商品；1，按分类；2，按品牌；3，按商品</td>
</tr>
<tr>
<td>act_range_ext</td>
<td>varchar(255)</td>
<td></td>
</tr>
<tr>
<td>min_amount</td>
<td>decimal(10,2)</td>
<td>根据优惠活动范围的不同，该处意义不同；但是都是优惠范围的约束；如，如果是商品，该处是商品的id，如果是品牌，该处是品牌的id</td>
</tr>
<tr>
<td>max_amount</td>
<td>decimal(10,2)</td>
<td>订单达到金额下限，才参加活动</td>
</tr>
<tr>
<td>act_type</td>
<td>tinyint(3)</td>
<td>参加活动的订单金额下限，0，表示没有上限</td>
</tr>
<tr>
<td>act_type_ext</td>
<td>decimal(10,2)</td>
<td>参加活动的优惠方式；0，送赠品或优惠购买；1，现金减免；价格打折优惠</td>
</tr>
<tr>
<td>gift</td>
<td>text</td>
<td>如果是送赠品，该处是允许的最大数量，0，无数量限制；现今减免，则是减免金额，单位元；打折，是折扣值，100算，8折就是80</td>
</tr>
<tr>
<td>sort_order</td>
<td>tinyint(3)</td>
<td>如果有特惠商品，这里是序列化后的特惠商品的id,name,price信息;取值于goods的goods_id，goods_name，价格是添加活动时填写的</td>
</tr>
<tr>
<td>touch_img</td>
<td>varchar(50)</td>
<td>logo名称</td>
</tr>
</tbody>
</table>
<h2 id="用户反馈信息表ecs-feedback"><a href="#用户反馈信息表ecs-feedback" class="headerlink" title="用户反馈信息表ecs_feedback"></a>用户反馈信息表<code>ecs_feedback</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>msg_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>parent_id</td>
<td>mediumint(8)</td>
<td>父节点，取自该表msg_id；反馈该值为0；回复反馈为节点id</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户ID</td>
</tr>
<tr>
<td>user_name</td>
<td>varchar(60)</td>
<td>用户名</td>
</tr>
<tr>
<td>user_email</td>
<td>varchar(60)</td>
<td>用户邮箱</td>
</tr>
<tr>
<td>msg_title</td>
<td>varchar(200)</td>
<td>标题</td>
</tr>
<tr>
<td>msg_type</td>
<td>tinyint(1)</td>
<td>类型</td>
</tr>
<tr>
<td>msg_status</td>
<td>tinyint(1)</td>
<td>状态</td>
</tr>
<tr>
<td>msg_content</td>
<td>text</td>
<td>内容</td>
</tr>
<tr>
<td>msg_time</td>
<td>int(10)</td>
<td>时间</td>
</tr>
<tr>
<td>message_img</td>
<td>varchar(255)</td>
<td>图片</td>
</tr>
<tr>
<td>order_id</td>
<td>int(11)</td>
<td>排序</td>
</tr>
<tr>
<td>msg_area</td>
<td>tinyint(1)</td>
<td>是否显示反馈信息</td>
</tr>
</tbody>
</table>
<h2 id="友情链接配置信息表ecs-friend-link"><a href="#友情链接配置信息表ecs-friend-link" class="headerlink" title="友情链接配置信息表ecs_friend_link"></a>友情链接配置信息表<code>ecs_friend_link</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>link_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>link_name</td>
<td>varchar(255)</td>
<td>友情链接的名称，img的alt的内容</td>
</tr>
<tr>
<td>link_url</td>
<td>varchar(255)</td>
<td>友情链接网站的链接地址</td>
</tr>
<tr>
<td>link_logo</td>
<td>varchar(255)</td>
<td>友情链接的logo</td>
</tr>
<tr>
<td>show_order</td>
<td>tinyint(3)</td>
<td>排序</td>
</tr>
</tbody>
</table>
<h2 id="商品表ecs-goods"><a href="#商品表ecs-goods" class="headerlink" title="商品表ecs_goods"></a>商品表<code>ecs_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>cat_id</td>
<td>smallint(5)</td>
<td>商品所属商品分类id，取值category的cat_id</td>
</tr>
<tr>
<td>goods_sn</td>
<td>varchar(60)</td>
<td>商品的唯一货号</td>
</tr>
<tr>
<td>goods_name</td>
<td>varchar(120)</td>
<td>商品的名称</td>
</tr>
<tr>
<td>goods_name_style</td>
<td>varchar(60)</td>
<td>商品名称显示的样式；包括颜色和字体样式；格式如#ff00ff+strong</td>
</tr>
<tr>
<td>click_count</td>
<td>int(10)</td>
<td>商品点击数</td>
</tr>
<tr>
<td>brand_id</td>
<td>smallint(5)</td>
<td>品牌id，取值于brand 的brand_id</td>
</tr>
<tr>
<td>provider_name</td>
<td>varchar(100)</td>
<td>供货人的名称，程序还没实现该功能</td>
</tr>
<tr>
<td>goods_number</td>
<td>smallint(5)</td>
<td>商品库存数量</td>
</tr>
<tr>
<td>goods_weight</td>
<td>decimal(10,3)</td>
<td>商品的重量，以千克为单位</td>
</tr>
<tr>
<td>market_price</td>
<td>decimal(10,2)</td>
<td>市场售价</td>
</tr>
<tr>
<td>shop_price</td>
<td>decimal(10,2)</td>
<td>本店售价</td>
</tr>
<tr>
<td>promote_price</td>
<td>decimal(10,2)</td>
<td>促销价格</td>
</tr>
<tr>
<td>promote_start_date</td>
<td>int(11)</td>
<td>促销价格开始日期</td>
</tr>
<tr>
<td>promote_end_date</td>
<td>int(11)</td>
<td>促销价格结束日期</td>
</tr>
<tr>
<td>warn_number</td>
<td>tinyint(3)</td>
<td>商品报警数量</td>
</tr>
<tr>
<td>keywords</td>
<td>varchar(255)</td>
<td>商品关键字，放在商品页的关键字中，为搜索引擎收录用</td>
</tr>
<tr>
<td>goods_brief</td>
<td>varchar(255)</td>
<td>商品的简短描述</td>
</tr>
<tr>
<td>goods_desc</td>
<td>text</td>
<td>商品的详细描述</td>
</tr>
<tr>
<td>goods_thumb</td>
<td>varchar(255)</td>
<td>商品在前台显示的微缩图片，如在分类筛选时显示的小图片</td>
</tr>
<tr>
<td>goods_img</td>
<td>varchar(255)</td>
<td>商品的实际大小图片，如进入该商品页时介绍商品属性所显示的大图片</td>
</tr>
<tr>
<td>original_img</td>
<td>varchar(255)</td>
<td>应该是上传的商品的原始图片</td>
</tr>
<tr>
<td>is_real</td>
<td>tinyint(3)</td>
<td>是否是实物，1，是；0，否；比如虚拟卡就为0，不是实物</td>
</tr>
<tr>
<td>extension_code</td>
<td>varchar(30)</td>
<td>商品的扩展属性，比如像虚拟卡</td>
</tr>
<tr>
<td>is_on_sale</td>
<td>tinyint(1)</td>
<td>该商品是否开放销售，1，是；0，否</td>
</tr>
<tr>
<td>is_alone_sale</td>
<td>tinyint(1)</td>
<td>是否能单独销售，1，是；0，否；如果不能单独销售，则只能作为某商品的配件或者赠品销售</td>
</tr>
<tr>
<td>is_shipping</td>
<td>tinyint(1)</td>
<td>是否免运费，1，是；0，否</td>
</tr>
<tr>
<td>integral</td>
<td>int(10)</td>
<td>购买该商品可以使用的积分数量，估计应该是用积分代替金额消费；但程序好像还没有实现该功能</td>
</tr>
<tr>
<td>add_time</td>
<td>int(10)</td>
<td>商品的添加时间</td>
</tr>
<tr>
<td>sort_order</td>
<td>smallint(4)</td>
<td>应该是商品的显示顺序，不过该版程序中没实现该功能</td>
</tr>
<tr>
<td>is_delete</td>
<td>tinyint(1)</td>
<td>商品是否已经删除，0，否；1，已删除</td>
</tr>
<tr>
<td>is_best</td>
<td>tinyint(1)</td>
<td>是否是精品；0，否；1，是</td>
</tr>
<tr>
<td>is_new</td>
<td>tinyint(1)</td>
<td>是否是新品</td>
</tr>
<tr>
<td>is_hot</td>
<td>tinyint(1)</td>
<td>是否热销，0，否；1，是</td>
</tr>
<tr>
<td>is_promote</td>
<td>tinyint(1)</td>
<td>是否特价促销；0，否；1，是</td>
</tr>
<tr>
<td>bonus_type_id</td>
<td>tinyint(3)</td>
<td>购买该商品所能领到的红包类型</td>
</tr>
<tr>
<td>last_update</td>
<td>int(10)</td>
<td>最近一次更新商品配置的时间</td>
</tr>
<tr>
<td>goods_type</td>
<td>smallint(5)</td>
<td>商品所属类型id，取值表goods_type的cat_id</td>
</tr>
<tr>
<td>seller_note</td>
<td>varchar(255)</td>
<td>商品的商家备注，仅商家可见</td>
</tr>
<tr>
<td>give_integral</td>
<td>int(11)</td>
<td>购买该商品时每笔成功交易赠送的积分数量</td>
</tr>
<tr>
<td>rank_integral</td>
<td>int(11)</td>
<td>等级积分</td>
</tr>
<tr>
<td>suppliers_id</td>
<td>smallint(5)</td>
<td>供应商ID</td>
</tr>
<tr>
<td>is_check</td>
<td>tinyint(1)</td>
</tr>
</tbody>
</table>
<h2 id="拍卖活动和夺宝奇兵活动配置信息ecs-goods-activity"><a href="#拍卖活动和夺宝奇兵活动配置信息ecs-goods-activity" class="headerlink" title="拍卖活动和夺宝奇兵活动配置信息ecs_goods_activity"></a>拍卖活动和夺宝奇兵活动配置信息<code>ecs_goods_activity</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>act_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>act_name</td>
<td>varchar(255)</td>
<td>促销活动的名称</td>
</tr>
<tr>
<td>act_desc</td>
<td>text</td>
<td>促销活动的描述</td>
</tr>
<tr>
<td>act_type</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>参加活动的id，取值于goods的goods_id</td>
</tr>
<tr>
<td>product_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>goods_name</td>
<td>varchar(255)</td>
<td>商品的名称，取值于goods的goods_id</td>
</tr>
<tr>
<td>start_time</td>
<td>int(10)</td>
<td>活动开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int(10)</td>
<td>活动开始结束时间</td>
</tr>
<tr>
<td>is_finished</td>
<td>tinyint(3)</td>
<td>活动是否结束，0，结束；1，未结束</td>
</tr>
<tr>
<td>ext_info</td>
<td>text</td>
<td>扩展信息</td>
</tr>
<tr>
<td>touch_img</td>
<td>varchar(50)</td>
<td>logo名称</td>
</tr>
</tbody>
</table>
<h2 id="文章关联产品表ecs-goods-article"><a href="#文章关联产品表ecs-goods-article" class="headerlink" title="文章关联产品表ecs_goods_article"></a>文章关联产品表<code>ecs_goods_article</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品id，取自goods的goods_id</td>
</tr>
<tr>
<td>article_id</td>
<td>mediumint(8)</td>
<td>文章id，取自 article 的article_id</td>
</tr>
<tr>
<td>admin_id</td>
<td>tinyint(3)</td>
<td>猜想是管理员的id，但是程序中似乎没有提及到</td>
</tr>
</tbody>
</table>
<h2 id="具体商品属性表ecs-goods-attr"><a href="#具体商品属性表ecs-goods-attr" class="headerlink" title="具体商品属性表ecs_goods_attr"></a>具体商品属性表<code>ecs_goods_attr</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>goods_attr_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>该具体属性属于的商品，取值于goods的goods_id</td>
</tr>
<tr>
<td>attr_id</td>
<td>smallint(5)</td>
<td>该具体属性属于的属性类型的id，取自attribute 的attr_id</td>
</tr>
<tr>
<td>attr_value</td>
<td>text</td>
<td>该具体属性的值</td>
</tr>
<tr>
<td>attr_price</td>
<td>varchar(255)</td>
<td>该属性对应在商品原价格上要加的价格</td>
</tr>
</tbody>
</table>
<h2 id="商品的拓展分类ecs-goods-cat"><a href="#商品的拓展分类ecs-goods-cat" class="headerlink" title="商品的拓展分类ecs_goods_cat"></a>商品的拓展分类<code>ecs_goods_cat</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品id</td>
</tr>
<tr>
<td>cat_id</td>
<td>smallint(5)</td>
<td>商品分类id</td>
</tr>
</tbody>
</table>
<h2 id="商品相册表ecs-goods-gallery"><a href="#商品相册表ecs-goods-gallery" class="headerlink" title="商品相册表ecs_goods_gallery"></a>商品相册表<code>ecs_goods_gallery</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>img_id</td>
<td>mediumint(8)</td>
<td>商品相册ID</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>图片属性商品的id</td>
</tr>
<tr>
<td>img_url</td>
<td>varchar(255)</td>
<td>实际图片url</td>
</tr>
<tr>
<td>img_desc</td>
<td>varchar(255)</td>
<td>图片说明信息</td>
</tr>
<tr>
<td>thumb_url</td>
<td>varchar(255)</td>
<td>微缩图片url</td>
</tr>
<tr>
<td>img_original</td>
<td>varchar(255)</td>
<td>根据名字猜，应该是上传的图片文件的最原始的文件的url</td>
</tr>
</tbody>
</table>
<h2 id="商品类型ecs-goods-type"><a href="#商品类型ecs-goods-type" class="headerlink" title="商品类型ecs_goods_type"></a>商品类型<code>ecs_goods_type</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cat_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>cat_name</td>
<td>varchar(60)</td>
<td>商品类型名</td>
</tr>
<tr>
<td>enabled</td>
<td>tinyint(1)</td>
<td>类型状态1，为可用；0为不可用；不可用的类型，在添加商品的时候选择商品属性将不可选</td>
</tr>
<tr>
<td>attr_group</td>
<td>varchar(255)</td>
<td>商品属性分组，将一个商品类型的属性分成组，在显示的时候也是按组显示。该字段的值显示在属性的前一行，像标题的作用</td>
</tr>
</tbody>
</table>
<h2 id="商品配件配置表ecs-group-goods"><a href="#商品配件配置表ecs-group-goods" class="headerlink" title="商品配件配置表ecs_group_goods"></a>商品配件配置表<code>ecs_group_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>parent_id</td>
<td>mediumint(8)</td>
<td>父商品id</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>配件商品id</td>
</tr>
<tr>
<td>goods_price</td>
<td>decimal(10,2)</td>
<td>配件商品的价格</td>
</tr>
<tr>
<td>admin_id</td>
<td>tinyint(3)</td>
<td>添加该配件的管理员id</td>
</tr>
</tbody>
</table>
<h2 id="页面搜索关键字搜索记录ecs-keywords"><a href="#页面搜索关键字搜索记录ecs-keywords" class="headerlink" title="页面搜索关键字搜索记录ecs_keywords"></a>页面搜索关键字搜索记录<code>ecs_keywords</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>date</td>
<td>date</td>
<td>搜索日期</td>
</tr>
<tr>
<td>searchengine</td>
<td>varchar(20)</td>
<td>搜索引擎，默认是ecshop</td>
</tr>
<tr>
<td>keyword</td>
<td>varchar(90)</td>
<td>搜索关键字，即用户填写的搜索内容</td>
</tr>
<tr>
<td>count</td>
<td>mediumint(8)</td>
<td>搜索次数，按天累加</td>
</tr>
</tbody>
</table>
<h2 id="关联商品信息表ecs-link-goods"><a href="#关联商品信息表ecs-link-goods" class="headerlink" title="关联商品信息表ecs_link_goods"></a>关联商品信息表<code>ecs_link_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品id</td>
</tr>
<tr>
<td>link_goods_id</td>
<td>mediumint(8)</td>
<td>被关联的商品的id</td>
</tr>
<tr>
<td>is_double</td>
<td>tinyint(1)</td>
<td>是否是双向关联; 0否; 1是</td>
</tr>
<tr>
<td>admin_id</td>
<td>tinyint(3)</td>
<td>添加此关联商品信息的管理员id</td>
</tr>
</tbody>
</table>
<h2 id="各种邮件的模板配置模板ecs-mail-templates"><a href="#各种邮件的模板配置模板ecs-mail-templates" class="headerlink" title="各种邮件的模板配置模板ecs_mail_templates"></a>各种邮件的模板配置模板<code>ecs_mail_templates</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_id</td>
<td>tinyint(1)</td>
<td></td>
</tr>
<tr>
<td>template_code</td>
<td>varchar(30)</td>
<td>模板字符串名称，主要用于插件言语包时匹配语言包文件等用途</td>
</tr>
<tr>
<td>is_html</td>
<td>tinyint(1)</td>
<td>邮件是否是html格式；0，否；1，是</td>
</tr>
<tr>
<td>template_subject</td>
<td>varchar(200)</td>
<td>该邮件模板的邮件主题</td>
</tr>
<tr>
<td>template_content</td>
<td>text</td>
<td>邮件模板的内容</td>
</tr>
<tr>
<td>last_modify</td>
<td>int(10)</td>
<td>最后一次修改模板的时间</td>
</tr>
<tr>
<td>last_send</td>
<td>int(10)</td>
<td>最近一次发送的时间，好像仅在杂志才记录</td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
<td>该邮件模板的邮件类型；共2个类型；magazine，杂志订阅；template，关注订阅</td>
</tr>
</tbody>
</table>
<h2 id="会员折扣价ecs-member-price"><a href="#会员折扣价ecs-member-price" class="headerlink" title="会员折扣价ecs_member_price"></a>会员折扣价<code>ecs_member_price</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>price_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品的id</td>
</tr>
<tr>
<td>user_rank</td>
<td>tinyint(3)</td>
<td>会员登记id</td>
</tr>
<tr>
<td>user_price</td>
<td>decimal(10,2)</td>
<td>指定商品对指定会员等级的固定定价价格，单位元</td>
</tr>
</tbody>
</table>
<h2 id="上中下3个导航栏的显示配置ecs-nav"><a href="#上中下3个导航栏的显示配置ecs-nav" class="headerlink" title="上中下3个导航栏的显示配置ecs_nav"></a>上中下3个导航栏的显示配置<code>ecs_nav</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>ctype</td>
<td>varchar(10)</td>
<td>分类类型</td>
</tr>
<tr>
<td>cid</td>
<td>smallint(5)</td>
<td>分类ID</td>
</tr>
<tr>
<td>name</td>
<td>varchar(255)</td>
<td>导航显示标题</td>
</tr>
<tr>
<td>ifshow</td>
<td>tinyint(1)</td>
<td>是否显示</td>
</tr>
<tr>
<td>vieworder</td>
<td>tinyint(1)</td>
<td>页面显示顺序，数字越大越靠后</td>
</tr>
<tr>
<td>opennew</td>
<td>tinyint(1)</td>
<td>导航链接页面是否在新窗口打开，1，是；其他，否</td>
</tr>
<tr>
<td>url</td>
<td>varchar(255)</td>
<td>链接的页面地址</td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
<td>处于导航栏的位置，top为顶部；middle为中间；bottom,为底部</td>
</tr>
</tbody>
</table>
<h2 id="对订单操作日志表ecs-order-action"><a href="#对订单操作日志表ecs-order-action" class="headerlink" title="对订单操作日志表ecs_order_action"></a>对订单操作日志表<code>ecs_order_action</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>action_id</td>
<td>mediumint(8)</td>
<td>流水号</td>
</tr>
<tr>
<td>order_id</td>
<td>mediumint(8)</td>
<td>被操作的交易号</td>
</tr>
<tr>
<td>action_user</td>
<td>varchar(30)</td>
<td>操作该次的人员</td>
</tr>
<tr>
<td>order_status</td>
<td>tinyint(1)</td>
<td>作何操作0,未确认, 1已确认; 2已取消; 3无效; 4退货</td>
</tr>
<tr>
<td>shipping_status</td>
<td>tinyint(1)</td>
<td>发货状态; 0未发货; 1已发货  2已取消  3备货中</td>
</tr>
<tr>
<td>pay_status</td>
<td>tinyint(1)</td>
<td>支付状态 0未付款;  1已付款中;  2已付款</td>
</tr>
<tr>
<td>action_place</td>
<td>tinyint(1)</td>
<td></td>
</tr>
<tr>
<td>action_note</td>
<td>varchar(255)</td>
<td>操作备注</td>
</tr>
<tr>
<td>log_time</td>
<td>int(11)</td>
<td>操作时间</td>
</tr>
</tbody>
</table>
<h2 id="订单的商品信息ecs-order-goods"><a href="#订单的商品信息ecs-order-goods" class="headerlink" title="订单的商品信息ecs_order_goods"></a>订单的商品信息<code>ecs_order_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rec_id</td>
<td>mediumint(8)</td>
<td>编号</td>
</tr>
<tr>
<td>order_id</td>
<td>mediumint(8)</td>
<td>订单商品信息对应的详细信息id，取值order_info的order_id</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品的的id，取值表goods 的goods_id</td>
</tr>
<tr>
<td>goods_name</td>
<td>varchar(120)</td>
<td>商品的名称，取值表goods</td>
</tr>
<tr>
<td>goods_sn</td>
<td>varchar(60)</td>
<td>商品的唯一货号，取值goods</td>
</tr>
<tr>
<td>product_id</td>
<td>mediumint(8)</td>
<td>货品ID</td>
</tr>
<tr>
<td>goods_number</td>
<td>smallint(5)</td>
<td>商品的购买数量</td>
</tr>
<tr>
<td>market_price</td>
<td>decimal(10,2)</td>
<td>商品的市场售价，取值goods</td>
</tr>
<tr>
<td>goods_price</td>
<td>decimal(10,2)</td>
<td>商品的本店售价，取值goods</td>
</tr>
<tr>
<td>goods_attr</td>
<td>text</td>
<td>购买该商品时所选择的属性</td>
</tr>
<tr>
<td>send_number</td>
<td>smallint(5)</td>
<td>当不是实物时，是否已发货，0，否；1，是</td>
</tr>
<tr>
<td>is_real</td>
<td>tinyint(1)</td>
<td>是否是实物，0，否；1，是；取值goods</td>
</tr>
<tr>
<td>extension_code</td>
<td>varchar(30)</td>
<td>商品的扩展属性，比如像虚拟卡。取值goods</td>
</tr>
<tr>
<td>parent_id</td>
<td>mediumint(8)</td>
<td>父商品id，取值于cart的parent_id；如果有该值则是值多代表的物品的配件</td>
</tr>
<tr>
<td>is_gift</td>
<td>smallint(5)</td>
<td>是否参加优惠活动，0，否；其他，取值于cart 的is_gift，跟其一样，是参加的优惠活动的id</td>
</tr>
<tr>
<td>goods_attr_id</td>
<td>varchar(255)</td>
<td>货品属性ID</td>
</tr>
</tbody>
</table>
<h2 id="订单的配送ecs-order-info"><a href="#订单的配送ecs-order-info" class="headerlink" title="订单的配送ecs_order_info"></a>订单的配送<code>ecs_order_info</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>order_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>order_sn</td>
<td>varchar(20)</td>
<td>订单号,唯一</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户id,同users的user_id</td>
</tr>
<tr>
<td>order_status</td>
<td>tinyint(1)</td>
<td>订单的状态;0未确认,1确认,2已取消,3无效,4退货</td>
</tr>
<tr>
<td>shipping_status</td>
<td>tinyint(1)</td>
<td>商品配送情况;0未发货,1已发货,2已收货,4退货</td>
</tr>
<tr>
<td>pay_status</td>
<td>tinyint(1)</td>
<td>支付状态;0未付款;1付款中;2已付款</td>
</tr>
<tr>
<td>consignee</td>
<td>varchar(60)</td>
<td>收货人的姓名,用户页面填写,默认取值表user_address</td>
</tr>
<tr>
<td>country</td>
<td>smallint(5)</td>
<td>收货人的国家,用户页面填写,默认取值于表user_address,其id对应的值在region</td>
</tr>
<tr>
<td>province</td>
<td>smallint(5)</td>
<td>收货人的省份,用户页面填写,默认取值于表user_address, 其id对应的值在region</td>
</tr>
<tr>
<td>city</td>
<td>smallint(5)</td>
<td>收货人的城市,用户页面填写,默认取值于表user_address,其id对应的值在region</td>
</tr>
<tr>
<td>district</td>
<td>smallint(5)</td>
<td>收货人的地区,用户页面填写,默认取值于表user_address,其id对应的值在region</td>
</tr>
<tr>
<td>address</td>
<td>varchar(255)</td>
<td>收货人的详细地址,用户页面填写,默认取值于表user_address</td>
</tr>
<tr>
<td>zipcode</td>
<td>varchar(60)</td>
<td>收货人的邮编,用户页面填写,默认取值于表user_address</td>
</tr>
<tr>
<td>tel</td>
<td>varchar(60)</td>
<td>收货人的电话,用户页面填写,默认取值于表user_address</td>
</tr>
<tr>
<td>mobile</td>
<td>varchar(60)</td>
<td>收货人的手机,用户页面填写,默认取值于表user_address</td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>收货人的Email, 用户页面填写,默认取值于表user_address</td>
</tr>
<tr>
<td>best_time</td>
<td>varchar(120)</td>
<td>收货人的最佳送货时间,用户页面填写,默认取值于表user_addr</td>
</tr>
<tr>
<td>sign_building</td>
<td>varchar(120)</td>
<td>送货人的地址的标志性建筑,用户页面填写,默认取值于表user_address</td>
</tr>
<tr>
<td>postscript</td>
<td>varchar(255)</td>
<td>订单附言,由用户提交订单前填写</td>
</tr>
<tr>
<td>shipping_id</td>
<td>tinyint(3)</td>
<td>用户选择的配送方式id,取值表shipping</td>
</tr>
<tr>
<td>shipping_name</td>
<td>varchar(120)</td>
<td>用户选择的配送方式的名称,取值表shipping</td>
</tr>
<tr>
<td>pay_id</td>
<td>tinyint(3)</td>
<td>用户选择的支付方式的id,取值表payment</td>
</tr>
<tr>
<td>pay_name</td>
<td>varchar(120)</td>
<td>用户选择的支付方式名称,取值表payment</td>
</tr>
<tr>
<td>how_oos</td>
<td>varchar(120)</td>
<td>缺货处理方式,等待所有商品备齐后再发,取消订单;与店主协商</td>
</tr>
<tr>
<td>how_surplus</td>
<td>varchar(120)</td>
<td>根据字段猜测应该是余额处理方式,程序未作这部分实现</td>
</tr>
<tr>
<td>pack_name</td>
<td>varchar(120)</td>
<td>包装名称,取值表pack</td>
</tr>
<tr>
<td>card_name</td>
<td>varchar(120)</td>
<td>贺卡的名称,取值card</td>
</tr>
<tr>
<td>card_message</td>
<td>varchar(255)</td>
<td>贺卡内容,由用户提交</td>
</tr>
<tr>
<td>inv_payee</td>
<td>varchar(120)</td>
<td>发票抬头,用户页面填写</td>
</tr>
<tr>
<td>inv_content</td>
<td>varchar(120)</td>
<td>发票内容,用户页面选择,取值shop_config的code字段的值 为invoice_content的value</td>
</tr>
<tr>
<td>goods_amount</td>
<td>decimal(10,2)</td>
<td>商品的总金额</td>
</tr>
<tr>
<td>shipping_fee</td>
<td>decimal(10,2)</td>
<td>配送费用</td>
</tr>
<tr>
<td>insure_fee</td>
<td>decimal(10,2)</td>
<td>保价费用</td>
</tr>
<tr>
<td>pay_fee</td>
<td>decimal(10,2)</td>
<td>支付费用,跟支付方式的配置相关,取值表payment</td>
</tr>
<tr>
<td>pack_fee</td>
<td>decimal(10,2)</td>
<td>包装费用,取值表pack</td>
</tr>
<tr>
<td>card_fee</td>
<td>decimal(10,2)</td>
<td>贺卡费用,取值card</td>
</tr>
<tr>
<td>money_paid</td>
<td>decimal(10,2)</td>
<td>已付款金额</td>
</tr>
<tr>
<td>surplus</td>
<td>decimal(10,2)</td>
<td>该订单使用金额的数量,取用户设定余额,用户可用余额,订单金额中最小者</td>
</tr>
<tr>
<td>integral</td>
<td>int(10)</td>
<td>使用的积分的数量,取用户使用积分,商品可用积分,用户拥有积分中最小者</td>
</tr>
<tr>
<td>integral_money</td>
<td>decimal(10,2)</td>
<td>使用积分金额</td>
</tr>
<tr>
<td>bonus</td>
<td>decimal(10,2)</td>
<td>使用红包金额</td>
</tr>
<tr>
<td>order_amount</td>
<td>decimal(10,2)</td>
<td>应付款金额</td>
</tr>
<tr>
<td>from_ad</td>
<td>smallint(5)</td>
<td>订单由某广告带来的广告id,应该取值于ad</td>
</tr>
<tr>
<td>referer</td>
<td>varchar(255)</td>
<td>订单的来源页面</td>
</tr>
<tr>
<td>add_time</td>
<td>int(10)</td>
<td>订单生成时间</td>
</tr>
<tr>
<td>confirm_time</td>
<td>int(10)</td>
<td>订单确认时间</td>
</tr>
<tr>
<td>pay_time</td>
<td>int(10)</td>
<td>订单支付时间</td>
</tr>
<tr>
<td>shipping_time</td>
<td>int(10)</td>
<td>订单配送时间</td>
</tr>
<tr>
<td>pack_id</td>
<td>tinyint(3)</td>
<td>包装id,取值表pck</td>
</tr>
<tr>
<td>card_id</td>
<td>tinyint(3)</td>
<td>贺卡id,用户在页面选择,取值</td>
</tr>
<tr>
<td>bonus_id</td>
<td>mediumint(8)</td>
<td>红包id, user_bonus的bonus_id</td>
</tr>
<tr>
<td>invoice_no</td>
<td>varchar(255)</td>
<td>发货时填写, 可在订单查询查看</td>
</tr>
<tr>
<td>extension_code</td>
<td>varchar(30)</td>
<td>通过活动购买的商品的代号,group_buy是团购; auction是拍卖;snatch夺宝奇兵;正常普通产品该处理为空</td>
</tr>
<tr>
<td>extension_id</td>
<td>mediumint(8)</td>
<td>通过活动购买的物品id,取值ecs_good_activity;如果是正常普通商品,该处为0</td>
</tr>
<tr>
<td>to_buyer</td>
<td>varchar(255)</td>
<td>商家给客户的留言,当该字段值时可以在订单查询看到</td>
</tr>
<tr>
<td>pay_note</td>
<td>varchar(255)</td>
<td>付款备注, 在订单管理编辑修改</td>
</tr>
<tr>
<td>agency_id</td>
<td>smallint(5)</td>
<td>该笔订单被指派给的办事处的id, 根据订单内容和办事处负责范围自动决定,也可以有管理员修改,取值于表agency</td>
</tr>
<tr>
<td>inv_type</td>
<td>varchar(60)</td>
<td>发票类型,用户页面选择,取值shop_config的code字段的值invoice_type的value</td>
</tr>
<tr>
<td>tax</td>
<td>decimal(10,2)</td>
<td>发票税额</td>
</tr>
<tr>
<td>is_separate</td>
<td>tinyint(1)</td>
<td>0未分成或等待分成;1已分成;2取消分成</td>
</tr>
<tr>
<td>parent_id</td>
<td>mediumint(8)</td>
<td>自增ID</td>
</tr>
<tr>
<td>discount</td>
<td>decimal(10,2)</td>
<td>订单号,唯一</td>
</tr>
</tbody>
</table>
<h2 id="商品包装信息配置表ecs-pack"><a href="#商品包装信息配置表ecs-pack" class="headerlink" title="商品包装信息配置表ecs_pack"></a>商品包装信息配置表<code>ecs_pack</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>pack_id</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>pack_name</td>
<td>varchar(120)</td>
<td>包装的名称</td>
</tr>
<tr>
<td>pack_img</td>
<td>varchar(255)</td>
<td>包装图纸</td>
</tr>
<tr>
<td>pack_fee</td>
<td>decimal(6,2)</td>
<td>包装的费用</td>
</tr>
<tr>
<td>free_money</td>
<td>smallint(5)</td>
<td>订单达到此金额可以免除该包装费用</td>
</tr>
<tr>
<td>pack_desc</td>
<td>varchar(255)</td>
<td>包装描述</td>
</tr>
</tbody>
</table>
<h2 id="礼包商品表ecs-package-goods"><a href="#礼包商品表ecs-package-goods" class="headerlink" title="礼包商品表ecs_package_goods"></a>礼包商品表<code>ecs_package_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>package_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品ID</td>
</tr>
<tr>
<td>product_id</td>
<td>mediumint(8)</td>
<td>产品ID</td>
</tr>
<tr>
<td>goods_number</td>
<td>smallint(5)</td>
<td>商品数量</td>
</tr>
<tr>
<td>admin_id</td>
<td>tinyint(3)</td>
<td>管理员ID</td>
</tr>
</tbody>
</table>
<h2 id="安装的支付方式配置信息ecs-payment"><a href="#安装的支付方式配置信息ecs-payment" class="headerlink" title="安装的支付方式配置信息ecs_payment"></a>安装的支付方式配置信息<code>ecs_payment</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>pay_id</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>pay_code</td>
<td>varchar(20)</td>
<td>支付方式 的英文缩写,其实是该支付方式处理插件的不带后缀的文件名部分</td>
</tr>
<tr>
<td>pay_name</td>
<td>varchar(120)</td>
<td>支付方式名称</td>
</tr>
<tr>
<td>pay_fee</td>
<td>varchar(10)</td>
<td>支付费用</td>
</tr>
<tr>
<td>pay_desc</td>
<td>text</td>
<td>支付方式描述</td>
</tr>
<tr>
<td>pay_order</td>
<td>tinyint(3)</td>
<td>支付方式在页面的显示顺序</td>
</tr>
<tr>
<td>pay_config</td>
<td>text</td>
<td>支付方式的配置信息,包括商户号和密钥什么的</td>
</tr>
<tr>
<td>enabled</td>
<td>tinyint(1)</td>
<td>是否可用;0否;1是</td>
</tr>
<tr>
<td>is_cod</td>
<td>tinyint(1)</td>
<td>是否货到付款, 0否;1是</td>
</tr>
<tr>
<td>is_online</td>
<td>tinyint(1)</td>
<td>是否在线支付;0否;1是</td>
</tr>
</tbody>
</table>
<h2 id="系统支付记录ecs-pay-log"><a href="#系统支付记录ecs-pay-log" class="headerlink" title="系统支付记录ecs_pay_log"></a>系统支付记录<code>ecs_pay_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>order_id</td>
<td>mediumint(8)</td>
<td>对应的交交易记录的id,取值表order_info</td>
</tr>
<tr>
<td>order_amount</td>
<td>decimal(10,2)</td>
<td>支付金额</td>
</tr>
<tr>
<td>order_type</td>
<td>tinyint(1)</td>
<td>支付类型,0订单支付,1会员预付款支付</td>
</tr>
<tr>
<td>is_paid</td>
<td>tinyint(1)</td>
<td>是否已支付,0否;1是</td>
</tr>
<tr>
<td>openid</td>
<td>int(4)</td>
<td>微信用户唯一标识</td>
</tr>
</tbody>
</table>
<h2 id="插件表ecs-plugins"><a href="#插件表ecs-plugins" class="headerlink" title="插件表ecs_plugins"></a>插件表<code>ecs_plugins</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>varchar(30)</td>
<td>插件名称</td>
</tr>
<tr>
<td>version</td>
<td>varchar(10)</td>
<td>版本</td>
</tr>
<tr>
<td>library</td>
<td>varchar(255)</td>
<td></td>
</tr>
<tr>
<td>assign</td>
<td>tinyint(1)</td>
<td></td>
</tr>
<tr>
<td>install_date</td>
<td>int(10)</td>
</tr>
</tbody>
</table>
<h2 id="货品表ecs-products"><a href="#货品表ecs-products" class="headerlink" title="货品表ecs_products"></a>货品表<code>ecs_products</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>product_id</td>
<td>mediumint(8)</td>
<td>货品ID</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品ID</td>
</tr>
<tr>
<td>goods_attr</td>
<td>varchar(50)</td>
<td>商品属性</td>
</tr>
<tr>
<td>product_sn</td>
<td>varchar(60)</td>
<td>货号</td>
</tr>
<tr>
<td>product_number</td>
<td>smallint(5)</td>
<td>货品数量</td>
</tr>
</tbody>
</table>
<h2 id="地区列表ecs-region"><a href="#地区列表ecs-region" class="headerlink" title="地区列表ecs_region"></a>地区列表<code>ecs_region</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>region_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>parent_id</td>
<td>smallint(5)</td>
<td>该地区的上一个节点的地区id</td>
</tr>
<tr>
<td>region_name</td>
<td>varchar(120)</td>
<td>地区的名字</td>
</tr>
<tr>
<td>region_type</td>
<td>tinyint(1)</td>
<td>该地区的下一个节点的地区id</td>
</tr>
<tr>
<td>agency_id</td>
<td>smallint(5)</td>
<td>办事处的id,这里有一个bug,同一个省不能有多个办事处,该字段只记录最新的那个办事处的id’</td>
</tr>
</tbody>
</table>
<h2 id="注册的扩展信息表ecs-reg-extend-info"><a href="#注册的扩展信息表ecs-reg-extend-info" class="headerlink" title="注册的扩展信息表ecs_reg_extend_info"></a>注册的扩展信息表<code>ecs_reg_extend_info</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户ID</td>
</tr>
<tr>
<td>reg_field_id</td>
<td>int(10)</td>
<td>注册字段ID</td>
</tr>
<tr>
<td>content</td>
<td>text</td>
<td>内容</td>
</tr>
</tbody>
</table>
<h2 id="注册字段表ecs-reg-fields"><a href="#注册字段表ecs-reg-fields" class="headerlink" title="注册字段表ecs_reg_fields"></a>注册字段表<code>ecs_reg_fields</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>reg_field_name</td>
<td>注册字段名</td>
</tr>
<tr>
<td>dis_order</td>
<td>tinyint(3)</td>
<td>显示顺序</td>
</tr>
<tr>
<td>display</td>
<td>tinyint(1)</td>
<td>显示否</td>
</tr>
<tr>
<td>type</td>
<td>tinyint(1)</td>
<td>类型</td>
</tr>
<tr>
<td>is_need</td>
<td>tinyint(1)</td>
<td>是否需要</td>
</tr>
</tbody>
</table>
<h2 id="角色表ecs-role"><a href="#角色表ecs-role" class="headerlink" title="角色表ecs_role"></a>角色表<code>ecs_role</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>role_id</td>
<td>smallint(5)</td>
<td>角色ID</td>
</tr>
<tr>
<td>role_name</td>
<td>varchar(60)</td>
<td>角色名</td>
</tr>
<tr>
<td>action_list</td>
<td>text</td>
<td>权限列表</td>
</tr>
<tr>
<td>role_describe</td>
<td>text</td>
<td>角色描述</td>
</tr>
</tbody>
</table>
<h2 id="搜索引擎访问记录ecs-searchengine"><a href="#搜索引擎访问记录ecs-searchengine" class="headerlink" title="搜索引擎访问记录ecs_searchengine"></a>搜索引擎访问记录<code>ecs_searchengine</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>date</td>
<td>date</td>
<td>搜索引擎访问日期</td>
</tr>
<tr>
<td>searchengine</td>
<td>varchar(20)</td>
<td>搜索引擎名称</td>
</tr>
<tr>
<td>count</td>
<td>mediumint(8)</td>
<td>访问次数</td>
</tr>
</tbody>
</table>
<h2 id="session记录表ecs-sessions"><a href="#session记录表ecs-sessions" class="headerlink" title="session记录表ecs_sessions"></a>session记录表<code>ecs_sessions</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sesskey</td>
<td>char(32)</td>
<td>sessionid</td>
</tr>
<tr>
<td>expiry</td>
<td>int(10)</td>
<td>Session创建时间</td>
</tr>
<tr>
<td>userid</td>
<td>mediumint(8)</td>
<td>如果不是管理员，记录用户id</td>
</tr>
<tr>
<td>adminid</td>
<td>mediumint(8)</td>
<td>如果是管理员记录管理员id</td>
</tr>
<tr>
<td>ip</td>
<td>char(15)</td>
<td>ip</td>
</tr>
<tr>
<td>user_name</td>
<td>varchar(60)</td>
<td>用户名</td>
</tr>
<tr>
<td>user_rank</td>
<td>tinyint(3)</td>
<td>用户等级</td>
</tr>
<tr>
<td>discount</td>
<td>decimal(3,2)</td>
<td>折扣价</td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>邮箱</td>
</tr>
<tr>
<td>data</td>
<td>char(255)</td>
<td>序列化后的session数据，如果session数据大于255则将数据存到表sessions_data，此处为空</td>
</tr>
</tbody>
</table>
<h2 id="session数据表ecs-sessions-data"><a href="#session数据表ecs-sessions-data" class="headerlink" title="session数据表ecs_sessions_data"></a>session数据表<code>ecs_sessions_data</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sesskey</td>
<td>varchar(32)</td>
<td>sessionid</td>
</tr>
<tr>
<td>expiry</td>
<td>int(10)</td>
<td>Session创建时间</td>
</tr>
<tr>
<td>data</td>
<td>longtext</td>
<td>Session序列化后的数据</td>
</tr>
</tbody>
</table>
<h2 id="配送方式配置信息表ecs-shipping"><a href="#配送方式配置信息表ecs-shipping" class="headerlink" title="配送方式配置信息表ecs_shipping"></a>配送方式配置信息表<code>ecs_shipping</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shipping_id</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>shipping_code</td>
<td>varchar(20)</td>
<td>配送方式的字符串代号</td>
</tr>
<tr>
<td>shipping_name</td>
<td>varchar(120)</td>
<td>配送方式名称</td>
</tr>
<tr>
<td>shipping_desc</td>
<td>varchar(255)</td>
<td>配送方式描述</td>
</tr>
<tr>
<td>insure</td>
<td>varchar(10)</td>
<td>保价费用，单位元，或者是百分数，该值直接输出为报价费用</td>
</tr>
<tr>
<td>support_cod</td>
<td>tinyint(1)</td>
<td>是否支持货到付款，1，支持；0，不支持</td>
</tr>
<tr>
<td>enabled</td>
<td>tinyint(1)</td>
<td>该配送方式是否被禁用，1，可用；0，禁用</td>
</tr>
<tr>
<td>shipping_print</td>
<td>text</td>
<td>快递单打印模版</td>
</tr>
<tr>
<td>print_bg</td>
<td>varchar(255)</td>
<td>快递单背景图片路径名</td>
</tr>
<tr>
<td>config_lable</td>
<td>text</td>
<td>打印快递单标签位置信息</td>
</tr>
<tr>
<td>print_model</td>
<td>tinyint(1)</td>
<td>编辑器模式</td>
</tr>
<tr>
<td>shipping_order</td>
<td>tinyint(3)</td>
<td>排序</td>
</tr>
</tbody>
</table>
<h2 id="配送方式所属的配送区域和配送费用信息ecs-shipping-area"><a href="#配送方式所属的配送区域和配送费用信息ecs-shipping-area" class="headerlink" title="配送方式所属的配送区域和配送费用信息ecs_shipping_area"></a>配送方式所属的配送区域和配送费用信息<code>ecs_shipping_area</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shipping_area_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>shipping_area_name</td>
<td>varchar(150)</td>
<td>配送方式中的配送区域的名字</td>
</tr>
<tr>
<td>shipping_id</td>
<td>tinyint(3)</td>
<td>该配送区域所属的配送方式，同shipping的shipping_id</td>
</tr>
<tr>
<td>configure</td>
<td>text</td>
<td>序列化的该配送区域的费用配置信息</td>
</tr>
</tbody>
</table>
<h2 id="全站配置信息表ecs-shop-config"><a href="#全站配置信息表ecs-shop-config" class="headerlink" title="全站配置信息表ecs_shop_config"></a>全站配置信息表<code>ecs_shop_config</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>parent_id</td>
<td>smallint(5)</td>
<td>父节点id，取值于该表id字段的值</td>
</tr>
<tr>
<td>code</td>
<td>varchar(30)</td>
<td>跟变量名的作用差不多，其实就是语言包中的字符串索引，如$_LANG[‘’cfg_range’’][‘’cart_confirm’’]</td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
<td>该配置的类型，text，文本输入框</td>
</tr>
<tr>
<td>store_range</td>
<td>varchar(255)</td>
<td>当语言包中的code字段对应的是一个数组时，那该处就是该数组的索引，如$_LANG[‘’cfg_range’’][‘’cart_confirm’’][1]；只有type字段为select,options时才有值’</td>
</tr>
<tr>
<td>store_dir</td>
<td>varchar(255)</td>
<td>当type为file时才有值，文件上传后的保存目录</td>
</tr>
<tr>
<td>value</td>
<td>text</td>
<td>该项配置的值</td>
</tr>
<tr>
<td>sort_order</td>
<td>tinyint(3)</td>
<td>显示顺序，数字越大越靠后</td>
</tr>
</tbody>
</table>
<h2 id="夺宝奇兵出价记录表ecs-snatch-log"><a href="#夺宝奇兵出价记录表ecs-snatch-log" class="headerlink" title="夺宝奇兵出价记录表ecs_snatch_log"></a>夺宝奇兵出价记录表<code>ecs_snatch_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>snatch_id</td>
<td>tinyint(3)</td>
<td>夺宝奇兵活动号，取值于goods_activity的act_id字段</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>出价的用户id，取值于users的user_id</td>
</tr>
<tr>
<td>bid_price</td>
<td>decimal(10,2)</td>
<td>出价的价格</td>
</tr>
<tr>
<td>bid_time</td>
<td>int(10)</td>
<td>出价的时间</td>
</tr>
</tbody>
</table>
<h2 id="访问信息记录表ecs-stats"><a href="#访问信息记录表ecs-stats" class="headerlink" title="访问信息记录表ecs_stats"></a>访问信息记录表<code>ecs_stats</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>access_time</td>
<td>int(10)</td>
<td>访问时间</td>
</tr>
<tr>
<td>ip_address</td>
<td>varchar(15)</td>
<td>访问者ip</td>
</tr>
<tr>
<td>visit_times</td>
<td>smallint(5)</td>
<td>访问次数，如果之前有过访问次数，在以前的基础上＋1</td>
</tr>
<tr>
<td>browser</td>
<td>varchar(60)</td>
<td>浏览器及版本</td>
</tr>
<tr>
<td>system</td>
<td>varchar(20)</td>
<td>操作系统</td>
</tr>
<tr>
<td>language</td>
<td>varchar(20)</td>
<td>语言</td>
</tr>
<tr>
<td>area</td>
<td>varchar(30)</td>
<td>ip所在地区</td>
</tr>
<tr>
<td>referer_domain</td>
<td>varchar(100)</td>
<td>页面访问来源域名</td>
</tr>
<tr>
<td>referer_path</td>
<td>varchar(200)</td>
<td>页面访问来源除域名外的路径部分</td>
</tr>
<tr>
<td>access_url</td>
<td>varchar(255)</td>
<td>访问页面文件名</td>
</tr>
</tbody>
</table>
<h2 id="供货商表ecs-suppliers"><a href="#供货商表ecs-suppliers" class="headerlink" title="供货商表ecs_suppliers"></a>供货商表<code>ecs_suppliers</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>suppliers_id</td>
<td>smallint(5)</td>
<td>供货商ID</td>
</tr>
<tr>
<td>suppliers_name</td>
<td>varchar(255)</td>
<td>供货商名称</td>
</tr>
<tr>
<td>suppliers_desc</td>
<td>mediumtext</td>
<td>描述</td>
</tr>
<tr>
<td>is_check</td>
<td>tinyint(1)</td>
</tr>
</tbody>
</table>
<h2 id="商品的标记ecs-tag"><a href="#商品的标记ecs-tag" class="headerlink" title="商品的标记ecs_tag"></a>商品的标记<code>ecs_tag</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tag_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户的id</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品的id</td>
</tr>
<tr>
<td>tag_words</td>
<td>varchar(255)</td>
<td>标签内容</td>
</tr>
</tbody>
</table>
<h2 id="模板设置数据表ecs-template"><a href="#模板设置数据表ecs-template" class="headerlink" title="模板设置数据表ecs_template"></a>模板设置数据表<code>ecs_template</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>varchar(30)</td>
<td>该条模板配置属于哪个模板页面</td>
</tr>
<tr>
<td>region</td>
<td>varchar(40)</td>
<td>该条模板配置在它所属的模板文件中的位置</td>
</tr>
<tr>
<td>library</td>
<td>varchar(40)</td>
<td>该条模板配置在它所属的模板文件中的位置处应该引入的lib的相对目录地址</td>
</tr>
<tr>
<td>sort_order</td>
<td>tinyint(1)</td>
<td>模板文件中这个位置的引入lib项的值的显示顺序</td>
</tr>
<tr>
<td>id</td>
<td>smallint(5)</td>
<td>字段意义待查</td>
</tr>
<tr>
<td>number</td>
<td>tinyint(1)</td>
<td>每次显示多少个值</td>
</tr>
<tr>
<td>type</td>
<td>tinyint(1)</td>
<td>属于哪个动态项，0，固定项；1，分类下的商品；2，品牌下的商品；3，文章列表；4，广告位</td>
</tr>
<tr>
<td>theme</td>
<td>varchar(60)</td>
<td>该模板配置项属于哪套模板的模板名</td>
</tr>
<tr>
<td>remarks</td>
<td>varchar(30)</td>
<td>备注，可能是预留字段，没有值所以没确定用途</td>
</tr>
</tbody>
</table>
<h2 id="专题活动配置表ecs-topic"><a href="#专题活动配置表ecs-topic" class="headerlink" title="专题活动配置表ecs_topic"></a>专题活动配置表<code>ecs_topic</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>topic_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>title</td>
<td>varchar(255)</td>
<td>专题名称</td>
</tr>
<tr>
<td>intro</td>
<td>text</td>
<td>专题介绍</td>
</tr>
<tr>
<td>start_time</td>
<td>int(11)</td>
<td>专题开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int(10)</td>
<td>结束时间</td>
</tr>
<tr>
<td>data</td>
<td>text</td>
<td>专题数据内容，包括分类，商品等</td>
</tr>
<tr>
<td>template</td>
<td>varchar(255)</td>
<td>专题模板文件</td>
</tr>
<tr>
<td>css</td>
<td>text</td>
<td>专题样式代码</td>
</tr>
<tr>
<td>topic_img</td>
<td>varchar(255)</td>
<td>主图</td>
</tr>
<tr>
<td>title_pic</td>
<td>varchar(255)</td>
<td>标题图</td>
</tr>
<tr>
<td>base_style</td>
<td>char(6)</td>
<td>基本风格样式</td>
</tr>
<tr>
<td>htmls</td>
<td>mediumtext</td>
<td></td>
</tr>
<tr>
<td>keywords</td>
<td>varchar(255)</td>
<td>关键字</td>
</tr>
<tr>
<td>description</td>
<td>varchar(255)</td>
<td>描述</td>
</tr>
</tbody>
</table>
<h2 id="优惠活动ecs-touch-activity"><a href="#优惠活动ecs-touch-activity" class="headerlink" title="优惠活动ecs_touch_activity"></a>优惠活动<code>ecs_touch_activity</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>act_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>act_banner</td>
<td>varchar(255)</td>
<td>活动banner</td>
</tr>
</tbody>
</table>
<h2 id="工具箱-gt-登录插件ecs-touch-auth"><a href="#工具箱-gt-登录插件ecs-touch-auth" class="headerlink" title="工具箱-&gt;登录插件ecs_touch_auth"></a>工具箱-&gt;登录插件<code>ecs_touch_auth</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>tinyint(2)</td>
<td></td>
</tr>
<tr>
<td>auth_config</td>
<td>text</td>
<td>配置信息</td>
</tr>
<tr>
<td>from</td>
<td>varchar(10)</td>
<td>插件名</td>
</tr>
</tbody>
</table>
<h2 id="分类ecs-touch-category"><a href="#分类ecs-touch-category" class="headerlink" title="分类ecs_touch_category"></a>分类<code>ecs_touch_category</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>cat_id</td>
<td>int(10)</td>
<td>外键</td>
</tr>
<tr>
<td>cat_image</td>
<td>varchar(255)</td>
<td>分类ICO图标</td>
</tr>
</tbody>
</table>
<h2 id="消息ecs-touch-feedback"><a href="#消息ecs-touch-feedback" class="headerlink" title="消息ecs_touch_feedback"></a>消息<code>ecs_touch_feedback</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>msg_id</td>
<td>mediumint(8)</td>
<td>消息ID</td>
</tr>
<tr>
<td>msg_read</td>
<td>int(1)</td>
<td>消息是否已读</td>
</tr>
</tbody>
</table>
<h2 id="商品ecs-touch-goods"><a href="#商品ecs-touch-goods" class="headerlink" title="商品ecs_touch_goods"></a>商品<code>ecs_touch_goods</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>goods_id</td>
<td>int(10)</td>
<td>外键</td>
</tr>
<tr>
<td>sales_volume</td>
<td>int(10)</td>
<td>销量统计</td>
</tr>
</tbody>
</table>
<h2 id="商品活动ecs-touch-goods-activity"><a href="#商品活动ecs-touch-goods-activity" class="headerlink" title="商品活动ecs_touch_goods_activity"></a>商品活动<code>ecs_touch_goods_activity</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>act_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>act_banner</td>
<td>varchar(255)</td>
<td>活动banner</td>
</tr>
<tr>
<td>sales_count</td>
<td>int(10)</td>
<td>促销商品数</td>
</tr>
<tr>
<td>click_num</td>
<td>int(10)</td>
<td>点击次数</td>
</tr>
<tr>
<td>cur_price</td>
<td>decimal(10,2)</td>
<td>当前价格</td>
</tr>
</tbody>
</table>
<h2 id="工具箱-gt-导航栏设置ecs-touch-nav"><a href="#工具箱-gt-导航栏设置ecs-touch-nav" class="headerlink" title="工具箱-&gt;导航栏设置ecs_touch_nav"></a>工具箱-&gt;导航栏设置<code>ecs_touch_nav</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>ctype</td>
<td>varchar(10)</td>
<td></td>
</tr>
<tr>
<td>cid</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>varchar(255)</td>
<td>名称</td>
</tr>
<tr>
<td>ifshow</td>
<td>tinyint(1)</td>
<td>是否显示，1显示，0不显示</td>
</tr>
<tr>
<td>vieworder</td>
<td>tinyint(1)</td>
<td></td>
</tr>
<tr>
<td>opennew</td>
<td>tinyint(1)</td>
<td></td>
</tr>
<tr>
<td>url</td>
<td>varchar(255)</td>
<td>链接地址</td>
</tr>
<tr>
<td>pic</td>
<td>varchar(255)</td>
<td>图片地址</td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
</tr>
</tbody>
</table>
<h2 id="专题表ecs-touch-topic"><a href="#专题表ecs-touch-topic" class="headerlink" title="专题表ecs_touch_topic"></a>专题表<code>ecs_touch_topic</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>topic_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>title</td>
<td>varchar(255)</td>
<td>标题</td>
</tr>
<tr>
<td>intro</td>
<td>text</td>
<td>介绍</td>
</tr>
<tr>
<td>start_time</td>
<td>int(11)</td>
<td>开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int(10)</td>
<td>结束时间</td>
</tr>
<tr>
<td>data</td>
<td>text</td>
<td></td>
</tr>
<tr>
<td>template</td>
<td>varchar(255)</td>
<td></td>
</tr>
<tr>
<td>css</td>
<td>text</td>
<td></td>
</tr>
<tr>
<td>topic_img</td>
<td>varchar(255)</td>
<td></td>
</tr>
<tr>
<td>title_pic</td>
<td>varchar(255)</td>
<td></td>
</tr>
<tr>
<td>base_style</td>
<td>char(6)</td>
<td></td>
</tr>
<tr>
<td>htmls</td>
<td>mediumtext,</td>
</tr>
<tr>
<td>keywords</td>
<td>varchar(255)</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>varchar(255)</td>
</tr>
</tbody>
</table>
<h2 id="用户信息ecs-touch-user-info"><a href="#用户信息ecs-touch-user-info" class="headerlink" title="用户信息ecs_touch_user_info"></a>用户信息<code>ecs_touch_user_info</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>aite_id</td>
<td>varchar(200)</td>
<td>标识</td>
</tr>
</tbody>
</table>
<h2 id="会员表ecs-users"><a href="#会员表ecs-users" class="headerlink" title="会员表ecs_users"></a>会员表<code>ecs_users</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>会员Email</td>
</tr>
<tr>
<td>user_name</td>
<td>varchar(60)</td>
<td>用户名</td>
</tr>
<tr>
<td>password</td>
<td>varchar(32)</td>
<td>密码</td>
</tr>
<tr>
<td>question</td>
<td>varchar(255)</td>
<td>密码提问</td>
</tr>
<tr>
<td>answer</td>
<td>varchar(255)</td>
<td>答案</td>
</tr>
<tr>
<td>sex</td>
<td>tinyint(1)</td>
<td>性别，0: 保密，1: 男，2: 女</td>
</tr>
<tr>
<td>birthday</td>
<td>date NOT</td>
<td>出生日期</td>
</tr>
<tr>
<td>user_money</td>
<td>decimal(10,2)</td>
<td>用户先有资金</td>
</tr>
<tr>
<td>frozen_money</td>
<td>decimal(10,2)</td>
<td>用户冻结资金</td>
</tr>
<tr>
<td>pay_points</td>
<td>int(10)</td>
<td>消费积分</td>
</tr>
<tr>
<td>rank_points</td>
<td>int(10)</td>
<td>会员等级积分</td>
</tr>
<tr>
<td>address_id</td>
<td>mediumint(8)</td>
<td>收货信息id,表值表user_address</td>
</tr>
<tr>
<td>reg_time</td>
<td>int(10)</td>
<td>注册时间</td>
</tr>
<tr>
<td>last_login</td>
<td>int(11)</td>
<td>最后一次登录时间</td>
</tr>
<tr>
<td>last_time</td>
<td>datetime</td>
<td>应该是最后一次修改信息时间，该表信息从其他表同步过来考虑</td>
</tr>
<tr>
<td>last_ip</td>
<td>varchar(15)</td>
<td>最后一次登录IP</td>
</tr>
<tr>
<td>visit_count</td>
<td>smallint(5)</td>
<td>员登记id，取值user_rank</td>
</tr>
<tr>
<td>user_rank</td>
<td>tinyint(3)</td>
<td>会员登记id，取值user_rank</td>
</tr>
<tr>
<td>is_special</td>
<td>tinyint(3)</td>
<td>是否特殊</td>
</tr>
<tr>
<td>ec_salt</td>
<td>varchar(10)</td>
<td>加密因子</td>
</tr>
<tr>
<td>salt</td>
<td>varchar(10)</td>
<td>salt值</td>
</tr>
<tr>
<td>parent_id</td>
<td>mediumint(9)</td>
<td>推荐人会员id</td>
</tr>
<tr>
<td>flag</td>
<td>tinyint(3)</td>
<td>标识</td>
</tr>
<tr>
<td>alias</td>
<td>varchar(60)</td>
<td>昵称</td>
</tr>
<tr>
<td>msn</td>
<td>varchar(60)</td>
<td>msn账号</td>
</tr>
<tr>
<td>qq</td>
<td>varchar(20)</td>
<td>Qq账号</td>
</tr>
<tr>
<td>office_phone</td>
<td>varchar(20)</td>
<td>办公电话</td>
</tr>
<tr>
<td>home_phone</td>
<td>varchar(20)</td>
<td>家用电话</td>
</tr>
<tr>
<td>mobile_phone</td>
<td>varchar(20)</td>
<td>移动电话</td>
</tr>
<tr>
<td>is_validated</td>
<td>tinyint(3)</td>
<td>是否生效</td>
</tr>
<tr>
<td>credit_line</td>
<td>decimal(10,2)</td>
<td>最大消费</td>
</tr>
<tr>
<td>passwd_question</td>
<td>varchar(50)</td>
<td>设置密码问题</td>
</tr>
<tr>
<td>passwd_answer</td>
<td>varchar(255)</td>
<td>答案</td>
</tr>
<tr>
<td>apply_sale</td>
<td>int(1)</td>
<td>提交申请</td>
</tr>
</tbody>
</table>
<h2 id="用户资金流动表ecs-user-account"><a href="#用户资金流动表ecs-user-account" class="headerlink" title="用户资金流动表ecs_user_account"></a>用户资金流动表<code>ecs_user_account</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户登录后保存在session中的id号，跟users表中的user_id对应</td>
</tr>
<tr>
<td>admin_user</td>
<td>varchar(255)</td>
<td>操作该笔交易的管理员的用户名</td>
</tr>
<tr>
<td>amount</td>
<td>decimal(10,2)</td>
<td>资金的数目，正数为增加，负数为减少</td>
</tr>
<tr>
<td>add_time</td>
<td>int(10)</td>
<td>记录插入时间</td>
</tr>
<tr>
<td>paid_time</td>
<td>int(10)</td>
<td>记录更新时间</td>
</tr>
<tr>
<td>admin_note</td>
<td>varchar(255)</td>
<td>管理员的被准</td>
</tr>
<tr>
<td>user_note</td>
<td>varchar(255)</td>
<td>用户备注</td>
</tr>
<tr>
<td>process_type</td>
<td>tinyint(1)</td>
<td>操作类型，1，退款；0，预付费，其实就是充值</td>
</tr>
<tr>
<td>payment</td>
<td>varchar(90)</td>
<td>支付渠道的名称，取自payment的pay_name字段</td>
</tr>
<tr>
<td>is_paid</td>
<td>tinyint(1)</td>
<td>是否已经付款，０，未付；１，已付</td>
</tr>
</tbody>
</table>
<h2 id="收货人的信息列表ecs-user-address"><a href="#收货人的信息列表ecs-user-address" class="headerlink" title="收货人的信息列表ecs_user_address"></a>收货人的信息列表<code>ecs_user_address</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>address_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>address_name</td>
<td>varchar(50)</td>
<td>名称</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户ID</td>
</tr>
<tr>
<td>consignee</td>
<td>varchar(60)</td>
<td>收货人的名字</td>
</tr>
<tr>
<td>email</td>
<td>varchar(60)</td>
<td>收货人邮箱</td>
</tr>
<tr>
<td>country</td>
<td>smallint(5)</td>
<td>国家</td>
</tr>
<tr>
<td>province</td>
<td>smallint(5)</td>
<td>省份</td>
</tr>
<tr>
<td>city</td>
<td>smallint(5)</td>
<td>城市</td>
</tr>
<tr>
<td>district</td>
<td>smallint(5)</td>
<td>地区</td>
</tr>
<tr>
<td>address</td>
<td>varchar(120)</td>
<td>详细地址</td>
</tr>
<tr>
<td>zipcode</td>
<td>varchar(60)</td>
<td>邮编</td>
</tr>
<tr>
<td>tel</td>
<td>varchar(60)</td>
<td>电话</td>
</tr>
<tr>
<td>mobile</td>
<td>varchar(60)</td>
<td>手机号</td>
</tr>
<tr>
<td>sign_building</td>
<td>varchar(120)</td>
<td>收货地址的标志性建筑名</td>
</tr>
<tr>
<td>best_time</td>
<td>varchar(120)</td>
<td>收货人的最佳收货时间</td>
</tr>
</tbody>
</table>
<h2 id="已经发送的红包信息列表ecs-user-bonus"><a href="#已经发送的红包信息列表ecs-user-bonus" class="headerlink" title="已经发送的红包信息列表ecs_user_bonus"></a>已经发送的红包信息列表<code>ecs_user_bonus</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bonus_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>bonus_type_id</td>
<td>tinyint(3)</td>
<td>红包发送类型.0,按用户如会员等级,会员名称发放;1,按商品类别发送;2,按订单金额所达到的额度发送;3,线下发送</td>
</tr>
<tr>
<td>bonus_sn</td>
<td>bigint(20)</td>
<td>红包号,如果为0就是没有红包号.如果大于0,就需要输入该红包号才能使用红包</td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>该红包属于某会员的id.如果为0,就是该红包不属于某会员</td>
</tr>
<tr>
<td>used_time</td>
<td>int(10)</td>
<td>红包使用的时间</td>
</tr>
<tr>
<td>order_id</td>
<td>mediumint(8)</td>
<td>使用了该红包的交易号</td>
</tr>
<tr>
<td>emailed</td>
<td>tinyint(3)</td>
<td>否已经将红包发送到用户的邮箱；1，是；0，否</td>
</tr>
</tbody>
</table>
<h2 id="用户资料ecs-user-feed"><a href="#用户资料ecs-user-feed" class="headerlink" title="用户资料ecs_user_feed"></a>用户资料<code>ecs_user_feed</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>feed_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>user_id</td>
<td>mediumint(8)</td>
<td>用户ID</td>
</tr>
<tr>
<td>value_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>feed_type</td>
<td>tinyint(1)</td>
<td></td>
</tr>
<tr>
<td>is_feed</td>
<td>tinyint(1)</td>
</tr>
</tbody>
</table>
<h2 id="会员等级配置信息ecs-user-rank"><a href="#会员等级配置信息ecs-user-rank" class="headerlink" title="会员等级配置信息ecs_user_rank"></a>会员等级配置信息<code>ecs_user_rank</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rank_id</td>
<td>tinyint(3)</td>
<td></td>
</tr>
<tr>
<td>rank_name</td>
<td>varchar(30)</td>
<td>会员等级名称</td>
</tr>
<tr>
<td>min_points</td>
<td>int(10)</td>
<td>该等级的最低积分</td>
</tr>
<tr>
<td>max_points</td>
<td>int(10)</td>
<td>该等级的最高积分</td>
</tr>
<tr>
<td>discount</td>
<td>tinyint(3)</td>
<td>该会员等级的商品折扣</td>
</tr>
<tr>
<td>show_price</td>
<td>tinyint(1)</td>
<td>是否在不是该等级会员购买页面显示该会员等级的折扣价格.1,显示;0,不显示</td>
</tr>
<tr>
<td>special_rank</td>
<td>tinyint(1)</td>
<td>是否事特殊会员等级组.0,不是;1,是</td>
</tr>
</tbody>
</table>
<h2 id="虚拟卡卡号库ecs-virtual-card"><a href="#虚拟卡卡号库ecs-virtual-card" class="headerlink" title="虚拟卡卡号库ecs_virtual_card"></a>虚拟卡卡号库<code>ecs_virtual_card</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>card_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>该虚拟卡对应的商品id，取值于表goods</td>
</tr>
<tr>
<td>card_sn</td>
<td>varchar(60)</td>
<td>加密后的卡号</td>
</tr>
<tr>
<td>card_password</td>
<td>varchar(60)</td>
<td>加密后的密码</td>
</tr>
<tr>
<td>add_date</td>
<td>int(11)</td>
<td>卡号添加日期</td>
</tr>
<tr>
<td>end_date</td>
<td>int(11)</td>
<td>卡号截至使用日期</td>
</tr>
<tr>
<td>is_saled</td>
<td>tinyint(1)</td>
<td>是否卖出，0，否；1，是</td>
</tr>
<tr>
<td>order_sn</td>
<td>varchar(20)</td>
<td>卖出该卡号的交易号，取值表order_info</td>
</tr>
<tr>
<td>crc32</td>
<td>varchar(12)</td>
<td>crc32后的key</td>
</tr>
</tbody>
</table>
<h2 id="保存某商品的优惠价格表ecs-volume-price"><a href="#保存某商品的优惠价格表ecs-volume-price" class="headerlink" title="保存某商品的优惠价格表ecs_volume_price"></a>保存某商品的优惠价格表<code>ecs_volume_price</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>price_type</td>
<td>tinyint(1)</td>
<td>价格类型</td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品编号</td>
</tr>
<tr>
<td>volume_number</td>
<td>smallint(5)</td>
<td>价格对应的数量上下限</td>
</tr>
<tr>
<td>volume_price</td>
<td>decimal(10,2)</td>
<td>价格</td>
</tr>
</tbody>
</table>
<h2 id="网站调查信息记录表ecs-vote"><a href="#网站调查信息记录表ecs-vote" class="headerlink" title="网站调查信息记录表ecs_vote"></a>网站调查信息记录表<code>ecs_vote</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>vote_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>vote_name</td>
<td>varchar(250)</td>
<td>在线调查主题</td>
</tr>
<tr>
<td>start_time</td>
<td>int(11)</td>
<td>在线调查开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int(11)</td>
<td>在线调查结束时间</td>
</tr>
<tr>
<td>can_multi</td>
<td>tinyint(1)</td>
<td>能否多选，0，可以；1，不可以</td>
</tr>
<tr>
<td>vote_count</td>
<td>int(10)</td>
<td>投票人数也可以说投票次数</td>
</tr>
</tbody>
</table>
<h2 id="投票记录表ecs-vote-log"><a href="#投票记录表ecs-vote-log" class="headerlink" title="投票记录表ecs_vote_log"></a>投票记录表<code>ecs_vote_log</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>vote_id</td>
<td>smallint(5)</td>
<td>关联的投票主题id，取值表vote</td>
</tr>
<tr>
<td>ip_address</td>
<td>varchar(15)</td>
<td>投票的ip地址</td>
</tr>
<tr>
<td>vote_time</td>
<td>int(10)</td>
<td>投票的时间</td>
</tr>
</tbody>
</table>
<h2 id="投票的选项内容表ecs-vote-option"><a href="#投票的选项内容表ecs-vote-option" class="headerlink" title="投票的选项内容表ecs_vote_option"></a>投票的选项内容表<code>ecs_vote_option</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>option_id</td>
<td>smallint(5)</td>
<td></td>
</tr>
<tr>
<td>vote_id</td>
<td>smallint(5)</td>
<td>关联的投票主题id，取值表vote</td>
</tr>
<tr>
<td>option_name</td>
<td>varchar(250)</td>
<td>投票选项的值</td>
</tr>
<tr>
<td>option_count</td>
<td>int(8)</td>
<td>该选项的票数</td>
</tr>
<tr>
<td>option_order</td>
<td>tinyint(3)</td>
<td>选项排序</td>
</tr>
</tbody>
</table>
<h2 id="微信通表ecs-wechat"><a href="#微信通表ecs-wechat" class="headerlink" title="微信通表ecs_wechat"></a>微信通表<code>ecs_wechat</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10) unsigned</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>varchar(255)</td>
<td>公众号名称</td>
</tr>
<tr>
<td>orgid</td>
<td>varchar(255)</td>
<td>公众号原始ID</td>
</tr>
<tr>
<td>weixin</td>
<td>varchar(255)</td>
<td>微信号</td>
</tr>
<tr>
<td>token</td>
<td>varchar(255)</td>
<td>Token</td>
</tr>
<tr>
<td>appid</td>
<td>varchar(255)</td>
<td>AppID</td>
</tr>
<tr>
<td>appsecret</td>
<td>varchar(255)</td>
<td>AppSecret</td>
</tr>
<tr>
<td>type</td>
<td>int(1)</td>
<td>公众号类型</td>
</tr>
<tr>
<td>oauth_status</td>
<td>tinyint(1)</td>
<td>是否开启微信登录</td>
</tr>
<tr>
<td>oauth_name</td>
<td>varchar(100)</td>
<td>微信OAuth名称</td>
</tr>
<tr>
<td>oauth_redirecturi</td>
<td>varchar(255)</td>
<td>微信OAuth回调地址</td>
</tr>
<tr>
<td>oauth_count</td>
<td>int(11)</td>
<td>微信OAuth推送量</td>
</tr>
<tr>
<td>time</td>
<td>int(11)</td>
<td>时间</td>
</tr>
<tr>
<td>sort</td>
<td>int(10)</td>
<td>排序</td>
</tr>
<tr>
<td>status</td>
<td>int(1)</td>
<td>状态</td>
</tr>
<tr>
<td>default_wx</td>
<td>int(1)</td>
<td>1为默认使用，0为不默认</td>
</tr>
</tbody>
</table>
<h2 id="微信通自定义消息ecs-wechat-custom-message"><a href="#微信通自定义消息ecs-wechat-custom-message" class="headerlink" title="微信通自定义消息ecs_wechat_custom_message"></a>微信通自定义消息<code>ecs_wechat_custom_message</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>uid</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>msg</td>
<td>varchar(255)</td>
<td>信息内容</td>
</tr>
<tr>
<td>iswechat</td>
<td>smallint(1)</td>
<td></td>
</tr>
<tr>
<td>send_time</td>
<td>int(11)</td>
<td>发送时间</td>
</tr>
</tbody>
</table>
<h2 id="微信通扩展ecs-wechat-extend"><a href="#微信通扩展ecs-wechat-extend" class="headerlink" title="微信通扩展ecs_wechat_extend"></a>微信通扩展<code>ecs_wechat_extend</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(11)</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>varchar(100)</td>
<td>功能名称</td>
</tr>
<tr>
<td>keywords</td>
<td>varchar(20)</td>
<td>关键词</td>
</tr>
<tr>
<td>command</td>
<td>varchar(255)</td>
<td>扩展词</td>
</tr>
<tr>
<td>config</td>
<td>text</td>
<td>配置信息</td>
</tr>
<tr>
<td>type</td>
<td>varchar(20)</td>
<td>类型</td>
</tr>
<tr>
<td>enable</td>
<td>int(1)</td>
<td>是否安装，1为已安装，0未安装</td>
</tr>
<tr>
<td>author</td>
<td>varchar(100)</td>
<td>作者</td>
</tr>
<tr>
<td>website</td>
<td>varchar(100)</td>
<td>站点</td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(10)</td>
<td>公众号id</td>
</tr>
</tbody>
</table>
<h2 id="群发消息历史ecs-wechat-mass-history"><a href="#群发消息历史ecs-wechat-mass-history" class="headerlink" title="群发消息历史ecs_wechat_mass_history"></a>群发消息历史<code>ecs_wechat_mass_history</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(11)</td>
<td></td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(11)</td>
<td></td>
</tr>
<tr>
<td>media_id</td>
<td>int(11)</td>
<td>素材id</td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
<td>发送内容类型</td>
</tr>
<tr>
<td>status</td>
<td>varchar(20)</td>
<td>发送状态，对应微信通通知状态</td>
</tr>
<tr>
<td>send_time</td>
<td>int(11)</td>
<td>发送时间</td>
</tr>
<tr>
<td>msg_id</td>
<td>varchar(20)</td>
<td>微信端返回的消息ID</td>
</tr>
<tr>
<td>totalcount</td>
<td>int(10)</td>
<td>group_id下粉丝数；或者openid_list中的粉丝数</td>
</tr>
<tr>
<td>filtercount</td>
<td>int(10)</td>
<td>过滤（过滤是指特定地区、性别的过滤、用户设置拒收的过滤，用户接收已超4条的过滤）后，准备发送的粉丝数</td>
</tr>
<tr>
<td>sentcount</td>
<td>int(10)</td>
<td>发送成功的粉丝数</td>
</tr>
<tr>
<td>errorcount</td>
<td>int(10)</td>
<td>发送失败的粉丝数</td>
</tr>
</tbody>
</table>
<h2 id="微信通多媒体消息ecs-wechat-media"><a href="#微信通多媒体消息ecs-wechat-media" class="headerlink" title="微信通多媒体消息ecs_wechat_media"></a>微信通多媒体消息<code>ecs_wechat_media</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>title</td>
<td>varchar(255)</td>
<td>图文消息标题</td>
</tr>
<tr>
<td>command</td>
<td>varchar(20)</td>
<td>关键词</td>
</tr>
<tr>
<td>author</td>
<td>varchar(20)</td>
<td>作者</td>
</tr>
<tr>
<td>is_show</td>
<td>int(1)</td>
<td>是否显示封面，1为显示，0为不显示</td>
</tr>
<tr>
<td>digest</td>
<td>varchar(255)</td>
<td>图文消息的描述</td>
</tr>
<tr>
<td>content</td>
<td>text</td>
<td>图文消息页面的内容，支持HTML标签</td>
</tr>
<tr>
<td>link</td>
<td>varchar(255)</td>
<td>点击图文消息跳转链接</td>
</tr>
<tr>
<td>file</td>
<td>varchar(255)</td>
<td>图片链接</td>
</tr>
<tr>
<td>size</td>
<td>int(7)</td>
<td>媒体文件上传后，获取时的唯一标识</td>
</tr>
<tr>
<td>file_name</td>
<td>varchar(255)</td>
<td>媒体文件上传时间戳</td>
</tr>
<tr>
<td>thumb</td>
<td>varchar(255)</td>
<td>缩略图</td>
</tr>
<tr>
<td>add_time</td>
<td>int(11)</td>
<td>添加时间</td>
</tr>
<tr>
<td>edit_time</td>
<td>int(11)</td>
<td>修改时间</td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
<td>类型</td>
</tr>
<tr>
<td>article_id</td>
<td>varchar(100)</td>
<td>文章ID</td>
</tr>
<tr>
<td>sort</td>
<td>int(10)</td>
<td>排序</td>
</tr>
</tbody>
</table>
<h2 id="微信通菜单ecs-wechat-menu"><a href="#微信通菜单ecs-wechat-menu" class="headerlink" title="微信通菜单ecs_wechat_menu"></a>微信通菜单<code>ecs_wechat_menu</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>pid</td>
<td>int(3)</td>
<td>父级ID</td>
</tr>
<tr>
<td>name</td>
<td>varchar(255)</td>
<td>菜单标题</td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
<td>菜单的响应动作类型</td>
</tr>
<tr>
<td>key</td>
<td>varchar(255)</td>
<td>菜单KEY值，click类型必须</td>
</tr>
<tr>
<td>url</td>
<td>varchar(255)</td>
<td>网页链接，view类型必须</td>
</tr>
<tr>
<td>sort</td>
<td>int(10)</td>
<td>排序</td>
</tr>
<tr>
<td>status</td>
<td>int(10)</td>
<td>状态</td>
</tr>
</tbody>
</table>
<h2 id="微信通积分ecs-wechat-point"><a href="#微信通积分ecs-wechat-point" class="headerlink" title="微信通积分ecs_wechat_point"></a>微信通积分<code>ecs_wechat_point</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>log_id</td>
<td>mediumint(8)</td>
<td>积分增加记录id</td>
</tr>
<tr>
<td>openid</td>
<td>varchar(100)</td>
<td>用户的标识</td>
</tr>
<tr>
<td>keywords</td>
<td>varchar(100)</td>
<td>关键词</td>
</tr>
<tr>
<td>createtime</td>
<td>int(11)</td>
<td>创建时间</td>
</tr>
</tbody>
</table>
<h2 id="微信通奖品ecs-wechat-prize"><a href="#微信通奖品ecs-wechat-prize" class="headerlink" title="微信通奖品ecs_wechat_prize"></a>微信通奖品<code>ecs_wechat_prize</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(11)</td>
<td></td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(11)</td>
<td></td>
</tr>
<tr>
<td>openid</td>
<td>varchar(100)</td>
<td>用户的标识</td>
</tr>
<tr>
<td>prize_name</td>
<td>varchar(100)</td>
<td>奖品名称</td>
</tr>
<tr>
<td>issue_status</td>
<td>int(2)</td>
<td>发放状态，0未发放，1发放</td>
</tr>
<tr>
<td>winner</td>
<td>varchar(255)</td>
<td>赢家数据</td>
</tr>
<tr>
<td>dateline</td>
<td>int(11)</td>
<td>日期</td>
</tr>
<tr>
<td>prize_type</td>
<td>int(1)</td>
<td>是否中奖，0未中奖，1中奖</td>
</tr>
<tr>
<td>activity_type</td>
<td>varchar(20)</td>
<td>活动类型</td>
</tr>
</tbody>
</table>
<h2 id="微信通二维码ecs-wechat-qrcode"><a href="#微信通二维码ecs-wechat-qrcode" class="headerlink" title="微信通二维码ecs_wechat_qrcode"></a>微信通二维码<code>ecs_wechat_qrcode</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>int(1)</td>
<td>二维码类型，0临时，1永久</td>
</tr>
<tr>
<td>expire_seconds</td>
<td>int(4)</td>
<td>二维码有效时间</td>
</tr>
<tr>
<td>scene_id</td>
<td>int(10)</td>
<td>场景值ID，临时二维码时为32位非0整型，永久二维码时最大值为100000（目前参数只支持1–100000）</td>
</tr>
<tr>
<td>username</td>
<td>varchar(60)</td>
<td>推荐人</td>
</tr>
<tr>
<td>function</td>
<td>varchar(255)</td>
<td>功能</td>
</tr>
<tr>
<td>ticket</td>
<td>varchar(255)</td>
<td>二维码ticket</td>
</tr>
<tr>
<td>qrcode_url</td>
<td>varchar(255)</td>
<td>二维码路径</td>
</tr>
<tr>
<td>endtime</td>
<td>int(11)</td>
<td>结束时间</td>
</tr>
<tr>
<td>scan_num</td>
<td>int(10)</td>
<td>扫描量</td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>status</td>
<td>int(1)</td>
<td>状态</td>
</tr>
<tr>
<td>sort</td>
<td>int(10)</td>
<td>排序</td>
</tr>
</tbody>
</table>
<h2 id="微信通回复ecs-wechat-reply"><a href="#微信通回复ecs-wechat-reply" class="headerlink" title="微信通回复ecs_wechat_reply"></a>微信通回复<code>ecs_wechat_reply</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(11)</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>varchar(10)</td>
<td>自动回复类型</td>
</tr>
<tr>
<td>content</td>
<td>varchar(255)</td>
<td>内容</td>
</tr>
<tr>
<td>media_id</td>
<td>int(10)</td>
<td>多媒体id</td>
</tr>
<tr>
<td>rule_name</td>
<td>varchar(180)</td>
<td>规则名称</td>
</tr>
<tr>
<td>add_time</td>
<td>int(11)</td>
<td>添加时间</td>
</tr>
<tr>
<td>reply_type</td>
<td>varchar(10)</td>
<td>关键词回复内容的类型</td>
</tr>
</tbody>
</table>
<h2 id="微信通规则关键字ecs-wechat-rule-keywords"><a href="#微信通规则关键字ecs-wechat-rule-keywords" class="headerlink" title="微信通规则关键字ecs_wechat_rule_keywords"></a>微信通规则关键字<code>ecs_wechat_rule_keywords</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(11)</td>
<td></td>
</tr>
<tr>
<td>rid</td>
<td>int(11)</td>
<td>规则id</td>
</tr>
<tr>
<td>rule_keywords</td>
<td>varchar(255)</td>
<td>规则关键字</td>
</tr>
</tbody>
</table>
<h2 id="微信通模版ecs-wechat-template"><a href="#微信通模版ecs-wechat-template" class="headerlink" title="微信通模版ecs_wechat_template"></a>微信通模版<code>ecs_wechat_template</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(11)</td>
<td></td>
</tr>
<tr>
<td>open_id</td>
<td>varchar(255)</td>
<td>用户的标识</td>
</tr>
<tr>
<td>template_id</td>
<td>varchar(255)</td>
<td>模版ID</td>
</tr>
<tr>
<td>contents</td>
<td>varchar(133)</td>
<td>模版内容</td>
</tr>
<tr>
<td>template</td>
<td>text</td>
<td>模版</td>
</tr>
<tr>
<td>title</td>
<td>varchar(33)</td>
<td>标题</td>
</tr>
<tr>
<td>add_time</td>
<td>int(11)</td>
<td>添加时间</td>
</tr>
<tr>
<td>switch</td>
<td>tinyint(2)</td>
</tr>
</tbody>
</table>
<h2 id="微信通用户ecs-wechat-user"><a href="#微信通用户ecs-wechat-user" class="headerlink" title="微信通用户ecs_wechat_user"></a>微信通用户<code>ecs_wechat_user</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>uid</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>subscribe</td>
<td>tinyint(1)</td>
<td>用户是否订阅该公众号标识</td>
</tr>
<tr>
<td>openid</td>
<td>varchar(255)</td>
<td>用户的标识</td>
</tr>
<tr>
<td>nickname</td>
<td>varchar(255)</td>
<td>用户的昵称</td>
</tr>
<tr>
<td>sex</td>
<td>tinyint(1)</td>
<td>用户的性别</td>
</tr>
<tr>
<td>city</td>
<td>varchar(255)</td>
<td>用户所在城市</td>
</tr>
<tr>
<td>country</td>
<td>varchar(255)</td>
<td>用户所在国家</td>
</tr>
<tr>
<td>province</td>
<td>varchar(255)</td>
<td>用户所在省份</td>
</tr>
<tr>
<td>language</td>
<td>varchar(50)</td>
<td>用户的语言</td>
</tr>
<tr>
<td>headimgurl</td>
<td>varchar(255)</td>
<td>用户头像</td>
</tr>
<tr>
<td>subscribe_time</td>
<td>int(11)</td>
<td>用户关注时间</td>
</tr>
<tr>
<td>remark</td>
<td>varchar(255)</td>
<td>备注</td>
</tr>
<tr>
<td>privilege</td>
<td>varchar(255)</td>
<td>权限</td>
</tr>
<tr>
<td>unionid</td>
<td>varchar(255)</td>
<td>只有在用户将公众号绑定到微信开放平台账号后，查看公众号是否绑定</td>
</tr>
<tr>
<td>group_id</td>
<td>int(11)</td>
<td>用户组id</td>
</tr>
<tr>
<td>ect_uid</td>
<td>int(11)</td>
<td>ecshop会员id</td>
</tr>
<tr>
<td>bein_kefu</td>
<td>tinyint(1)</td>
<td>是否处在多客服流程</td>
</tr>
<tr>
<td>isbind</td>
<td>tinyint(1)</td>
<td>是否绑定过</td>
</tr>
</tbody>
</table>
<h2 id="微信通用户组ecs-wechat-user-group"><a href="#微信通用户组ecs-wechat-user-group" class="headerlink" title="微信通用户组ecs_wechat_user_group"></a>微信通用户组<code>ecs_wechat_user_group</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>wechat_id</td>
<td>int(10)</td>
<td></td>
</tr>
<tr>
<td>group_id</td>
<td>int(10)</td>
<td>分组id</td>
</tr>
<tr>
<td>name</td>
<td>varchar(255)</td>
<td>分组名字，UTF8编码</td>
</tr>
<tr>
<td>count</td>
<td>int(10)</td>
<td>分组内用户数量</td>
</tr>
<tr>
<td>sort</td>
<td>int(10)</td>
<td>排序</td>
</tr>
</tbody>
</table>
<h2 id="批发方案表ecs-wholesale"><a href="#批发方案表ecs-wholesale" class="headerlink" title="批发方案表ecs_wholesale"></a>批发方案表<code>ecs_wholesale</code></h2><table>
<thead>
<tr>
<th>字段名称</th>
<th>字段类型</th>
<th>字段说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>act_id</td>
<td>mediumint(8)</td>
<td></td>
</tr>
<tr>
<td>goods_id</td>
<td>mediumint(8)</td>
<td>商品ID</td>
</tr>
<tr>
<td>goods_name</td>
<td>varchar(255)</td>
<td>商品名称</td>
</tr>
<tr>
<td>rank_ids</td>
<td>varchar(255)</td>
<td>适用会员登记,多个值之间用逗号分隔取值于user_rank</td>
</tr>
<tr>
<td>prices</td>
<td>text</td>
<td>序列化后的商品属性,数量,价格</td>
</tr>
<tr>
<td>enabled</td>
<td>tinyint(3)</td>
<td>批发方案是否可用</td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Ectouch2-0-数据库结构&quot;&gt;&lt;a href=&quot;#Ectouch2-0-数据库结构&quot; class=&quot;headerlink&quot; title=&quot;Ectouch2.0 数据库结构&quot;&gt;&lt;/a&gt;Ectouch2.0 数据库结构&lt;/h1&gt;&lt;h2 id=&quot;用户账目日志表ecs-account-log&quot;&gt;&lt;a href=&quot;#用户账目日志表ecs-account-log&quot; class=&quot;headerlink&quot; title=&quot;用户账目日志表ecs_account_log&quot;&gt;&lt;/a&gt;用户账目日志表&lt;code&gt;ecs_account_log&lt;/code&gt;&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段名称&lt;/th&gt;
&lt;th&gt;字段类型&lt;/th&gt;
&lt;th&gt;字段说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;log_id&lt;/td&gt;
&lt;td&gt;mediumint(8)&lt;/td&gt;
&lt;td&gt;日志ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;user_id&lt;/td&gt;
&lt;td&gt;mediumint(8)&lt;/td&gt;
&lt;td&gt;用户ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;user_money&lt;/td&gt;
&lt;td&gt;decimal(10,2)&lt;/td&gt;
&lt;td&gt;用户该笔记录的余额&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;frozen_money&lt;/td&gt;
&lt;td&gt;decimal(10,2)&lt;/td&gt;
&lt;td&gt;被冻结的资金&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;rank_points&lt;/td&gt;
&lt;td&gt;mediumint(9)&lt;/td&gt;
&lt;td&gt;等级积分，跟消费积分是分开的&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;pay_points&lt;/td&gt;
&lt;td&gt;mediumint(9)&lt;/td&gt;
&lt;td&gt;消费积分，跟等级积分是分开的&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;change_time&lt;/td&gt;
&lt;td&gt;int(10)&lt;/td&gt;
&lt;td&gt;该笔操作发生的事件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;change_desc&lt;/td&gt;
&lt;td&gt;varchar(255)&lt;/td&gt;
&lt;td&gt;该笔操作的备注&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;change_type&lt;/td&gt;
&lt;td&gt;tinyint(3)&lt;/td&gt;
&lt;td&gt;操作类型，0: 充值，1: 提现，2: 管理员调节，99: 其它类型&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    
    </summary>
    
      <category term="ectouch" scheme="http://blog.golearns.org/categories/ectouch/"/>
    
    
      <category term="ecshop" scheme="http://blog.golearns.org/tags/ecshop/"/>
    
      <category term="ectouch" scheme="http://blog.golearns.org/tags/ectouch/"/>
    
      <category term="ectouch数据库字典" scheme="http://blog.golearns.org/tags/ectouch%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%97%E5%85%B8/"/>
    
  </entry>
  
  <entry>
    <title>mysql嵌套集模型</title>
    <link href="http://blog.golearns.org/2016/07/19/MySQL-%E5%B5%8C%E5%A5%97%E9%9B%86%E6%A8%A1%E5%9E%8B/"/>
    <id>http://blog.golearns.org/2016/07/19/MySQL-嵌套集模型/</id>
    <published>2016-07-19T10:38:03.000Z</published>
    <updated>2016-07-19T10:42:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="嵌套集模型"><a href="#嵌套集模型" class="headerlink" title="嵌套集模型"></a>嵌套集模型</h1><h2 id="在分类表中，通过左和右值来代表我们的嵌套节点。"><a href="#在分类表中，通过左和右值来代表我们的嵌套节点。" class="headerlink" title="在分类表中，通过左和右值来代表我们的嵌套节点。"></a>在分类表中，通过左和右值来代表我们的嵌套节点。</h2><ul>
<li><p>创建表并添加测试数据</p>
<pre><code>CREATE TABLE category (
    category_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(20) NOT NULL,
    lft INT NOT NULL,
    rgt INT NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO category VALUES
                            (1,&apos;ELECTRONICS&apos;,1,20),
                            (2,&apos;TELEVISIONS&apos;,2,9),
                            (3,&apos;TUBE&apos;,3,4),
                            (4,&apos;LCD&apos;,5,6),
                            (5,&apos;PLASMA&apos;,7,8),
                            (6,&apos;PORTABLE ELECTRONICS&apos;,10,19),
                            (7,&apos;MP3 PLAYERS&apos;,11,14),
                            (8,&apos;FLASH&apos;,12,13),
                            (9,&apos;CD PLAYERS&apos;,15,16),
                            (10,&apos;2 WAY RADIOS&apos;,17,18);

MariaDB [work]&gt; select * from category;
+-------------+----------------------+-----+-----+
| category_id | name                 | lft | rgt |
+-------------+----------------------+-----+-----+
|           1 | ELECTRONICS          |   1 |  20 |
|           2 | TELEVISIONS          |   2 |   9 |
|           3 | TUBE                 |   3 |   4 |
|           4 | LCD                  |   5 |   6 |
|           5 | PLASMA               |   7 |   8 |
|           6 | PORTABLE ELECTRONICS |  10 |  19 |
|           7 | MP3 PLAYERS          |  11 |  14 |
|           8 | FLASH                |  12 |  13 |
|           9 | CD PLAYERS           |  15 |  16 |
|          10 | 2 WAY RADIOS         |  17 |  18 |
+-------------+----------------------+-----+-----+
</code></pre><a id="more"></a></li>
<li>如何确定左边和右边的值，我们在外部节点的最左侧和右侧开始编号
<img src="http://7xj3i5.com1.z0.glb.clouddn.com/start.png" alt="start.png"></li>
<li>这种设计可用于典型的树
<img src="http://7xj3i5.com1.z0.glb.clouddn.com/design.png" alt="design.png"></li>
<li>当树在工作的时候，我们从左到右一层一层将右边的数字一次分配给子节点。这种方法被称为<strong>改进的前序遍历树算法</strong></li>
</ul>
<h1 id="检索一个完整的树"><a href="#检索一个完整的树" class="headerlink" title="检索一个完整的树"></a>检索一个完整的树</h1><ul>
<li><p>我们可以通过使用自链接检索一个完整的树节点在父节点lft和rgt之前的节点</p>
<pre><code>SELECT node.name FROM category AS node, category AS parent
    WHERE node.lft BETWEEN parent.lft AND parent.rgt
    AND parent.name = &apos;ELECTRONICS&apos; ORDER BY node.lft;

+----------------------+
| name                 |
+----------------------+
| ELECTRONICS          |
| TELEVISIONS          |
| TUBE                 |
| LCD                  |
| PLASMA               |
| PORTABLE ELECTRONICS |
| MP3 PLAYERS          |
| FLASH                |
| CD PLAYERS           |
| 2 WAY RADIOS         |
+----------------------+
</code></pre><h1 id="查找所有的叶子节点"><a href="#查找所有的叶子节点" class="headerlink" title="查找所有的叶子节点"></a>查找所有的叶子节点</h1></li>
<li><p>查看<code>category</code>表会发现叶节点的左、右值是连续的数字。为了查找叶节点通过使用<code>rgt = lft + 1</code></p>
<pre><code>select name from category where rgt = lft + 1;

+--------------+
| name         |
+--------------+
| TUBE         |
| LCD          |
| PLASMA       |
| FLASH        |
| CD PLAYERS   |
| 2 WAY RADIOS |
+--------------+
</code></pre><h1 id="检索单个路径"><a href="#检索单个路径" class="headerlink" title="检索单个路径"></a>检索单个路径</h1><pre><code>select parent.name from category as node, category as parent where 
    node.lft between parent.lft and parent.rgt and node.name = &apos;FLASH&apos; order
    by parent.lft;

+----------------------+
| name                 |
+----------------------+
| ELECTRONICS          |
| PORTABLE ELECTRONICS |
| MP3 PLAYERS          |
| FLASH                |
+----------------------+
</code></pre><h1 id="查找所有节点的深度"><a href="#查找所有节点的深度" class="headerlink" title="查找所有节点的深度"></a>查找所有节点的深度</h1></li>
<li><p>我们已经看过如何显示整个目录树，但是如果想显示树中每个节点的深度，以便更好的确定每个节点的层次结构。可以通过<code>Count</code>函数和<code>Group by</code>子句添加到我们现有的查询语句中</p>
<pre><code>select node.name, (count(parent.name) - 1) as depth from category as node,
    category as parent where node.lft between parent.lft and parent.rgt group
    by node.name order by node.lft;

+----------------------+-------+
| name                 | depth |
+----------------------+-------+
| ELECTRONICS          |     0 |
| TELEVISIONS          |     1 |
| TUBE                 |     2 |
| LCD                  |     2 |
| PLASMA               |     2 |
| PORTABLE ELECTRONICS |     1 |
| MP3 PLAYERS          |     2 |
| FLASH                |     3 |
| CD PLAYERS           |     2 |
| 2 WAY RADIOS         |     2 |
+----------------------+-------+
</code></pre></li>
<li><p>我们可以使用<code>depth</code>和<code>Concat</code>来缩紧我们的类别名称</p>
<pre><code>select concat(repeat(&apos;          &apos;, count(parent.name) - 1), node.name) as
    name from category as node, category as parent where node.lft between
    parent.lft and parent.rgt group by node.name order by node.lft;

+-------------------------------------+
| name                                |
+-------------------------------------+
| ELECTRONICS                         |
|           TELEVISIONS               |
|                     TUBE            |
|                     LCD             |
|                     PLASMA          |
|           PORTABLE ELECTRONICS      |
|                     MP3 PLAYERS     |
|                               FLASH |
|                     CD PLAYERS      |
|                     2 WAY RADIOS    |
+-------------------------------------+
</code></pre><h1 id="子树的深度"><a href="#子树的深度" class="headerlink" title="子树的深度"></a>子树的深度</h1></li>
<li><p>当我们需要一个子树的深度信息，我们添加第三个自链接，以及子查询来查找子树的深度</p>
<pre><code>select node.name, (count(parent.name) - (sub_tree.depth + 1)) as depth from
    category as node, category as parent, category as sub_parent, 
(
    select node.name, (count(parent.name) - 1) as depth from category as
    node, category as parent where node.lft between parent.lft and
    parent.rgt and node.name = &apos;PORTABLE ELECTRONICS&apos; group by node.name
    order by node.lft
) as sub_tree
    where node.lft between parent.lft and parent.rgt and node.lft
    between sub_parent.lft and sub_parent.rgt and sub_parent.name =
    sub_tree.name group by node.name order by node.lft;

+----------------------+-------+
| name                 | depth |
+----------------------+-------+
| PORTABLE ELECTRONICS |     0 |
| MP3 PLAYERS          |     1 |
| FLASH                |     2 |
| CD PLAYERS           |     1 |
| 2 WAY RADIOS         |     1 |
+----------------------+-------+
</code></pre><h1 id="查找一个节点的直接下属"><a href="#查找一个节点的直接下属" class="headerlink" title="查找一个节点的直接下属"></a>查找一个节点的直接下属</h1></li>
<li><p>这可以很容易的将<code>Having</code>子句加入之前的查询语句中</p>
<pre><code>select node.name, (count(parent.name) - (sub_tree.depth + 1)) as depth from
    category as node, category as parent, category as sub_parent, 
(
    select node.name, (count(parent.name) - 1) as depth from category as
    node,category as parent where node.lft between parent.lft and parent.rgt
    and node.name = &apos;PORTABLE ELECTRONICS&apos; group by node.name order by
    node.lft
) as sub_tree 
    where node.lft between parent.lft and parent.rgt
    and node.lft between sub_parent.lft and sub_parent.rgt and
    sub_parent.name = sub_tree.name group by node.name having depth &lt;= 1
    order by node.lft;

+----------------------+-------+
| name                 | depth |
+----------------------+-------+
| PORTABLE ELECTRONICS |     0 |
| MP3 PLAYERS          |     1 |
| CD PLAYERS           |     1 |
| 2 WAY RADIOS         |     1 |
+----------------------+-------+
</code></pre></li>
<li>如果不想显示父节点，将<code>having depth &lt;= 1</code>修改为<code>having depth = 1</code><h1 id="嵌套集合中中的聚合函数"><a href="#嵌套集合中中的聚合函数" class="headerlink" title="嵌套集合中中的聚合函数"></a>嵌套集合中中的聚合函数</h1></li>
<li><p>添加一个产品表</p>
<pre><code>CREATE TABLE `product` (
  `product_id` int(11) AUTO_INCREMENT PRIMARY KEY,
  `name` varchar(40) NOT NULL,
  `category_id` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO product(name, category_id) VALUES
                                               (&apos;20&quot; TV&apos;,3),
                                               (&apos;36&quot; TV&apos;,3),
                                               (&apos;Super-LCD 42&quot;&apos;,4),
                                               (&apos;Ultra-Plasma 62&quot;&apos;,5),
                                               (&apos;Value Plasma 38&quot;&apos;,5),
                                               (&apos;Power-MP3 5gb&apos;,7),
                                               (&apos;Super-Player 1gb&apos;,8),
                                               (&apos;Porta CD&apos;,9),
                                               (&apos;CD To go!&apos;,9),
                                               (&apos;Family Talk 360&apos;,10);

MariaDB [work]&gt; select * from product;
+------------+------------------+-------------+
| product_id | name             | category_id |
+------------+------------------+-------------+
|          1 | 20&quot; TV           |           3 |
|          2 | 36&quot; TV           |           3 |
|          3 | Super-LCD 42&quot;    |           4 |
|          4 | Ultra-Plasma 62&quot; |           5 |
|          5 | Value Plasma 38&quot; |           5 |
|          6 | Power-MP3 5gb    |           7 |
|          7 | Super-Player 1gb |           8 |
|          8 | Porta CD         |           9 |
|          9 | CD To go!        |           9 |
|         10 | Family Talk 360  |          10 |
+------------+------------------+-------------+
</code></pre></li>
<li><p>现在检索<code>category</code>树和每个产品类别的数量</p>
<pre><code>select parent.name, count(product.name) from category as node, category as
    parent, product where node.lft between parent.lft and parent.rgt and
    node.category_id = product.category_id group by parent.name order by
    node.lft;

+----------------------+---------------------+
| name                 | count(product.name) |
+----------------------+---------------------+
| ELECTRONICS          |                  10 |
| TELEVISIONS          |                   5 |
| TUBE                 |                   2 |
| LCD                  |                   1 |
| PLASMA               |                   2 |
| PORTABLE ELECTRONICS |                   5 |
| MP3 PLAYERS          |                   2 |
| FLASH                |                   1 |
| CD PLAYERS           |                   2 |
| 2 WAY RADIOS         |                   1 |
+----------------------+---------------------+
</code></pre><h1 id="添加一个新节点"><a href="#添加一个新节点" class="headerlink" title="添加一个新节点"></a>添加一个新节点</h1></li>
<li>添加一个新节点更新我们的树，再看看嵌套关系图
<img src="http://7xj3i5.com1.z0.glb.clouddn.com/newNode.png" alt="newnode"></li>
<li><p>如果我们想添加一个在<code>TELEVISIONS</code>和<code>PORTABLE ELECTRONICS</code>节点的新节点，这个新节点的<code>lft</code>和<code>rgt</code>值就是10和11，并且其右侧的所有节点将自己的<code>lft</code>和<code>rgt</code>值+2。然后我们用合适的<code>lft</code>和<code>rgt</code>值添加新节点</p>
<pre><code>MariaDB [work]&gt; DELIMITER //
MariaDB [work]&gt; create procedure addNodes(findName varchar(20) charset utf8, newName varchar(20) charset utf8)
    -&gt; begin
    -&gt; select @myRight := rgt from category where name = findName;
    -&gt; update category set rgt = rgt + 2 where rgt &gt; @myRight;
    -&gt; update category set lft = lft + 2 where lft &gt; @myRight;
    -&gt; insert into category(name, lft, rgt) values(newName, @myRight + 1, @myRight + 2);
    -&gt; end;
    -&gt; //
Query OK, 0 rows affected (0.02 sec)

MariaDB [work]&gt; delimiter ;
</code></pre></li>
<li><p>然后使用缩进树查询</p>
<pre><code>select concat(repeat(&apos;          &apos;, count(parent.name) - 1), node.name) as
    name from category as node, category as parent where node.lft between
    parent.lft and parent.rgt group by node.name order by node.lft;

+-------------------------------------+
| name                                |
+-------------------------------------+
| ELECTRONICS                         |
|           TELEVISIONS               |
|                     TUBE            |
|                     LCD             |
|                     PLASMA          |
|           GAME CONSOLES             |
|           PORTABLE ELECTRONICS      |
|                     MP3 PLAYERS     |
|                               FLASH |
|                     CD PLAYERS      |
|                     2 WAY RADIOS    |
+-------------------------------------+
</code></pre></li>
<li><p>如果我们想要将节点添加为没有子节点的子节点，需要做些修改</p>
<pre><code>MariaDB [work]&gt; DELIMITER //
MariaDB [work]&gt; create procedure noChildNodes(findName varchar(20) charset utf8, newName varchar(20) charset utf8)
    -&gt; begin
    -&gt; select @myLeft := lft from category where name = findName;
    -&gt; update category set rgt = rgt + 2 where rgt &gt; @myLeft;
    -&gt; update category set lft = lft + 2 where lft &gt; @myLeft;
    -&gt; insert into category(name, lft, rgt) values(newName, @myLeft + 1, @myLeft + 2);
    -&gt; end;
    -&gt; //
Query OK, 0 rows affected (0.03 sec)

MariaDB [work]&gt; DELIMITER ;
</code></pre></li>
<li><p>使用缩进树查询</p>
<pre><code>+-------------------------------------+
| name                                |
+-------------------------------------+
| ELECTRONICS                         |
|           TELEVISIONS               |
|                     TUBE            |
|                     LCD             |
|                     PLASMA          |
|           GAME CONSOLES             |
|           PORTABLE ELECTRONICS      |
|                     MP3 PLAYERS     |
|                               FLASH |
|                     CD PLAYERS      |
|                     2 WAY RADIOS    |
|                               FRS   |
+-------------------------------------+
</code></pre><h1 id="删除节点"><a href="#删除节点" class="headerlink" title="删除节点"></a>删除节点</h1></li>
<li><p>删除一个节点取决于节点在层次结构中的位置，很容易删除节点和子节点。</p>
<pre><code>MariaDB [work]&gt; DELIMITER //
MariaDB [work]&gt; create procedure delNodes(findName varchar(20) charset utf8)
    -&gt; begin
    -&gt; select @myLeft := lft, @myRight := rgt, @myWidth := rgt - lft + 1 from category where name = findName;
    -&gt; delete from category where lft between @myLeft and @myRight;
    -&gt; update category set rgt = rgt - @myWidth where rgt &gt; @myRight;
    -&gt; update category set lft = lft - @myWidth where lft &gt; @myRight;
    -&gt; end;
    -&gt; //
Query OK, 0 rows affected (0.03 sec)

MariaDB [work]&gt; DELIMITER ;
</code></pre></li>
<li><p>使用缩进树查询</p>
<pre><code>+-------------------------------------+
| name                                |
+-------------------------------------+
| ELECTRONICS                         |
|           TELEVISIONS               |
|                     TUBE            |
|                     LCD             |
|                     PLASMA          |
|           PORTABLE ELECTRONICS      |
|                     MP3 PLAYERS     |
|                               FLASH |
|                     CD PLAYERS      |
|                     2 WAY RADIOS    |
|                               FRS   |
+-------------------------------------+
</code></pre></li>
<li><p>我们必须处理一种情况删除父节点，但不删除子节点。子节点应该转向已删除的父级别</p>
<pre><code>MariaDB [work]&gt; DELIMITER //
MariaDB [work]&gt; create procedure delParentNodes(findName varchar(20) charset utf8)
    -&gt; begin
    -&gt; select @myLeft := lft, @myRight := rgt, @myWidth := rgt - lft + 1 from category where name = findName;
    -&gt; delete from category where lft = @myLeft;
    -&gt; update category set rgt = rgt - 1, lft = lft - 1 where lft between @myLeft and @myRight;
    -&gt; update category set rgt = rgt - 2 where rgt &gt; @myRight;
    -&gt; update category set lft = lft - 2 where lft &gt; @myRight;
    -&gt; end;
    -&gt; //
Query OK, 0 rows affected (0.03 sec)

MariaDB [work]&gt; DELIMITER ;
</code></pre></li>
<li><p>使用缩进树查询</p>
<pre><code>+----------------------------+
| name                       |
+----------------------------+
| ELECTRONICS                |
|           TELEVISIONS      |
|                     TUBE   |
|                     LCD    |
|                     PLASMA |
|           MP3 PLAYERS      |
|                     FLASH  |
|           CD PLAYERS       |
|           2 WAY RADIOS     |
|                     FRS    |
+----------------------------+
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;嵌套集模型&quot;&gt;&lt;a href=&quot;#嵌套集模型&quot; class=&quot;headerlink&quot; title=&quot;嵌套集模型&quot;&gt;&lt;/a&gt;嵌套集模型&lt;/h1&gt;&lt;h2 id=&quot;在分类表中，通过左和右值来代表我们的嵌套节点。&quot;&gt;&lt;a href=&quot;#在分类表中，通过左和右值来代表我们的嵌套节点。&quot; class=&quot;headerlink&quot; title=&quot;在分类表中，通过左和右值来代表我们的嵌套节点。&quot;&gt;&lt;/a&gt;在分类表中，通过左和右值来代表我们的嵌套节点。&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;创建表并添加测试数据&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CREATE TABLE category (
    category_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(20) NOT NULL,
    lft INT NOT NULL,
    rgt INT NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO category VALUES
                            (1,&amp;apos;ELECTRONICS&amp;apos;,1,20),
                            (2,&amp;apos;TELEVISIONS&amp;apos;,2,9),
                            (3,&amp;apos;TUBE&amp;apos;,3,4),
                            (4,&amp;apos;LCD&amp;apos;,5,6),
                            (5,&amp;apos;PLASMA&amp;apos;,7,8),
                            (6,&amp;apos;PORTABLE ELECTRONICS&amp;apos;,10,19),
                            (7,&amp;apos;MP3 PLAYERS&amp;apos;,11,14),
                            (8,&amp;apos;FLASH&amp;apos;,12,13),
                            (9,&amp;apos;CD PLAYERS&amp;apos;,15,16),
                            (10,&amp;apos;2 WAY RADIOS&amp;apos;,17,18);

MariaDB [work]&amp;gt; select * from category;
+-------------+----------------------+-----+-----+
| category_id | name                 | lft | rgt |
+-------------+----------------------+-----+-----+
|           1 | ELECTRONICS          |   1 |  20 |
|           2 | TELEVISIONS          |   2 |   9 |
|           3 | TUBE                 |   3 |   4 |
|           4 | LCD                  |   5 |   6 |
|           5 | PLASMA               |   7 |   8 |
|           6 | PORTABLE ELECTRONICS |  10 |  19 |
|           7 | MP3 PLAYERS          |  11 |  14 |
|           8 | FLASH                |  12 |  13 |
|           9 | CD PLAYERS           |  15 |  16 |
|          10 | 2 WAY RADIOS         |  17 |  18 |
+-------------+----------------------+-----+-----+
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="MySQL" scheme="http://blog.golearns.org/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://blog.golearns.org/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>nuclide编辑器安装</title>
    <link href="http://blog.golearns.org/2016/07/15/nuclide%E7%BC%96%E8%BE%91%E5%99%A8%E5%AE%89%E8%A3%85/"/>
    <id>http://blog.golearns.org/2016/07/15/nuclide编辑器安装/</id>
    <published>2016-07-15T09:13:50.000Z</published>
    <updated>2016-07-15T09:15:05.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="nuclide编辑器安装"><a href="#nuclide编辑器安装" class="headerlink" title="nuclide编辑器安装"></a>nuclide编辑器安装</h1><ul>
<li>nuclide是基于atom构建的开发环境</li>
<li><p><code>install atom</code></p>
<pre><code>brew install Caskroom/cask/atom
</code></pre></li>
<li><p><code>install nuclide</code></p>
<pre><code>apm install nuclide
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;nuclide编辑器安装&quot;&gt;&lt;a href=&quot;#nuclide编辑器安装&quot; class=&quot;headerlink&quot; title=&quot;nuclide编辑器安装&quot;&gt;&lt;/a&gt;nuclide编辑器安装&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;nuclide是基于atom构建的开发环境&lt;/l
    
    </summary>
    
      <category term="React-native" scheme="http://blog.golearns.org/categories/React-native/"/>
    
    
      <category term="React-native" scheme="http://blog.golearns.org/tags/React-native/"/>
    
      <category term="nuclide" scheme="http://blog.golearns.org/tags/nuclide/"/>
    
  </entry>
  
  <entry>
    <title>Elasticasearch安装和使用</title>
    <link href="http://blog.golearns.org/2016/07/15/Elasticasearch%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
    <id>http://blog.golearns.org/2016/07/15/Elasticasearch安装和使用/</id>
    <published>2016-07-15T02:00:43.000Z</published>
    <updated>2016-07-15T02:27:33.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Elasticasearch安装和使用"><a href="#Elasticasearch安装和使用" class="headerlink" title="Elasticasearch安装和使用"></a>Elasticasearch安装和使用</h1><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><ul>
<li><a href="https://download.elasticsearch.org/elasticsearch/release/org/elasticsearch/distribution/zip/elasticsearch/2.2.0/elasticsearch-2.2.0.zip" target="_blank" rel="external">download</a></li>
<li><code>unzip elasticsearch-2.2.0.zip</code></li>
</ul>
<h2 id="config"><a href="#config" class="headerlink" title="config"></a>config</h2><pre><code>vim config/elasticsearch.yml

path.data: app_data
path.logs: app_logs
network.host: 0.0.0.0
</code></pre><h2 id="install-Marvel-agent-plugin"><a href="#install-Marvel-agent-plugin" class="headerlink" title="install Marvel agent plugin"></a>install Marvel agent plugin</h2><pre><code>bin/plugin install licens
bin/plugin install marvel-agent
</code></pre><a id="more"></a>    
<h2 id="cluster"><a href="#cluster" class="headerlink" title="cluster"></a>cluster</h2><pre><code>cluster.name: booksearch
path.data: app_data
path.logs: app_logs
network.host: 0.0.0.0
</code></pre><h2 id="start-elasticsearch"><a href="#start-elasticsearch" class="headerlink" title="start elasticsearch"></a>start elasticsearch</h2><pre><code>bin/elasticsearch

||

ES_HEAP_SIZE=256m; bin/elasticsearch

|| 守护进程模式运行

bin/elasticsearch -d
</code></pre><h2 id="install-kibana"><a href="#install-kibana" class="headerlink" title="install kibana"></a>install kibana</h2><pre><code>wget https://download.elastic.co/kibana/kibana/kibana-4.4.1-linux-x64.tar.gz
tar xzvf kibana-4.4.1-linux-x64.tar.gz
cd kibana-4.4.1-linux-x64
bin/kibana plugin --install elasticsearch/marvel/latest

# 修改配置文件
vim config/kibana.yml
elasticsearch.url: &quot;http://localhost:9200&quot;

# 启动
bin/kibana
</code></pre><h2 id="关闭监控"><a href="#关闭监控" class="headerlink" title="关闭监控"></a>关闭监控</h2><pre><code>vim config/elasticsearch.yml
marvel.agent.enabled: false
</code></pre><h2 id="create-an-index"><a href="#create-an-index" class="headerlink" title="create an index"></a>create an index</h2><ul>
<li><p>创建一个名为customer的索引</p>
<pre><code>curl -XPUT localhost:9200/customer?pretty
</code></pre></li>
<li><p>显示所有的索引信息 </p>
<pre><code>curl localhost:9200/_cat/indices?v
</code></pre></li>
<li><p>添加一个文档</p>
<pre><code>curl -XPUT &apos;localhost:9200/customer/external/1?pretty&apos; -d &apos;{&quot;name&quot;: &quot;John Doe&quot;}&apos;
</code></pre></li>
<li><p>获取</p>
<pre><code>curl -XGET localhost:9200/customer/external/1?pretty
</code></pre></li>
<li><p>删除一个索引</p>
<pre><code>curl -XDELETE localhost:9200/customer?pretty
</code></pre></li>
<li><p>更新文档</p>
<pre><code>curl -XPOST localhost:9200/customer/external/1/_update?pretty -d &apos;{&quot;doc&quot;: {&quot;name&quot;: &quot;Jane doe&quot;}}&apos;
</code></pre></li>
</ul>
<h2 id="详细的文档操作"><a href="#详细的文档操作" class="headerlink" title="详细的文档操作"></a>详细的文档操作</h2><ul>
<li><p>创建索引</p>
<pre><code>curl -XPUT localhost:9200/website?pretty
</code></pre></li>
<li><p>添加文档</p>
<pre><code>curl -XPUT localhost:9200/website/blog/123 -d &apos;{&quot;title&quot;: &quot;my first blog entry&quot;, &quot;text&quot;: &quot;just trying this out...&quot;, &quot;date&quot;: &quot;2014/01/01&quot;}&apos;
curl -XPOST localhost:9200/website/blog/ -d &apos;{&quot;title&quot;: &quot;my second blog entry&quot;, &quot;text&quot;: &quot;still trying this out...&quot;, &quot;date&quot;: &quot;2014/01/01&quot;}&apos;
</code></pre></li>
<li><p>获取文档</p>
<pre><code>curl -XGET localhost:9200/website/blog/123?pretty
</code></pre></li>
<li><p>返回文档的一部分</p>
<ul>
<li><p>返回文档的title、text字段</p>
<pre><code>curl -XGET localhost:9200/website/blog/123?_source=title,text
</code></pre></li>
<li><p>只返回_source字段</p>
<pre><code>curl -XGET localhost:9200/website/blog/123/_source
</code></pre></li>
</ul>
</li>
<li><p>检查文档是否存在</p>
<pre><code>curl -XHEAD localhost:9200/website/blog/124 -i

HTTP/1.1 404 Not Found
Content-Type: text/plain; charset=UTF-8
Content-Length: 0

||

HTTP/1.1 200 OK
Content-Type: text/plain; charset=UTF-8
Content-Length: 0
</code></pre></li>
<li><p>更新文档</p>
<pre><code>curl -XPUT localhost:9200/website/blog/123 -d &apos;{&quot;title&quot;: &quot;hello world&quot;, &quot;text&quot;: &quot;hahahhahahaha&quot;, &quot;date&quot;: &quot;2015/01/01&quot;}&apos;
</code></pre></li>
<li><p>删除文档</p>
<pre><code>curl -XDELETE localhost:9200/website/blog/123
</code></pre></li>
</ul>
<h2 id="安装head，用来查看集群信息"><a href="#安装head，用来查看集群信息" class="headerlink" title="安装head，用来查看集群信息"></a>安装head，用来查看集群信息</h2><pre><code>bin/plugin install mobz/elasticsearch-head

url: http://192.168.1.219:9200/_plugin/head/
</code></pre><h2 id="开启动态脚本"><a href="#开启动态脚本" class="headerlink" title="开启动态脚本"></a>开启动态脚本</h2><ul>
<li><p>修改配置文件</p>
<pre><code>vim config/elasticsearch.yml

cluster.name: booksearch
path.data: app_logs
path.logs: app_logs
network.host: 0.0.0.0
script.inline: true
script.indexed: true
</code></pre></li>
<li><p>执行脚本修改</p>
<pre><code>curl -XPOST &apos;localhost:9200/customer/external/1/_update?pretty&apos; -d &apos;
{
  &quot;script&quot; : &quot;ctx._source.age += 5&quot;
}&apos;
</code></pre></li>
</ul>
<h2 id="自动创建索引"><a href="#自动创建索引" class="headerlink" title="自动创建索引"></a>自动创建索引</h2><pre><code>action.auto_create_index: .marvel-*
</code></pre><h2 id="加载数据"><a href="#加载数据" class="headerlink" title="加载数据"></a>加载数据</h2><pre><code>wget https://www.elastic.co/guide/en/kibana/3.0/snippets/shakespeare.json
wget https://github.com/bly2k/files/blob/master/accounts.zip?raw=true
wget https://download.elastic.co/demos/kibana/gettingstarted/logs.jsonl.gz

unzip accounts.zip
gunzip logs.jsonl.gz

curl -XPUT http://localhost:9200/shakespeare -d &apos;
{
 &quot;mappings&quot; : {
  &quot;_default_&quot; : {
   &quot;properties&quot; : {
    &quot;speaker&quot; : {&quot;type&quot;: &quot;string&quot;, &quot;index&quot; : &quot;not_analyzed&quot; },
    &quot;play_name&quot; : {&quot;type&quot;: &quot;string&quot;, &quot;index&quot; : &quot;not_analyzed&quot; },
    &quot;line_id&quot; : { &quot;type&quot; : &quot;integer&quot; },
    &quot;speech_number&quot; : { &quot;type&quot; : &quot;integer&quot; }
   }
  }
 }
}
&apos;;

curl -XPUT http://localhost:9200/logstash-2015.05.18 -d &apos;
{
  &quot;mappings&quot;: {
    &quot;log&quot;: {
      &quot;properties&quot;: {
        &quot;geo&quot;: {
          &quot;properties&quot;: {
            &quot;coordinates&quot;: {
              &quot;type&quot;: &quot;geo_point&quot;
            }
          }
        }
      }
    }
  }
}
&apos;;

curl -XPUT http://localhost:9200/logstash-2015.05.19 -d &apos;
{
  &quot;mappings&quot;: {
    &quot;log&quot;: {
      &quot;properties&quot;: {
        &quot;geo&quot;: {
          &quot;properties&quot;: {
            &quot;coordinates&quot;: {
              &quot;type&quot;: &quot;geo_point&quot;
            }
          }
        }
      }
    }
  }
}
&apos;;

curl -XPUT http://localhost:9200/logstash-2015.05.20 -d &apos;
{
  &quot;mappings&quot;: {
    &quot;log&quot;: {
      &quot;properties&quot;: {
        &quot;geo&quot;: {
          &quot;properties&quot;: {
            &quot;coordinates&quot;: {
              &quot;type&quot;: &quot;geo_point&quot;
            }
          }
        }
      }
    }
  }
}
&apos;;

curl -XPOST &apos;localhost:9200/bank/account/_bulk?pretty&apos; --data-binary @accounts.json
curl -XPOST &apos;localhost:9200/shakespeare/_bulk?pretty&apos; --data-binary @shakespeare.json
curl -XPOST &apos;localhost:9200/_bulk?pretty&apos; --data-binary @logs.jsonl
</code></pre><h2 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h2><pre><code>curl localhost:9200/_cat/indices?v
</code></pre><h2 id="查看集群健康信息"><a href="#查看集群健康信息" class="headerlink" title="查看集群健康信息"></a>查看集群健康信息</h2><pre><code>curl -XGET localhost:9200/_cluster/health

{
    &quot;cluster_name&quot;: &quot;booksearch&quot;,
    &quot;status&quot;: &quot;green&quot;,
    &quot;timed_out&quot;: false,
    &quot;number_of_nodes&quot;: 2,
    &quot;number_of_data_nodes&quot;: 2,
    &quot;active_primary_shards&quot;: 38,
    &quot;active_shards&quot;: 76,
    &quot;relocating_shards&quot;: 0,
    &quot;initializing_shards&quot;: 0,
    &quot;unassigned_shards&quot;: 0,
    &quot;delayed_unassigned_shards&quot;: 0,
    &quot;number_of_pending_tasks&quot;: 0,
    &quot;number_of_in_flight_fetch&quot;: 0,
    &quot;task_max_waiting_in_queue_millis&quot;: 0,
    &quot;active_shards_percent_as_number&quot;: 100
}
</code></pre><ul>
<li><p>status</p>
<p>  颜色|意义
  —–|—–
  green|所有主要分片和复制分片都可用
  yellow|所有主要分片可用，但不是所有复制分片都可用
  red|不是所有的主要分片都可用</p>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Elasticasearch安装和使用&quot;&gt;&lt;a href=&quot;#Elasticasearch安装和使用&quot; class=&quot;headerlink&quot; title=&quot;Elasticasearch安装和使用&quot;&gt;&lt;/a&gt;Elasticasearch安装和使用&lt;/h1&gt;&lt;h2 id=&quot;install&quot;&gt;&lt;a href=&quot;#install&quot; class=&quot;headerlink&quot; title=&quot;install&quot;&gt;&lt;/a&gt;install&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://download.elasticsearch.org/elasticsearch/release/org/elasticsearch/distribution/zip/elasticsearch/2.2.0/elasticsearch-2.2.0.zip&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;download&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;unzip elasticsearch-2.2.0.zip&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;config&quot;&gt;&lt;a href=&quot;#config&quot; class=&quot;headerlink&quot; title=&quot;config&quot;&gt;&lt;/a&gt;config&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;vim config/elasticsearch.yml

path.data: app_data
path.logs: app_logs
network.host: 0.0.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;install-Marvel-agent-plugin&quot;&gt;&lt;a href=&quot;#install-Marvel-agent-plugin&quot; class=&quot;headerlink&quot; title=&quot;install Marvel agent plugin&quot;&gt;&lt;/a&gt;install Marvel agent plugin&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;bin/plugin install licens
bin/plugin install marvel-agent
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="Elasticasearch" scheme="http://blog.golearns.org/categories/Elasticasearch/"/>
    
    
      <category term="Elasticasearch" scheme="http://blog.golearns.org/tags/Elasticasearch/"/>
    
  </entry>
  
  <entry>
    <title>hexo运行报错</title>
    <link href="http://blog.golearns.org/2016/07/15/hexo%E8%BF%90%E8%A1%8C%E6%8A%A5%E9%94%99/"/>
    <id>http://blog.golearns.org/2016/07/15/hexo运行报错/</id>
    <published>2016-07-15T01:22:02.000Z</published>
    <updated>2016-07-15T01:40:21.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="hexo运行报错"><a href="#hexo运行报错" class="headerlink" title="hexo运行报错"></a>hexo运行报错</h1><ul>
<li><p>运行hexo命令出现以下错误</p>
<pre><code>[Error: Module did not self-register.]
{ [Error: Cannot find module &apos;./build/default/DTraceProviderBindings&apos;] code: &apos;MODULE_NOT_FOUND&apos; }
{ [Error: Cannot find module &apos;./build/Debug/DTraceProviderBindings&apos;] code: &apos;MODULE_NOT_FOUND&apos; }
</code></pre></li>
<li><p>解决方法</p>
<pre><code>npm install hexo --no-optional
</code></pre></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;hexo运行报错&quot;&gt;&lt;a href=&quot;#hexo运行报错&quot; class=&quot;headerlink&quot; title=&quot;hexo运行报错&quot;&gt;&lt;/a&gt;hexo运行报错&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;运行hexo命令出现以下错误&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[Error:
    
    </summary>
    
      <category term="Hexo" scheme="http://blog.golearns.org/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="http://blog.golearns.org/tags/Hexo/"/>
    
  </entry>
  
</feed>
